var ne=Object.defineProperty;var ue=(r,e,t)=>e in r?ne(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var G=(r,e)=>{for(var t in e)ne(r,t,{get:e[t],enumerable:!0})};var q=(r,e,t)=>(ue(r,typeof e!="symbol"?e+"":e,t),t);var sr=class{assets=new Map;toLoad=0;loadImage(e,t){let i=new Image;i.src=t,i.crossOrigin="Anonymous";let n=new Promise(s=>{i.onload=()=>{s(i)}});return this.addAsync(e,n),n}loadAudio(e,t){let i=fetch(t).then(n=>n.arrayBuffer()).then(n=>m.audio.audioContext.decodeAudioData(n));return this.addAsync(e,i),i}addAsync(e,t){++this.toLoad,t.then(i=>{this.assets.set(e,i),--this.toLoad})}waitForAssetsToLoad(){return new Promise(e=>{let t=()=>{this.toLoad==0?e(this.assets):setTimeout(()=>{t()},250)};t()})}get(e){return this.assets.get(e)}};var br=class{constructor(){this.create()}create(){}show(){}hide(){}resize(e,t){}render(e){}dispose(){}};var Lr=class{screen=null;constructor(){}preload(){}create(){}resize(e,t){this.screen&&this.screen.resize(e,t)}render(e){this.screen&&this.screen.render(e)}setScreen(e){this.screen&&this.screen.hide(),this.screen=e,this.screen.show()}};var Z=class{id;data;constructor(e,t={}){this.data=e,this.id=m.gl.createTexture(),m.gl.bindTexture(m.gl.TEXTURE_2D,this.id),m.gl.texImage2D(m.gl.TEXTURE_2D,0,m.gl.RGBA,m.gl.RGBA,m.gl.UNSIGNED_BYTE,e),m.gl.generateMipmap(m.gl.TEXTURE_2D),m.gl.bindTexture(m.gl.TEXTURE_2D,null),t.filter!==void 0&&this.setFilter(t.filter),t.wrap!==void 0&&this.setWrap(t.wrap)}setFilter(e){m.gl.bindTexture(m.gl.TEXTURE_2D,this.id),m.gl.texParameteri(m.gl.TEXTURE_2D,m.gl.TEXTURE_MIN_FILTER,e),m.gl.texParameteri(m.gl.TEXTURE_2D,m.gl.TEXTURE_MAG_FILTER,e==m.gl.NEAREST?m.gl.NEAREST:m.gl.LINEAR),m.gl.bindTexture(m.gl.TEXTURE_2D,null)}setWrap(e){m.gl.bindTexture(m.gl.TEXTURE_2D,this.id),m.gl.texParameteri(m.gl.TEXTURE_2D,m.gl.TEXTURE_WRAP_S,e),m.gl.texParameteri(m.gl.TEXTURE_2D,m.gl.TEXTURE_WRAP_T,e),m.gl.bindTexture(m.gl.TEXTURE_2D,null)}bind(){m.gl.bindTexture(m.gl.TEXTURE_2D,this.id)}dispose(){m.gl.deleteTexture(this.id)}get width(){return this.data.width}get height(){return this.data.height}};var K=class{options;columns=10;charFrom=32;charTo=126;bitmap;texture;charWidth;charHeight;constructor(e){this.options=e,this.charWidth=e.fontSize*e.charRatio,this.charHeight=e.fontSize*1.2,this.bitmap=this.generateBitmap(),this.texture=new Z(this.bitmap,{filter:m.gl.LINEAR_MIPMAP_LINEAR})}generateBitmap(){let e=document.createElement("canvas"),t=this.charTo-this.charFrom+1,i=Math.floor(t/this.columns);e.width=2**Math.ceil(Math.log2(this.columns*this.charWidth)),e.height=2**Math.ceil(Math.log2(i*this.charHeight));let n=e.getContext("2d");n.textBaseline="middle",n.textAlign="center",n.fillStyle="white",n.font=`${this.options.fontSize}px ${this.options.fontFamily}`;for(let s=0;s<t;++s){let a=String.fromCharCode(s+this.charFrom),h=(s%this.columns+.5)*this.charWidth,c=(Math.floor(s/this.columns)+.5)*this.charHeight;n.fillText(a,h,c)}return e}getCharPosition(e){if(e<this.charFrom||e>this.charTo)return null;let t=e-this.charFrom;return[t%this.columns*this.charWidth,Math.floor(t/this.columns)*this.charHeight]}};var _=class{program;constructor(e,t){let i=this.compileShader(e,m.gl.VERTEX_SHADER),n=this.compileShader(t,m.gl.FRAGMENT_SHADER);if(this.program=m.gl.createProgram(),m.gl.attachShader(this.program,i),m.gl.attachShader(this.program,n),m.gl.linkProgram(this.program),!m.gl.getProgramParameter(this.program,m.gl.LINK_STATUS))throw console.log(m.gl.getProgramInfoLog(this.program)),new Error("program unable to link");this.attribs={positions:m.gl.getAttribLocation(this.program,"position"),normals:m.gl.getAttribLocation(this.program,"normal"),colors:m.gl.getAttribLocation(this.program,"color"),uvs:m.gl.getAttribLocation(this.program,"uv"),sizes:m.gl.getAttribLocation(this.program,"size")},this.uniforms=[{name:"projectionMatrix",type:"mat4",location:m.gl.getUniformLocation(this.program,"projectionMatrix")},{name:"modelViewMatrix",type:"mat4",location:m.gl.getUniformLocation(this.program,"modelViewMatrix")},{name:"modelMatrix",type:"mat4",location:m.gl.getUniformLocation(this.program,"modelMatrix")},{name:"normalMatrix",type:"mat3",location:m.gl.getUniformLocation(this.program,"normalMatrix")},{name:"lightColor",type:"vec3",location:m.gl.getUniformLocation(this.program,"lightColor")},{name:"lightDirection",type:"vec3",location:m.gl.getUniformLocation(this.program,"lightDirection")},{name:"lightPosition",type:"vec3",location:m.gl.getUniformLocation(this.program,"lightPosition")},{name:"cameraPosition",type:"vec3",location:m.gl.getUniformLocation(this.program,"cameraPosition")},{name:"pointMultiplier",type:"float",location:m.gl.getUniformLocation(this.program,"pointMultiplier")},{name:"ambientColor",type:"vec3",location:m.gl.getUniformLocation(this.program,"ambientColor")},{name:"uvOffset",type:"vec2",location:m.gl.getUniformLocation(this.program,"uvOffset")}]}activate(){m.gl.useProgram(this.program)}compileShader(e,t){let i=m.gl.createShader(t);if(m.gl.shaderSource(i,e),m.gl.compileShader(i),!m.gl.getShaderParameter(i,m.gl.COMPILE_STATUS))throw console.log(m.gl.getShaderInfoLog(i)),new Error("shader unable to compile");return i}};q(_,"SIMPLE_VS",`
    uniform mat4 modelViewMatrix;
    uniform mat4 projectionMatrix;

    attribute vec3 position;
    attribute vec4 color;

    varying vec4 vColor;

    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        vColor = color;
    }
    `),q(_,"SIMPLE_FS",`
    precision mediump float;

    varying vec4 vColor;

    uniform vec3 ambientColor;

    void main(void) {
        gl_FragColor = vec4(vColor.rgb * ambientColor, vColor.a);
    }
    `),q(_,"TEXTURE_VS",`
    uniform mat4 modelViewMatrix;
    uniform mat4 projectionMatrix;

    attribute vec3 position;
    attribute vec4 color;
    attribute vec2 uv;

    varying vec4 vColor;
    varying vec2 vUv;

    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        vColor = color;
        vUv = uv;
    }
    `),q(_,"TEXTURE_FS",`
    precision mediump float;

    varying vec4 vColor;
    varying vec2 vUv;

    uniform sampler2D tex;
    uniform vec3 ambientColor;
    uniform vec2 uvOffset;

    void main(void) {
        vec4 texColor = texture2D(tex, vUv + uvOffset);
        gl_FragColor = vec4(vColor.rgb * texColor.rgb * ambientColor, texColor.a * vColor.a);
    }
    `),q(_,"PARTICLE_VS",`
    attribute vec3 position;
    attribute vec4 color;
    attribute float size;
    
    uniform float pointMultiplier;
    uniform mat4 projectionMatrix;
    uniform mat4 modelViewMatrix;
    
    varying vec4 vColor;
    
    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        gl_PointSize = size * pointMultiplier / gl_Position.w;
        vColor = color;
    }
    `),q(_,"PARTICLE_FS",`
    precision mediump float;
    
    varying vec4 vColor;

    uniform sampler2D tex;
    uniform vec3 ambientColor;
    
    void main(void) {
        vec4 texColor = texture2D(tex, gl_PointCoord);
        gl_FragColor = vec4(vColor.rgb * texColor.rgb * ambientColor * texColor.a, texColor.a);
        gl_FragColor *= vColor.a;
        if(gl_FragColor.a == 0.0) {
            discard;
        }
    }
    `);var ar=class{canvas;gl;frameId=null;width;height;delta=0;fps=60;lastFrameTime;frameStart;frames;game;shaders=new Map;fonts=new Map;constructor(e){this.game=e,this.canvas=this.createCanvas(),this.canvas.width=this.width=innerWidth,this.canvas.height=this.height=innerHeight,this.gl=this.canvas.getContext("webgl")}onResume(){this.lastFrameTime=this.frameStart=performance.now(),this.frames=0,this.RAF()}createCanvas(){let e=document.createElement("canvas");return e.oncontextmenu=t=>{t.preventDefault(),t.stopPropagation()},document.body.appendChild(e),e}onResize(){this.canvas.width=this.width=innerWidth,this.canvas.height=this.height=innerHeight,this.game.resize(this.width,this.height)}onDrawFrame(){let e=performance.now();this.delta=(e-this.lastFrameTime)*.001,this.lastFrameTime=e,m.input.update(),this.game.render(this.delta),e-this.frameStart>=1e3&&(this.fps=this.frames,this.frames=0,this.frameStart=e),++this.frames}RAF(){this.frameId=requestAnimationFrame(()=>{this.RAF(),this.onDrawFrame()})}compileShaders(){this.shaders.set("simple",new _(_.SIMPLE_VS,_.SIMPLE_FS)),this.shaders.set("texture",new _(_.TEXTURE_VS,_.TEXTURE_FS)),this.shaders.set("particle",new _(_.PARTICLE_VS,_.PARTICLE_FS))}generateFonts(){this.fonts.set("Consolas",new K({fontFamily:"Consolas",fontSize:48,charRatio:.6}))}getShader(e){return this.shaders.get(e)}getFont(e){return this.fonts.get(e)}};var Je={};G(Je,{Camera:()=>H,Drawable:()=>Q,Font:()=>K,Mesh:()=>F,OrthographicCamera:()=>Rr,ParticleSystem:()=>zr,PerspectiveCamera:()=>yr,Shader:()=>_,ShaderInstance:()=>B,Sprite:()=>Tr,TextDrawable:()=>Pr,Texture:()=>Z,meshes:()=>re});var Ke={};G(Ke,{glMatrix:()=>V,mat2:()=>Dr,mat2d:()=>Nr,mat3:()=>k,mat4:()=>O,quat:()=>J,quat2:()=>ur,vec2:()=>W,vec3:()=>S,vec4:()=>fr});var V={};G(V,{ARRAY_TYPE:()=>P,EPSILON:()=>y,RANDOM:()=>U,equals:()=>it,setMatrixArrayType:()=>rt,toRadian:()=>tt});var y=1e-6,P=typeof Float32Array<"u"?Float32Array:Array,U=Math.random;function rt(r){P=r}var et=Math.PI/180;function tt(r){return r*et}function it(r,e){return Math.abs(r-e)<=y*Math.max(1,Math.abs(r),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Dr={};G(Dr,{LDU:()=>wt,add:()=>Et,adjoint:()=>ft,clone:()=>st,copy:()=>at,create:()=>nt,determinant:()=>xt,equals:()=>Rt,exactEquals:()=>At,frob:()=>yt,fromRotation:()=>mt,fromScaling:()=>gt,fromValues:()=>ct,identity:()=>ht,invert:()=>pt,mul:()=>zt,multiply:()=>se,multiplyScalar:()=>Tt,multiplyScalarAndAdd:()=>Pt,rotate:()=>vt,scale:()=>Mt,set:()=>ot,str:()=>dt,sub:()=>St,subtract:()=>ae,transpose:()=>lt});function nt(){var r=new P(4);return P!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function st(r){var e=new P(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function at(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function ht(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r}function ct(r,e,t,i){var n=new P(4);return n[0]=r,n[1]=e,n[2]=t,n[3]=i,n}function ot(r,e,t,i,n){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r}function lt(r,e){if(r===e){var t=e[1];r[1]=e[2],r[2]=t}else r[0]=e[0],r[1]=e[2],r[2]=e[1],r[3]=e[3];return r}function pt(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=t*s-n*i;return a?(a=1/a,r[0]=s*a,r[1]=-i*a,r[2]=-n*a,r[3]=t*a,r):null}function ft(r,e){var t=e[0];return r[0]=e[3],r[1]=-e[1],r[2]=-e[2],r[3]=t,r}function xt(r){return r[0]*r[3]-r[2]*r[1]}function se(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=t[0],c=t[1],o=t[2],l=t[3];return r[0]=i*h+s*c,r[1]=n*h+a*c,r[2]=i*o+s*l,r[3]=n*o+a*l,r}function vt(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=i*c+s*h,r[1]=n*c+a*h,r[2]=i*-h+s*c,r[3]=n*-h+a*c,r}function Mt(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=t[0],c=t[1];return r[0]=i*h,r[1]=n*h,r[2]=s*c,r[3]=a*c,r}function mt(r,e){var t=Math.sin(e),i=Math.cos(e);return r[0]=i,r[1]=t,r[2]=-t,r[3]=i,r}function gt(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r}function dt(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function yt(r){return Math.hypot(r[0],r[1],r[2],r[3])}function wt(r,e,t,i){return r[2]=i[2]/i[0],t[0]=i[0],t[1]=i[1],t[3]=i[3]-r[2]*t[1],[r,e,t]}function Et(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function ae(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function At(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function Rt(r,e){var t=r[0],i=r[1],n=r[2],s=r[3],a=e[0],h=e[1],c=e[2],o=e[3];return Math.abs(t-a)<=y*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(i-h)<=y*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-c)<=y*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-o)<=y*Math.max(1,Math.abs(s),Math.abs(o))}function Tt(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function Pt(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*i,r[3]=e[3]+t[3]*i,r}var zt=se,St=ae;var Nr={};G(Nr,{add:()=>Wt,clone:()=>bt,copy:()=>Lt,create:()=>It,determinant:()=>Ct,equals:()=>Qt,exactEquals:()=>Ht,frob:()=>Bt,fromRotation:()=>Ut,fromScaling:()=>Vt,fromTranslation:()=>Gt,fromValues:()=>Nt,identity:()=>Dt,invert:()=>Yt,mul:()=>Zt,multiply:()=>he,multiplyScalar:()=>jt,multiplyScalarAndAdd:()=>kt,rotate:()=>_t,scale:()=>Ft,set:()=>Ot,str:()=>Xt,sub:()=>Kt,subtract:()=>ce,translate:()=>qt});function It(){var r=new P(6);return P!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function bt(r){var e=new P(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function Lt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function Dt(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function Nt(r,e,t,i,n,s){var a=new P(6);return a[0]=r,a[1]=e,a[2]=t,a[3]=i,a[4]=n,a[5]=s,a}function Ot(r,e,t,i,n,s,a){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r[4]=s,r[5]=a,r}function Yt(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],h=e[5],c=t*s-i*n;return c?(c=1/c,r[0]=s*c,r[1]=-i*c,r[2]=-n*c,r[3]=t*c,r[4]=(n*h-s*a)*c,r[5]=(i*a-t*h)*c,r):null}function Ct(r){return r[0]*r[3]-r[1]*r[2]}function he(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=t[0],l=t[1],p=t[2],f=t[3],x=t[4],M=t[5];return r[0]=i*o+s*l,r[1]=n*o+a*l,r[2]=i*p+s*f,r[3]=n*p+a*f,r[4]=i*x+s*M+h,r[5]=n*x+a*M+c,r}function _t(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=Math.sin(t),l=Math.cos(t);return r[0]=i*l+s*o,r[1]=n*l+a*o,r[2]=i*-o+s*l,r[3]=n*-o+a*l,r[4]=h,r[5]=c,r}function Ft(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=t[0],l=t[1];return r[0]=i*o,r[1]=n*o,r[2]=s*l,r[3]=a*l,r[4]=h,r[5]=c,r}function qt(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=t[0],l=t[1];return r[0]=i,r[1]=n,r[2]=s,r[3]=a,r[4]=i*o+s*l+h,r[5]=n*o+a*l+c,r}function Ut(r,e){var t=Math.sin(e),i=Math.cos(e);return r[0]=i,r[1]=t,r[2]=-t,r[3]=i,r[4]=0,r[5]=0,r}function Vt(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r[4]=0,r[5]=0,r}function Gt(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r}function Xt(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"}function Bt(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)}function Wt(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r}function ce(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r}function jt(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r}function kt(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*i,r[3]=e[3]+t[3]*i,r[4]=e[4]+t[4]*i,r[5]=e[5]+t[5]*i,r}function Ht(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]}function Qt(r,e){var t=r[0],i=r[1],n=r[2],s=r[3],a=r[4],h=r[5],c=e[0],o=e[1],l=e[2],p=e[3],f=e[4],x=e[5];return Math.abs(t-c)<=y*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(i-o)<=y*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=y*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-p)<=y*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-f)<=y*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(h-x)<=y*Math.max(1,Math.abs(h),Math.abs(x))}var Zt=he,Kt=ce;var k={};G(k,{add:()=>yi,adjoint:()=>si,clone:()=>$t,copy:()=>ut,create:()=>Or,determinant:()=>ai,equals:()=>Ri,exactEquals:()=>Ai,frob:()=>di,fromMat2d:()=>xi,fromMat4:()=>Jt,fromQuat:()=>vi,fromRotation:()=>pi,fromScaling:()=>fi,fromTranslation:()=>li,fromValues:()=>ri,identity:()=>ti,invert:()=>ni,mul:()=>Ti,multiply:()=>oe,multiplyScalar:()=>wi,multiplyScalarAndAdd:()=>Ei,normalFromMat4:()=>Mi,projection:()=>mi,rotate:()=>ci,scale:()=>oi,set:()=>ei,str:()=>gi,sub:()=>Pi,subtract:()=>le,translate:()=>hi,transpose:()=>ii});function Or(){var r=new P(9);return P!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Jt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function $t(r){var e=new P(9);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function ut(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function ri(r,e,t,i,n,s,a,h,c){var o=new P(9);return o[0]=r,o[1]=e,o[2]=t,o[3]=i,o[4]=n,o[5]=s,o[6]=a,o[7]=h,o[8]=c,o}function ei(r,e,t,i,n,s,a,h,c,o){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r[4]=s,r[5]=a,r[6]=h,r[7]=c,r[8]=o,r}function ti(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function ii(r,e){if(r===e){var t=e[1],i=e[2],n=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=i,r[7]=n}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function ni(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],h=e[5],c=e[6],o=e[7],l=e[8],p=l*a-h*o,f=-l*s+h*c,x=o*s-a*c,M=t*p+i*f+n*x;return M?(M=1/M,r[0]=p*M,r[1]=(-l*i+n*o)*M,r[2]=(h*i-n*a)*M,r[3]=f*M,r[4]=(l*t-n*c)*M,r[5]=(-h*t+n*s)*M,r[6]=x*M,r[7]=(-o*t+i*c)*M,r[8]=(a*t-i*s)*M,r):null}function si(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],h=e[5],c=e[6],o=e[7],l=e[8];return r[0]=a*l-h*o,r[1]=n*o-i*l,r[2]=i*h-n*a,r[3]=h*c-s*l,r[4]=t*l-n*c,r[5]=n*s-t*h,r[6]=s*o-a*c,r[7]=i*c-t*o,r[8]=t*a-i*s,r}function ai(r){var e=r[0],t=r[1],i=r[2],n=r[3],s=r[4],a=r[5],h=r[6],c=r[7],o=r[8];return e*(o*s-a*c)+t*(-o*n+a*h)+i*(c*n-s*h)}function oe(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=e[8],f=t[0],x=t[1],M=t[2],g=t[3],v=t[4],d=t[5],E=t[6],w=t[7],A=t[8];return r[0]=f*i+x*a+M*o,r[1]=f*n+x*h+M*l,r[2]=f*s+x*c+M*p,r[3]=g*i+v*a+d*o,r[4]=g*n+v*h+d*l,r[5]=g*s+v*c+d*p,r[6]=E*i+w*a+A*o,r[7]=E*n+w*h+A*l,r[8]=E*s+w*c+A*p,r}function hi(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=e[8],f=t[0],x=t[1];return r[0]=i,r[1]=n,r[2]=s,r[3]=a,r[4]=h,r[5]=c,r[6]=f*i+x*a+o,r[7]=f*n+x*h+l,r[8]=f*s+x*c+p,r}function ci(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=e[8],f=Math.sin(t),x=Math.cos(t);return r[0]=x*i+f*a,r[1]=x*n+f*h,r[2]=x*s+f*c,r[3]=x*a-f*i,r[4]=x*h-f*n,r[5]=x*c-f*s,r[6]=o,r[7]=l,r[8]=p,r}function oi(r,e,t){var i=t[0],n=t[1];return r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=n*e[3],r[4]=n*e[4],r[5]=n*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function li(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=e[0],r[7]=e[1],r[8]=1,r}function pi(r,e){var t=Math.sin(e),i=Math.cos(e);return r[0]=i,r[1]=t,r[2]=0,r[3]=-t,r[4]=i,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function fi(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=e[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function xi(r,e){return r[0]=e[0],r[1]=e[1],r[2]=0,r[3]=e[2],r[4]=e[3],r[5]=0,r[6]=e[4],r[7]=e[5],r[8]=1,r}function vi(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=t+t,h=i+i,c=n+n,o=t*a,l=i*a,p=i*h,f=n*a,x=n*h,M=n*c,g=s*a,v=s*h,d=s*c;return r[0]=1-p-M,r[3]=l-d,r[6]=f+v,r[1]=l+d,r[4]=1-o-M,r[7]=x-g,r[2]=f-v,r[5]=x+g,r[8]=1-o-p,r}function Mi(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],h=e[5],c=e[6],o=e[7],l=e[8],p=e[9],f=e[10],x=e[11],M=e[12],g=e[13],v=e[14],d=e[15],E=t*h-i*a,w=t*c-n*a,A=t*o-s*a,T=i*c-n*h,R=i*o-s*h,N=n*o-s*c,b=l*g-p*M,L=l*v-f*M,I=l*d-x*M,Y=p*v-f*g,D=p*d-x*g,C=f*d-x*v,z=E*C-w*D+A*Y+T*I-R*L+N*b;return z?(z=1/z,r[0]=(h*C-c*D+o*Y)*z,r[1]=(c*I-a*C-o*L)*z,r[2]=(a*D-h*I+o*b)*z,r[3]=(n*D-i*C-s*Y)*z,r[4]=(t*C-n*I+s*L)*z,r[5]=(i*I-t*D-s*b)*z,r[6]=(g*N-v*R+d*T)*z,r[7]=(v*A-M*N-d*w)*z,r[8]=(M*R-g*A+d*E)*z,r):null}function mi(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}function gi(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"}function di(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])}function yi(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r}function le(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r}function wi(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r}function Ei(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*i,r[3]=e[3]+t[3]*i,r[4]=e[4]+t[4]*i,r[5]=e[5]+t[5]*i,r[6]=e[6]+t[6]*i,r[7]=e[7]+t[7]*i,r[8]=e[8]+t[8]*i,r}function Ai(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]}function Ri(r,e){var t=r[0],i=r[1],n=r[2],s=r[3],a=r[4],h=r[5],c=r[6],o=r[7],l=r[8],p=e[0],f=e[1],x=e[2],M=e[3],g=e[4],v=e[5],d=e[6],E=e[7],w=e[8];return Math.abs(t-p)<=y*Math.max(1,Math.abs(t),Math.abs(p))&&Math.abs(i-f)<=y*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(n-x)<=y*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(s-M)<=y*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(a-g)<=y*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(h-v)<=y*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-d)<=y*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(o-E)<=y*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(l-w)<=y*Math.max(1,Math.abs(l),Math.abs(w))}var Ti=oe,Pi=le;var O={};G(O,{add:()=>cn,adjoint:()=>Oi,clone:()=>Si,copy:()=>Ii,create:()=>zi,determinant:()=>Yi,equals:()=>fn,exactEquals:()=>pn,frob:()=>hn,fromQuat:()=>Ki,fromQuat2:()=>Hi,fromRotation:()=>Bi,fromRotationTranslation:()=>xe,fromRotationTranslationScale:()=>Qi,fromRotationTranslationScaleOrigin:()=>Zi,fromScaling:()=>Xi,fromTranslation:()=>Gi,fromValues:()=>bi,fromXRotation:()=>Wi,fromYRotation:()=>ji,fromZRotation:()=>ki,frustum:()=>Ji,getRotation:()=>Cr,getScaling:()=>ve,getTranslation:()=>Yr,identity:()=>pe,invert:()=>Ni,lookAt:()=>nn,mul:()=>xn,multiply:()=>fe,multiplyScalar:()=>on,multiplyScalarAndAdd:()=>ln,ortho:()=>en,orthoNO:()=>me,orthoZO:()=>tn,perspective:()=>$i,perspectiveFromFieldOfView:()=>rn,perspectiveNO:()=>Me,perspectiveZO:()=>ui,rotate:()=>Fi,rotateX:()=>qi,rotateY:()=>Ui,rotateZ:()=>Vi,scale:()=>_i,set:()=>Li,str:()=>an,sub:()=>vn,subtract:()=>ge,targetTo:()=>sn,translate:()=>Ci,transpose:()=>Di});function zi(){var r=new P(16);return P!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Si(r){var e=new P(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Ii(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function bi(r,e,t,i,n,s,a,h,c,o,l,p,f,x,M,g){var v=new P(16);return v[0]=r,v[1]=e,v[2]=t,v[3]=i,v[4]=n,v[5]=s,v[6]=a,v[7]=h,v[8]=c,v[9]=o,v[10]=l,v[11]=p,v[12]=f,v[13]=x,v[14]=M,v[15]=g,v}function Li(r,e,t,i,n,s,a,h,c,o,l,p,f,x,M,g,v){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r[4]=s,r[5]=a,r[6]=h,r[7]=c,r[8]=o,r[9]=l,r[10]=p,r[11]=f,r[12]=x,r[13]=M,r[14]=g,r[15]=v,r}function pe(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Di(r,e){if(r===e){var t=e[1],i=e[2],n=e[3],s=e[6],a=e[7],h=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=i,r[9]=s,r[11]=e[14],r[12]=n,r[13]=a,r[14]=h}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function Ni(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],h=e[5],c=e[6],o=e[7],l=e[8],p=e[9],f=e[10],x=e[11],M=e[12],g=e[13],v=e[14],d=e[15],E=t*h-i*a,w=t*c-n*a,A=t*o-s*a,T=i*c-n*h,R=i*o-s*h,N=n*o-s*c,b=l*g-p*M,L=l*v-f*M,I=l*d-x*M,Y=p*v-f*g,D=p*d-x*g,C=f*d-x*v,z=E*C-w*D+A*Y+T*I-R*L+N*b;return z?(z=1/z,r[0]=(h*C-c*D+o*Y)*z,r[1]=(n*D-i*C-s*Y)*z,r[2]=(g*N-v*R+d*T)*z,r[3]=(f*R-p*N-x*T)*z,r[4]=(c*I-a*C-o*L)*z,r[5]=(t*C-n*I+s*L)*z,r[6]=(v*A-M*N-d*w)*z,r[7]=(l*N-f*A+x*w)*z,r[8]=(a*D-h*I+o*b)*z,r[9]=(i*I-t*D-s*b)*z,r[10]=(M*R-g*A+d*E)*z,r[11]=(p*A-l*R-x*E)*z,r[12]=(h*L-a*Y-c*b)*z,r[13]=(t*Y-i*L+n*b)*z,r[14]=(g*w-M*T-v*E)*z,r[15]=(l*T-p*w+f*E)*z,r):null}function Oi(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],h=e[5],c=e[6],o=e[7],l=e[8],p=e[9],f=e[10],x=e[11],M=e[12],g=e[13],v=e[14],d=e[15];return r[0]=h*(f*d-x*v)-p*(c*d-o*v)+g*(c*x-o*f),r[1]=-(i*(f*d-x*v)-p*(n*d-s*v)+g*(n*x-s*f)),r[2]=i*(c*d-o*v)-h*(n*d-s*v)+g*(n*o-s*c),r[3]=-(i*(c*x-o*f)-h*(n*x-s*f)+p*(n*o-s*c)),r[4]=-(a*(f*d-x*v)-l*(c*d-o*v)+M*(c*x-o*f)),r[5]=t*(f*d-x*v)-l*(n*d-s*v)+M*(n*x-s*f),r[6]=-(t*(c*d-o*v)-a*(n*d-s*v)+M*(n*o-s*c)),r[7]=t*(c*x-o*f)-a*(n*x-s*f)+l*(n*o-s*c),r[8]=a*(p*d-x*g)-l*(h*d-o*g)+M*(h*x-o*p),r[9]=-(t*(p*d-x*g)-l*(i*d-s*g)+M*(i*x-s*p)),r[10]=t*(h*d-o*g)-a*(i*d-s*g)+M*(i*o-s*h),r[11]=-(t*(h*x-o*p)-a*(i*x-s*p)+l*(i*o-s*h)),r[12]=-(a*(p*v-f*g)-l*(h*v-c*g)+M*(h*f-c*p)),r[13]=t*(p*v-f*g)-l*(i*v-n*g)+M*(i*f-n*p),r[14]=-(t*(h*v-c*g)-a*(i*v-n*g)+M*(i*c-n*h)),r[15]=t*(h*f-c*p)-a*(i*f-n*p)+l*(i*c-n*h),r}function Yi(r){var e=r[0],t=r[1],i=r[2],n=r[3],s=r[4],a=r[5],h=r[6],c=r[7],o=r[8],l=r[9],p=r[10],f=r[11],x=r[12],M=r[13],g=r[14],v=r[15],d=e*a-t*s,E=e*h-i*s,w=e*c-n*s,A=t*h-i*a,T=t*c-n*a,R=i*c-n*h,N=o*M-l*x,b=o*g-p*x,L=o*v-f*x,I=l*g-p*M,Y=l*v-f*M,D=p*v-f*g;return d*D-E*Y+w*I+A*L-T*b+R*N}function fe(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=e[8],f=e[9],x=e[10],M=e[11],g=e[12],v=e[13],d=e[14],E=e[15],w=t[0],A=t[1],T=t[2],R=t[3];return r[0]=w*i+A*h+T*p+R*g,r[1]=w*n+A*c+T*f+R*v,r[2]=w*s+A*o+T*x+R*d,r[3]=w*a+A*l+T*M+R*E,w=t[4],A=t[5],T=t[6],R=t[7],r[4]=w*i+A*h+T*p+R*g,r[5]=w*n+A*c+T*f+R*v,r[6]=w*s+A*o+T*x+R*d,r[7]=w*a+A*l+T*M+R*E,w=t[8],A=t[9],T=t[10],R=t[11],r[8]=w*i+A*h+T*p+R*g,r[9]=w*n+A*c+T*f+R*v,r[10]=w*s+A*o+T*x+R*d,r[11]=w*a+A*l+T*M+R*E,w=t[12],A=t[13],T=t[14],R=t[15],r[12]=w*i+A*h+T*p+R*g,r[13]=w*n+A*c+T*f+R*v,r[14]=w*s+A*o+T*x+R*d,r[15]=w*a+A*l+T*M+R*E,r}function Ci(r,e,t){var i=t[0],n=t[1],s=t[2],a,h,c,o,l,p,f,x,M,g,v,d;return e===r?(r[12]=e[0]*i+e[4]*n+e[8]*s+e[12],r[13]=e[1]*i+e[5]*n+e[9]*s+e[13],r[14]=e[2]*i+e[6]*n+e[10]*s+e[14],r[15]=e[3]*i+e[7]*n+e[11]*s+e[15]):(a=e[0],h=e[1],c=e[2],o=e[3],l=e[4],p=e[5],f=e[6],x=e[7],M=e[8],g=e[9],v=e[10],d=e[11],r[0]=a,r[1]=h,r[2]=c,r[3]=o,r[4]=l,r[5]=p,r[6]=f,r[7]=x,r[8]=M,r[9]=g,r[10]=v,r[11]=d,r[12]=a*i+l*n+M*s+e[12],r[13]=h*i+p*n+g*s+e[13],r[14]=c*i+f*n+v*s+e[14],r[15]=o*i+x*n+d*s+e[15]),r}function _i(r,e,t){var i=t[0],n=t[1],s=t[2];return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Fi(r,e,t,i){var n=i[0],s=i[1],a=i[2],h=Math.hypot(n,s,a),c,o,l,p,f,x,M,g,v,d,E,w,A,T,R,N,b,L,I,Y,D,C,z,X;return h<y?null:(h=1/h,n*=h,s*=h,a*=h,c=Math.sin(t),o=Math.cos(t),l=1-o,p=e[0],f=e[1],x=e[2],M=e[3],g=e[4],v=e[5],d=e[6],E=e[7],w=e[8],A=e[9],T=e[10],R=e[11],N=n*n*l+o,b=s*n*l+a*c,L=a*n*l-s*c,I=n*s*l-a*c,Y=s*s*l+o,D=a*s*l+n*c,C=n*a*l+s*c,z=s*a*l-n*c,X=a*a*l+o,r[0]=p*N+g*b+w*L,r[1]=f*N+v*b+A*L,r[2]=x*N+d*b+T*L,r[3]=M*N+E*b+R*L,r[4]=p*I+g*Y+w*D,r[5]=f*I+v*Y+A*D,r[6]=x*I+d*Y+T*D,r[7]=M*I+E*Y+R*D,r[8]=p*C+g*z+w*X,r[9]=f*C+v*z+A*X,r[10]=x*C+d*z+T*X,r[11]=M*C+E*z+R*X,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function qi(r,e,t){var i=Math.sin(t),n=Math.cos(t),s=e[4],a=e[5],h=e[6],c=e[7],o=e[8],l=e[9],p=e[10],f=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*n+o*i,r[5]=a*n+l*i,r[6]=h*n+p*i,r[7]=c*n+f*i,r[8]=o*n-s*i,r[9]=l*n-a*i,r[10]=p*n-h*i,r[11]=f*n-c*i,r}function Ui(r,e,t){var i=Math.sin(t),n=Math.cos(t),s=e[0],a=e[1],h=e[2],c=e[3],o=e[8],l=e[9],p=e[10],f=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*n-o*i,r[1]=a*n-l*i,r[2]=h*n-p*i,r[3]=c*n-f*i,r[8]=s*i+o*n,r[9]=a*i+l*n,r[10]=h*i+p*n,r[11]=c*i+f*n,r}function Vi(r,e,t){var i=Math.sin(t),n=Math.cos(t),s=e[0],a=e[1],h=e[2],c=e[3],o=e[4],l=e[5],p=e[6],f=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*n+o*i,r[1]=a*n+l*i,r[2]=h*n+p*i,r[3]=c*n+f*i,r[4]=o*n-s*i,r[5]=l*n-a*i,r[6]=p*n-h*i,r[7]=f*n-c*i,r}function Gi(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Xi(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Bi(r,e,t){var i=t[0],n=t[1],s=t[2],a=Math.hypot(i,n,s),h,c,o;return a<y?null:(a=1/a,i*=a,n*=a,s*=a,h=Math.sin(e),c=Math.cos(e),o=1-c,r[0]=i*i*o+c,r[1]=n*i*o+s*h,r[2]=s*i*o-n*h,r[3]=0,r[4]=i*n*o-s*h,r[5]=n*n*o+c,r[6]=s*n*o+i*h,r[7]=0,r[8]=i*s*o+n*h,r[9]=n*s*o-i*h,r[10]=s*s*o+c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function Wi(r,e){var t=Math.sin(e),i=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ji(r,e){var t=Math.sin(e),i=Math.cos(e);return r[0]=i,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ki(r,e){var t=Math.sin(e),i=Math.cos(e);return r[0]=i,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function xe(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=i+i,c=n+n,o=s+s,l=i*h,p=i*c,f=i*o,x=n*c,M=n*o,g=s*o,v=a*h,d=a*c,E=a*o;return r[0]=1-(x+g),r[1]=p+E,r[2]=f-d,r[3]=0,r[4]=p-E,r[5]=1-(l+g),r[6]=M+v,r[7]=0,r[8]=f+d,r[9]=M-v,r[10]=1-(l+x),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Hi(r,e){var t=new P(3),i=-e[0],n=-e[1],s=-e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=i*i+n*n+s*s+a*a;return p>0?(t[0]=(h*a+l*i+c*s-o*n)*2/p,t[1]=(c*a+l*n+o*i-h*s)*2/p,t[2]=(o*a+l*s+h*n-c*i)*2/p):(t[0]=(h*a+l*i+c*s-o*n)*2,t[1]=(c*a+l*n+o*i-h*s)*2,t[2]=(o*a+l*s+h*n-c*i)*2),xe(r,e,t),r}function Yr(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function ve(r,e){var t=e[0],i=e[1],n=e[2],s=e[4],a=e[5],h=e[6],c=e[8],o=e[9],l=e[10];return r[0]=Math.hypot(t,i,n),r[1]=Math.hypot(s,a,h),r[2]=Math.hypot(c,o,l),r}function Cr(r,e){var t=new P(3);ve(t,e);var i=1/t[0],n=1/t[1],s=1/t[2],a=e[0]*i,h=e[1]*n,c=e[2]*s,o=e[4]*i,l=e[5]*n,p=e[6]*s,f=e[8]*i,x=e[9]*n,M=e[10]*s,g=a+l+M,v=0;return g>0?(v=Math.sqrt(g+1)*2,r[3]=.25*v,r[0]=(p-x)/v,r[1]=(f-c)/v,r[2]=(h-o)/v):a>l&&a>M?(v=Math.sqrt(1+a-l-M)*2,r[3]=(p-x)/v,r[0]=.25*v,r[1]=(h+o)/v,r[2]=(f+c)/v):l>M?(v=Math.sqrt(1+l-a-M)*2,r[3]=(f-c)/v,r[0]=(h+o)/v,r[1]=.25*v,r[2]=(p+x)/v):(v=Math.sqrt(1+M-a-l)*2,r[3]=(h-o)/v,r[0]=(f+c)/v,r[1]=(p+x)/v,r[2]=.25*v),r}function Qi(r,e,t,i){var n=e[0],s=e[1],a=e[2],h=e[3],c=n+n,o=s+s,l=a+a,p=n*c,f=n*o,x=n*l,M=s*o,g=s*l,v=a*l,d=h*c,E=h*o,w=h*l,A=i[0],T=i[1],R=i[2];return r[0]=(1-(M+v))*A,r[1]=(f+w)*A,r[2]=(x-E)*A,r[3]=0,r[4]=(f-w)*T,r[5]=(1-(p+v))*T,r[6]=(g+d)*T,r[7]=0,r[8]=(x+E)*R,r[9]=(g-d)*R,r[10]=(1-(p+M))*R,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Zi(r,e,t,i,n){var s=e[0],a=e[1],h=e[2],c=e[3],o=s+s,l=a+a,p=h+h,f=s*o,x=s*l,M=s*p,g=a*l,v=a*p,d=h*p,E=c*o,w=c*l,A=c*p,T=i[0],R=i[1],N=i[2],b=n[0],L=n[1],I=n[2],Y=(1-(g+d))*T,D=(x+A)*T,C=(M-w)*T,z=(x-A)*R,X=(1-(f+d))*R,rr=(v+E)*R,er=(M+w)*N,te=(v-E)*N,ie=(1-(f+g))*N;return r[0]=Y,r[1]=D,r[2]=C,r[3]=0,r[4]=z,r[5]=X,r[6]=rr,r[7]=0,r[8]=er,r[9]=te,r[10]=ie,r[11]=0,r[12]=t[0]+b-(Y*b+z*L+er*I),r[13]=t[1]+L-(D*b+X*L+te*I),r[14]=t[2]+I-(C*b+rr*L+ie*I),r[15]=1,r}function Ki(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=t+t,h=i+i,c=n+n,o=t*a,l=i*a,p=i*h,f=n*a,x=n*h,M=n*c,g=s*a,v=s*h,d=s*c;return r[0]=1-p-M,r[1]=l+d,r[2]=f-v,r[3]=0,r[4]=l-d,r[5]=1-o-M,r[6]=x+g,r[7]=0,r[8]=f+v,r[9]=x-g,r[10]=1-o-p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ji(r,e,t,i,n,s,a){var h=1/(t-e),c=1/(n-i),o=1/(s-a);return r[0]=s*2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*c,r[6]=0,r[7]=0,r[8]=(t+e)*h,r[9]=(n+i)*c,r[10]=(a+s)*o,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*o,r[15]=0,r}function Me(r,e,t,i,n){var s=1/Math.tan(e/2),a;return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,n!=null&&n!==1/0?(a=1/(i-n),r[10]=(n+i)*a,r[14]=2*n*i*a):(r[10]=-1,r[14]=-2*i),r}var $i=Me;function ui(r,e,t,i,n){var s=1/Math.tan(e/2),a;return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,n!=null&&n!==1/0?(a=1/(i-n),r[10]=n*a,r[14]=n*i*a):(r[10]=-1,r[14]=-i),r}function rn(r,e,t,i){var n=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),h=Math.tan(e.rightDegrees*Math.PI/180),c=2/(a+h),o=2/(n+s);return r[0]=c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=-((a-h)*c*.5),r[9]=(n-s)*o*.5,r[10]=i/(t-i),r[11]=-1,r[12]=0,r[13]=0,r[14]=i*t/(t-i),r[15]=0,r}function me(r,e,t,i,n,s,a){var h=1/(e-t),c=1/(i-n),o=1/(s-a);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*o,r[11]=0,r[12]=(e+t)*h,r[13]=(n+i)*c,r[14]=(a+s)*o,r[15]=1,r}var en=me;function tn(r,e,t,i,n,s,a){var h=1/(e-t),c=1/(i-n),o=1/(s-a);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=o,r[11]=0,r[12]=(e+t)*h,r[13]=(n+i)*c,r[14]=s*o,r[15]=1,r}function nn(r,e,t,i){var n,s,a,h,c,o,l,p,f,x,M=e[0],g=e[1],v=e[2],d=i[0],E=i[1],w=i[2],A=t[0],T=t[1],R=t[2];return Math.abs(M-A)<y&&Math.abs(g-T)<y&&Math.abs(v-R)<y?pe(r):(l=M-A,p=g-T,f=v-R,x=1/Math.hypot(l,p,f),l*=x,p*=x,f*=x,n=E*f-w*p,s=w*l-d*f,a=d*p-E*l,x=Math.hypot(n,s,a),x?(x=1/x,n*=x,s*=x,a*=x):(n=0,s=0,a=0),h=p*a-f*s,c=f*n-l*a,o=l*s-p*n,x=Math.hypot(h,c,o),x?(x=1/x,h*=x,c*=x,o*=x):(h=0,c=0,o=0),r[0]=n,r[1]=h,r[2]=l,r[3]=0,r[4]=s,r[5]=c,r[6]=p,r[7]=0,r[8]=a,r[9]=o,r[10]=f,r[11]=0,r[12]=-(n*M+s*g+a*v),r[13]=-(h*M+c*g+o*v),r[14]=-(l*M+p*g+f*v),r[15]=1,r)}function sn(r,e,t,i){var n=e[0],s=e[1],a=e[2],h=i[0],c=i[1],o=i[2],l=n-t[0],p=s-t[1],f=a-t[2],x=l*l+p*p+f*f;x>0&&(x=1/Math.sqrt(x),l*=x,p*=x,f*=x);var M=c*f-o*p,g=o*l-h*f,v=h*p-c*l;return x=M*M+g*g+v*v,x>0&&(x=1/Math.sqrt(x),M*=x,g*=x,v*=x),r[0]=M,r[1]=g,r[2]=v,r[3]=0,r[4]=p*v-f*g,r[5]=f*M-l*v,r[6]=l*g-p*M,r[7]=0,r[8]=l,r[9]=p,r[10]=f,r[11]=0,r[12]=n,r[13]=s,r[14]=a,r[15]=1,r}function an(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function hn(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function cn(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r}function ge(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r}function on(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r}function ln(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*i,r[3]=e[3]+t[3]*i,r[4]=e[4]+t[4]*i,r[5]=e[5]+t[5]*i,r[6]=e[6]+t[6]*i,r[7]=e[7]+t[7]*i,r[8]=e[8]+t[8]*i,r[9]=e[9]+t[9]*i,r[10]=e[10]+t[10]*i,r[11]=e[11]+t[11]*i,r[12]=e[12]+t[12]*i,r[13]=e[13]+t[13]*i,r[14]=e[14]+t[14]*i,r[15]=e[15]+t[15]*i,r}function pn(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function fn(r,e){var t=r[0],i=r[1],n=r[2],s=r[3],a=r[4],h=r[5],c=r[6],o=r[7],l=r[8],p=r[9],f=r[10],x=r[11],M=r[12],g=r[13],v=r[14],d=r[15],E=e[0],w=e[1],A=e[2],T=e[3],R=e[4],N=e[5],b=e[6],L=e[7],I=e[8],Y=e[9],D=e[10],C=e[11],z=e[12],X=e[13],rr=e[14],er=e[15];return Math.abs(t-E)<=y*Math.max(1,Math.abs(t),Math.abs(E))&&Math.abs(i-w)<=y*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(n-A)<=y*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(s-T)<=y*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-R)<=y*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(h-N)<=y*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(c-b)<=y*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(o-L)<=y*Math.max(1,Math.abs(o),Math.abs(L))&&Math.abs(l-I)<=y*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(p-Y)<=y*Math.max(1,Math.abs(p),Math.abs(Y))&&Math.abs(f-D)<=y*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(x-C)<=y*Math.max(1,Math.abs(x),Math.abs(C))&&Math.abs(M-z)<=y*Math.max(1,Math.abs(M),Math.abs(z))&&Math.abs(g-X)<=y*Math.max(1,Math.abs(g),Math.abs(X))&&Math.abs(v-rr)<=y*Math.max(1,Math.abs(v),Math.abs(rr))&&Math.abs(d-er)<=y*Math.max(1,Math.abs(d),Math.abs(er))}var xn=fe,vn=ge;var J={};G(J,{add:()=>Ds,calculateW:()=>Es,clone:()=>Is,conjugate:()=>Ps,copy:()=>vr,create:()=>ir,dot:()=>Mr,equals:()=>Fs,exactEquals:()=>_s,exp:()=>Oe,fromEuler:()=>zs,fromMat3:()=>Ce,fromValues:()=>bs,getAngle:()=>ws,getAxisAngle:()=>ys,identity:()=>ds,invert:()=>Ts,len:()=>Ys,length:()=>mr,lerp:()=>Os,ln:()=>Ye,mul:()=>Ns,multiply:()=>Ne,normalize:()=>$r,pow:()=>As,random:()=>Rs,rotateX:()=>Zr,rotateY:()=>Kr,rotateZ:()=>Jr,rotationTo:()=>qs,scale:()=>_e,set:()=>Ls,setAxes:()=>Vs,setAxisAngle:()=>De,slerp:()=>xr,sqlerp:()=>Us,sqrLen:()=>Cs,squaredLength:()=>gr,str:()=>Ss});var S={};G(S,{add:()=>dn,angle:()=>qn,bezier:()=>Ln,ceil:()=>yn,clone:()=>Mn,copy:()=>mn,create:()=>hr,cross:()=>tr,dist:()=>kn,distance:()=>Ae,div:()=>jn,divide:()=>Ee,dot:()=>or,equals:()=>Xn,exactEquals:()=>Gn,floor:()=>wn,forEach:()=>Zn,fromValues:()=>cr,hermite:()=>bn,inverse:()=>Sn,len:()=>Fr,length:()=>de,lerp:()=>In,max:()=>An,min:()=>En,mul:()=>Wn,multiply:()=>we,negate:()=>zn,normalize:()=>_r,random:()=>Dn,rotateX:()=>Cn,rotateY:()=>_n,rotateZ:()=>Fn,round:()=>Rn,scale:()=>Tn,scaleAndAdd:()=>Pn,set:()=>gn,sqrDist:()=>Hn,sqrLen:()=>Qn,squaredDistance:()=>Re,squaredLength:()=>Te,str:()=>Vn,sub:()=>Bn,subtract:()=>ye,transformMat3:()=>On,transformMat4:()=>Nn,transformQuat:()=>Yn,zero:()=>Un});function hr(){var r=new P(3);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Mn(r){var e=new P(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function de(r){var e=r[0],t=r[1],i=r[2];return Math.hypot(e,t,i)}function cr(r,e,t){var i=new P(3);return i[0]=r,i[1]=e,i[2]=t,i}function mn(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function gn(r,e,t,i){return r[0]=e,r[1]=t,r[2]=i,r}function dn(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function ye(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function we(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function Ee(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r}function yn(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r}function wn(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r}function En(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function An(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function Rn(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r}function Tn(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function Pn(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*i,r}function Ae(r,e){var t=e[0]-r[0],i=e[1]-r[1],n=e[2]-r[2];return Math.hypot(t,i,n)}function Re(r,e){var t=e[0]-r[0],i=e[1]-r[1],n=e[2]-r[2];return t*t+i*i+n*n}function Te(r){var e=r[0],t=r[1],i=r[2];return e*e+t*t+i*i}function zn(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function Sn(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r}function _r(r,e){var t=e[0],i=e[1],n=e[2],s=t*t+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function or(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function tr(r,e,t){var i=e[0],n=e[1],s=e[2],a=t[0],h=t[1],c=t[2];return r[0]=n*c-s*h,r[1]=s*a-i*c,r[2]=i*h-n*a,r}function In(r,e,t,i){var n=e[0],s=e[1],a=e[2];return r[0]=n+i*(t[0]-n),r[1]=s+i*(t[1]-s),r[2]=a+i*(t[2]-a),r}function bn(r,e,t,i,n,s){var a=s*s,h=a*(2*s-3)+1,c=a*(s-2)+s,o=a*(s-1),l=a*(3-2*s);return r[0]=e[0]*h+t[0]*c+i[0]*o+n[0]*l,r[1]=e[1]*h+t[1]*c+i[1]*o+n[1]*l,r[2]=e[2]*h+t[2]*c+i[2]*o+n[2]*l,r}function Ln(r,e,t,i,n,s){var a=1-s,h=a*a,c=s*s,o=h*a,l=3*s*h,p=3*c*a,f=c*s;return r[0]=e[0]*o+t[0]*l+i[0]*p+n[0]*f,r[1]=e[1]*o+t[1]*l+i[1]*p+n[1]*f,r[2]=e[2]*o+t[2]*l+i[2]*p+n[2]*f,r}function Dn(r,e){e=e||1;var t=U()*2*Math.PI,i=U()*2-1,n=Math.sqrt(1-i*i)*e;return r[0]=Math.cos(t)*n,r[1]=Math.sin(t)*n,r[2]=i*e,r}function Nn(r,e,t){var i=e[0],n=e[1],s=e[2],a=t[3]*i+t[7]*n+t[11]*s+t[15];return a=a||1,r[0]=(t[0]*i+t[4]*n+t[8]*s+t[12])/a,r[1]=(t[1]*i+t[5]*n+t[9]*s+t[13])/a,r[2]=(t[2]*i+t[6]*n+t[10]*s+t[14])/a,r}function On(r,e,t){var i=e[0],n=e[1],s=e[2];return r[0]=i*t[0]+n*t[3]+s*t[6],r[1]=i*t[1]+n*t[4]+s*t[7],r[2]=i*t[2]+n*t[5]+s*t[8],r}function Yn(r,e,t){var i=t[0],n=t[1],s=t[2],a=t[3],h=e[0],c=e[1],o=e[2],l=n*o-s*c,p=s*h-i*o,f=i*c-n*h,x=n*f-s*p,M=s*l-i*f,g=i*p-n*l,v=a*2;return l*=v,p*=v,f*=v,x*=2,M*=2,g*=2,r[0]=h+l+x,r[1]=c+p+M,r[2]=o+f+g,r}function Cn(r,e,t,i){var n=[],s=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],s[0]=n[0],s[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),s[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function _n(r,e,t,i){var n=[],s=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],s[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),s[1]=n[1],s[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function Fn(r,e,t,i){var n=[],s=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],s[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),s[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),s[2]=n[2],r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function qn(r,e){var t=r[0],i=r[1],n=r[2],s=e[0],a=e[1],h=e[2],c=Math.sqrt(t*t+i*i+n*n),o=Math.sqrt(s*s+a*a+h*h),l=c*o,p=l&&or(r,e)/l;return Math.acos(Math.min(Math.max(p,-1),1))}function Un(r){return r[0]=0,r[1]=0,r[2]=0,r}function Vn(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function Gn(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]}function Xn(r,e){var t=r[0],i=r[1],n=r[2],s=e[0],a=e[1],h=e[2];return Math.abs(t-s)<=y*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(i-a)<=y*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-h)<=y*Math.max(1,Math.abs(n),Math.abs(h))}var Bn=ye,Wn=we,jn=Ee,kn=Ae,Hn=Re,Fr=de,Qn=Te,Zn=function(){var r=hr();return function(e,t,i,n,s,a){var h,c;for(t||(t=3),i||(i=0),n?c=Math.min(n*t+i,e.length):c=e.length,h=i;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],s(r,r,a),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2];return e}}();var fr={};G(fr,{add:()=>Xr,ceil:()=>Kn,clone:()=>qr,copy:()=>Vr,create:()=>Pe,cross:()=>ns,dist:()=>xs,distance:()=>be,div:()=>fs,divide:()=>Ie,dot:()=>jr,equals:()=>Qr,exactEquals:()=>Hr,floor:()=>Jn,forEach:()=>gs,fromValues:()=>Ur,inverse:()=>is,len:()=>Ms,length:()=>lr,lerp:()=>kr,max:()=>un,min:()=>$n,mul:()=>ps,multiply:()=>Se,negate:()=>ts,normalize:()=>Wr,random:()=>ss,round:()=>rs,scale:()=>Br,scaleAndAdd:()=>es,set:()=>Gr,sqrDist:()=>vs,sqrLen:()=>ms,squaredDistance:()=>Le,squaredLength:()=>pr,str:()=>os,sub:()=>ls,subtract:()=>ze,transformMat4:()=>as,transformQuat:()=>hs,zero:()=>cs});function Pe(){var r=new P(4);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function qr(r){var e=new P(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function Ur(r,e,t,i){var n=new P(4);return n[0]=r,n[1]=e,n[2]=t,n[3]=i,n}function Vr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Gr(r,e,t,i,n){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r}function Xr(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function ze(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function Se(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r[3]=e[3]*t[3],r}function Ie(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r[3]=e[3]/t[3],r}function Kn(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r[3]=Math.ceil(e[3]),r}function Jn(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r[3]=Math.floor(e[3]),r}function $n(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.min(e[3],t[3]),r}function un(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r}function rs(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r[3]=Math.round(e[3]),r}function Br(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function es(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*i,r[3]=e[3]+t[3]*i,r}function be(r,e){var t=e[0]-r[0],i=e[1]-r[1],n=e[2]-r[2],s=e[3]-r[3];return Math.hypot(t,i,n,s)}function Le(r,e){var t=e[0]-r[0],i=e[1]-r[1],n=e[2]-r[2],s=e[3]-r[3];return t*t+i*i+n*n+s*s}function lr(r){var e=r[0],t=r[1],i=r[2],n=r[3];return Math.hypot(e,t,i,n)}function pr(r){var e=r[0],t=r[1],i=r[2],n=r[3];return e*e+t*t+i*i+n*n}function ts(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r}function is(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r[3]=1/e[3],r}function Wr(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=t*t+i*i+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=t*a,r[1]=i*a,r[2]=n*a,r[3]=s*a,r}function jr(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function ns(r,e,t,i){var n=t[0]*i[1]-t[1]*i[0],s=t[0]*i[2]-t[2]*i[0],a=t[0]*i[3]-t[3]*i[0],h=t[1]*i[2]-t[2]*i[1],c=t[1]*i[3]-t[3]*i[1],o=t[2]*i[3]-t[3]*i[2],l=e[0],p=e[1],f=e[2],x=e[3];return r[0]=p*o-f*c+x*h,r[1]=-(l*o)+f*a-x*s,r[2]=l*c-p*a+x*n,r[3]=-(l*h)+p*s-f*n,r}function kr(r,e,t,i){var n=e[0],s=e[1],a=e[2],h=e[3];return r[0]=n+i*(t[0]-n),r[1]=s+i*(t[1]-s),r[2]=a+i*(t[2]-a),r[3]=h+i*(t[3]-h),r}function ss(r,e){e=e||1;var t,i,n,s,a,h;do t=U()*2-1,i=U()*2-1,a=t*t+i*i;while(a>=1);do n=U()*2-1,s=U()*2-1,h=n*n+s*s;while(h>=1);var c=Math.sqrt((1-a)/h);return r[0]=e*t,r[1]=e*i,r[2]=e*n*c,r[3]=e*s*c,r}function as(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3];return r[0]=t[0]*i+t[4]*n+t[8]*s+t[12]*a,r[1]=t[1]*i+t[5]*n+t[9]*s+t[13]*a,r[2]=t[2]*i+t[6]*n+t[10]*s+t[14]*a,r[3]=t[3]*i+t[7]*n+t[11]*s+t[15]*a,r}function hs(r,e,t){var i=e[0],n=e[1],s=e[2],a=t[0],h=t[1],c=t[2],o=t[3],l=o*i+h*s-c*n,p=o*n+c*i-a*s,f=o*s+a*n-h*i,x=-a*i-h*n-c*s;return r[0]=l*o+x*-a+p*-c-f*-h,r[1]=p*o+x*-h+f*-a-l*-c,r[2]=f*o+x*-c+l*-h-p*-a,r[3]=e[3],r}function cs(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}function os(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function Hr(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function Qr(r,e){var t=r[0],i=r[1],n=r[2],s=r[3],a=e[0],h=e[1],c=e[2],o=e[3];return Math.abs(t-a)<=y*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(i-h)<=y*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-c)<=y*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-o)<=y*Math.max(1,Math.abs(s),Math.abs(o))}var ls=ze,ps=Se,fs=Ie,xs=be,vs=Le,Ms=lr,ms=pr,gs=function(){var r=Pe();return function(e,t,i,n,s,a){var h,c;for(t||(t=4),i||(i=0),n?c=Math.min(n*t+i,e.length):c=e.length,h=i;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],r[3]=e[h+3],s(r,r,a),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2],e[h+3]=r[3];return e}}();function ir(){var r=new P(4);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function ds(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function De(r,e,t){t=t*.5;var i=Math.sin(t);return r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=Math.cos(t),r}function ys(r,e){var t=Math.acos(e[3])*2,i=Math.sin(t/2);return i>y?(r[0]=e[0]/i,r[1]=e[1]/i,r[2]=e[2]/i):(r[0]=1,r[1]=0,r[2]=0),t}function ws(r,e){var t=Mr(r,e);return Math.acos(2*t*t-1)}function Ne(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=t[0],c=t[1],o=t[2],l=t[3];return r[0]=i*l+a*h+n*o-s*c,r[1]=n*l+a*c+s*h-i*o,r[2]=s*l+a*o+i*c-n*h,r[3]=a*l-i*h-n*c-s*o,r}function Zr(r,e,t){t*=.5;var i=e[0],n=e[1],s=e[2],a=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=i*c+a*h,r[1]=n*c+s*h,r[2]=s*c-n*h,r[3]=a*c-i*h,r}function Kr(r,e,t){t*=.5;var i=e[0],n=e[1],s=e[2],a=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=i*c-s*h,r[1]=n*c+a*h,r[2]=s*c+i*h,r[3]=a*c-n*h,r}function Jr(r,e,t){t*=.5;var i=e[0],n=e[1],s=e[2],a=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=i*c+n*h,r[1]=n*c-i*h,r[2]=s*c+a*h,r[3]=a*c-s*h,r}function Es(r,e){var t=e[0],i=e[1],n=e[2];return r[0]=t,r[1]=i,r[2]=n,r[3]=Math.sqrt(Math.abs(1-t*t-i*i-n*n)),r}function Oe(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=Math.sqrt(t*t+i*i+n*n),h=Math.exp(s),c=a>0?h*Math.sin(a)/a:0;return r[0]=t*c,r[1]=i*c,r[2]=n*c,r[3]=h*Math.cos(a),r}function Ye(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=Math.sqrt(t*t+i*i+n*n),h=a>0?Math.atan2(a,s)/a:0;return r[0]=t*h,r[1]=i*h,r[2]=n*h,r[3]=.5*Math.log(t*t+i*i+n*n+s*s),r}function As(r,e,t){return Ye(r,e),_e(r,r,t),Oe(r,r),r}function xr(r,e,t,i){var n=e[0],s=e[1],a=e[2],h=e[3],c=t[0],o=t[1],l=t[2],p=t[3],f,x,M,g,v;return x=n*c+s*o+a*l+h*p,x<0&&(x=-x,c=-c,o=-o,l=-l,p=-p),1-x>y?(f=Math.acos(x),M=Math.sin(f),g=Math.sin((1-i)*f)/M,v=Math.sin(i*f)/M):(g=1-i,v=i),r[0]=g*n+v*c,r[1]=g*s+v*o,r[2]=g*a+v*l,r[3]=g*h+v*p,r}function Rs(r){var e=U(),t=U(),i=U(),n=Math.sqrt(1-e),s=Math.sqrt(e);return r[0]=n*Math.sin(2*Math.PI*t),r[1]=n*Math.cos(2*Math.PI*t),r[2]=s*Math.sin(2*Math.PI*i),r[3]=s*Math.cos(2*Math.PI*i),r}function Ts(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],a=t*t+i*i+n*n+s*s,h=a?1/a:0;return r[0]=-t*h,r[1]=-i*h,r[2]=-n*h,r[3]=s*h,r}function Ps(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function Ce(r,e){var t=e[0]+e[4]+e[8],i;if(t>0)i=Math.sqrt(t+1),r[3]=.5*i,i=.5/i,r[0]=(e[5]-e[7])*i,r[1]=(e[6]-e[2])*i,r[2]=(e[1]-e[3])*i;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[n*3+n]&&(n=2);var s=(n+1)%3,a=(n+2)%3;i=Math.sqrt(e[n*3+n]-e[s*3+s]-e[a*3+a]+1),r[n]=.5*i,i=.5/i,r[3]=(e[s*3+a]-e[a*3+s])*i,r[s]=(e[s*3+n]+e[n*3+s])*i,r[a]=(e[a*3+n]+e[n*3+a])*i}return r}function zs(r,e,t,i){var n=.5*Math.PI/180;e*=n,t*=n,i*=n;var s=Math.sin(e),a=Math.cos(e),h=Math.sin(t),c=Math.cos(t),o=Math.sin(i),l=Math.cos(i);return r[0]=s*c*l-a*h*o,r[1]=a*h*l+s*c*o,r[2]=a*c*o-s*h*l,r[3]=a*c*l+s*h*o,r}function Ss(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}var Is=qr,bs=Ur,vr=Vr,Ls=Gr,Ds=Xr,Ns=Ne,_e=Br,Mr=jr,Os=kr,mr=lr,Ys=mr,gr=pr,Cs=gr,$r=Wr,_s=Hr,Fs=Qr,qs=function(){var r=hr(),e=cr(1,0,0),t=cr(0,1,0);return function(i,n,s){var a=or(n,s);return a<-.999999?(tr(r,e,n),Fr(r)<1e-6&&tr(r,t,n),_r(r,r),De(i,r,Math.PI),i):a>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(tr(r,n,s),i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=1+a,$r(i,i))}}(),Us=function(){var r=ir(),e=ir();return function(t,i,n,s,a,h){return xr(r,i,a,h),xr(e,n,s,h),xr(t,r,e,2*h*(1-h)),t}}(),Vs=function(){var r=Or();return function(e,t,i,n){return r[0]=i[0],r[3]=i[1],r[6]=i[2],r[1]=n[0],r[4]=n[1],r[7]=n[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],$r(e,Ce(e,r))}}();var ur={};G(ur,{add:()=>ca,clone:()=>Xs,conjugate:()=>xa,copy:()=>qe,create:()=>Gs,dot:()=>Ve,equals:()=>ya,exactEquals:()=>da,fromMat4:()=>Hs,fromRotation:()=>ks,fromRotationTranslation:()=>Fe,fromRotationTranslationValues:()=>Ws,fromTranslation:()=>js,fromValues:()=>Bs,getDual:()=>Js,getReal:()=>Ks,getTranslation:()=>ra,identity:()=>Qs,invert:()=>fa,len:()=>va,length:()=>Ge,lerp:()=>pa,mul:()=>oa,multiply:()=>Ue,normalize:()=>ma,rotateAroundAxis:()=>ha,rotateByQuatAppend:()=>sa,rotateByQuatPrepend:()=>aa,rotateX:()=>ta,rotateY:()=>ia,rotateZ:()=>na,scale:()=>la,set:()=>Zs,setDual:()=>us,setReal:()=>$s,sqrLen:()=>Ma,squaredLength:()=>dr,str:()=>ga,translate:()=>ea});function Gs(){var r=new P(8);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function Xs(r){var e=new P(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function Bs(r,e,t,i,n,s,a,h){var c=new P(8);return c[0]=r,c[1]=e,c[2]=t,c[3]=i,c[4]=n,c[5]=s,c[6]=a,c[7]=h,c}function Ws(r,e,t,i,n,s,a){var h=new P(8);h[0]=r,h[1]=e,h[2]=t,h[3]=i;var c=n*.5,o=s*.5,l=a*.5;return h[4]=c*i+o*t-l*e,h[5]=o*i+l*r-c*t,h[6]=l*i+c*e-o*r,h[7]=-c*r-o*e-l*t,h}function Fe(r,e,t){var i=t[0]*.5,n=t[1]*.5,s=t[2]*.5,a=e[0],h=e[1],c=e[2],o=e[3];return r[0]=a,r[1]=h,r[2]=c,r[3]=o,r[4]=i*o+n*c-s*h,r[5]=n*o+s*a-i*c,r[6]=s*o+i*h-n*a,r[7]=-i*a-n*h-s*c,r}function js(r,e){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0]*.5,r[5]=e[1]*.5,r[6]=e[2]*.5,r[7]=0,r}function ks(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function Hs(r,e){var t=ir();Cr(t,e);var i=new P(3);return Yr(i,e),Fe(r,t,i),r}function qe(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function Qs(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function Zs(r,e,t,i,n,s,a,h,c){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r[4]=s,r[5]=a,r[6]=h,r[7]=c,r}var Ks=vr;function Js(r,e){return r[0]=e[4],r[1]=e[5],r[2]=e[6],r[3]=e[7],r}var $s=vr;function us(r,e){return r[4]=e[0],r[5]=e[1],r[6]=e[2],r[7]=e[3],r}function ra(r,e){var t=e[4],i=e[5],n=e[6],s=e[7],a=-e[0],h=-e[1],c=-e[2],o=e[3];return r[0]=(t*o+s*a+i*c-n*h)*2,r[1]=(i*o+s*h+n*a-t*c)*2,r[2]=(n*o+s*c+t*h-i*a)*2,r}function ea(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=t[0]*.5,c=t[1]*.5,o=t[2]*.5,l=e[4],p=e[5],f=e[6],x=e[7];return r[0]=i,r[1]=n,r[2]=s,r[3]=a,r[4]=a*h+n*o-s*c+l,r[5]=a*c+s*h-i*o+p,r[6]=a*o+i*c-n*h+f,r[7]=-i*h-n*c-s*o+x,r}function ta(r,e,t){var i=-e[0],n=-e[1],s=-e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=h*a+l*i+c*s-o*n,f=c*a+l*n+o*i-h*s,x=o*a+l*s+h*n-c*i,M=l*a-h*i-c*n-o*s;return Zr(r,e,t),i=r[0],n=r[1],s=r[2],a=r[3],r[4]=p*a+M*i+f*s-x*n,r[5]=f*a+M*n+x*i-p*s,r[6]=x*a+M*s+p*n-f*i,r[7]=M*a-p*i-f*n-x*s,r}function ia(r,e,t){var i=-e[0],n=-e[1],s=-e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=h*a+l*i+c*s-o*n,f=c*a+l*n+o*i-h*s,x=o*a+l*s+h*n-c*i,M=l*a-h*i-c*n-o*s;return Kr(r,e,t),i=r[0],n=r[1],s=r[2],a=r[3],r[4]=p*a+M*i+f*s-x*n,r[5]=f*a+M*n+x*i-p*s,r[6]=x*a+M*s+p*n-f*i,r[7]=M*a-p*i-f*n-x*s,r}function na(r,e,t){var i=-e[0],n=-e[1],s=-e[2],a=e[3],h=e[4],c=e[5],o=e[6],l=e[7],p=h*a+l*i+c*s-o*n,f=c*a+l*n+o*i-h*s,x=o*a+l*s+h*n-c*i,M=l*a-h*i-c*n-o*s;return Jr(r,e,t),i=r[0],n=r[1],s=r[2],a=r[3],r[4]=p*a+M*i+f*s-x*n,r[5]=f*a+M*n+x*i-p*s,r[6]=x*a+M*s+p*n-f*i,r[7]=M*a-p*i-f*n-x*s,r}function sa(r,e,t){var i=t[0],n=t[1],s=t[2],a=t[3],h=e[0],c=e[1],o=e[2],l=e[3];return r[0]=h*a+l*i+c*s-o*n,r[1]=c*a+l*n+o*i-h*s,r[2]=o*a+l*s+h*n-c*i,r[3]=l*a-h*i-c*n-o*s,h=e[4],c=e[5],o=e[6],l=e[7],r[4]=h*a+l*i+c*s-o*n,r[5]=c*a+l*n+o*i-h*s,r[6]=o*a+l*s+h*n-c*i,r[7]=l*a-h*i-c*n-o*s,r}function aa(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=t[0],c=t[1],o=t[2],l=t[3];return r[0]=i*l+a*h+n*o-s*c,r[1]=n*l+a*c+s*h-i*o,r[2]=s*l+a*o+i*c-n*h,r[3]=a*l-i*h-n*c-s*o,h=t[4],c=t[5],o=t[6],l=t[7],r[4]=i*l+a*h+n*o-s*c,r[5]=n*l+a*c+s*h-i*o,r[6]=s*l+a*o+i*c-n*h,r[7]=a*l-i*h-n*c-s*o,r}function ha(r,e,t,i){if(Math.abs(i)<y)return qe(r,e);var n=Math.hypot(t[0],t[1],t[2]);i=i*.5;var s=Math.sin(i),a=s*t[0]/n,h=s*t[1]/n,c=s*t[2]/n,o=Math.cos(i),l=e[0],p=e[1],f=e[2],x=e[3];r[0]=l*o+x*a+p*c-f*h,r[1]=p*o+x*h+f*a-l*c,r[2]=f*o+x*c+l*h-p*a,r[3]=x*o-l*a-p*h-f*c;var M=e[4],g=e[5],v=e[6],d=e[7];return r[4]=M*o+d*a+g*c-v*h,r[5]=g*o+d*h+v*a-M*c,r[6]=v*o+d*c+M*h-g*a,r[7]=d*o-M*a-g*h-v*c,r}function ca(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r}function Ue(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],h=t[4],c=t[5],o=t[6],l=t[7],p=e[4],f=e[5],x=e[6],M=e[7],g=t[0],v=t[1],d=t[2],E=t[3];return r[0]=i*E+a*g+n*d-s*v,r[1]=n*E+a*v+s*g-i*d,r[2]=s*E+a*d+i*v-n*g,r[3]=a*E-i*g-n*v-s*d,r[4]=i*l+a*h+n*o-s*c+p*E+M*g+f*d-x*v,r[5]=n*l+a*c+s*h-i*o+f*E+M*v+x*g-p*d,r[6]=s*l+a*o+i*c-n*h+x*E+M*d+p*v-f*g,r[7]=a*l-i*h-n*c-s*o+M*E-p*g-f*v-x*d,r}var oa=Ue;function la(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r}var Ve=Mr;function pa(r,e,t,i){var n=1-i;return Ve(e,t)<0&&(i=-i),r[0]=e[0]*n+t[0]*i,r[1]=e[1]*n+t[1]*i,r[2]=e[2]*n+t[2]*i,r[3]=e[3]*n+t[3]*i,r[4]=e[4]*n+t[4]*i,r[5]=e[5]*n+t[5]*i,r[6]=e[6]*n+t[6]*i,r[7]=e[7]*n+t[7]*i,r}function fa(r,e){var t=dr(e);return r[0]=-e[0]/t,r[1]=-e[1]/t,r[2]=-e[2]/t,r[3]=e[3]/t,r[4]=-e[4]/t,r[5]=-e[5]/t,r[6]=-e[6]/t,r[7]=e[7]/t,r}function xa(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=e[7],r}var Ge=mr,va=Ge,dr=gr,Ma=dr;function ma(r,e){var t=dr(e);if(t>0){t=Math.sqrt(t);var i=e[0]/t,n=e[1]/t,s=e[2]/t,a=e[3]/t,h=e[4],c=e[5],o=e[6],l=e[7],p=i*h+n*c+s*o+a*l;r[0]=i,r[1]=n,r[2]=s,r[3]=a,r[4]=(h-i*p)/t,r[5]=(c-n*p)/t,r[6]=(o-s*p)/t,r[7]=(l-a*p)/t}return r}function ga(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"}function da(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]}function ya(r,e){var t=r[0],i=r[1],n=r[2],s=r[3],a=r[4],h=r[5],c=r[6],o=r[7],l=e[0],p=e[1],f=e[2],x=e[3],M=e[4],g=e[5],v=e[6],d=e[7];return Math.abs(t-l)<=y*Math.max(1,Math.abs(t),Math.abs(l))&&Math.abs(i-p)<=y*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(n-f)<=y*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(s-x)<=y*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-M)<=y*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(h-g)<=y*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(c-v)<=y*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(o-d)<=y*Math.max(1,Math.abs(o),Math.abs(d))}var W={};G(W,{add:()=>Ta,angle:()=>Wa,ceil:()=>Pa,clone:()=>wa,copy:()=>Aa,create:()=>Xe,cross:()=>_a,dist:()=>ua,distance:()=>ke,div:()=>$a,divide:()=>je,dot:()=>Ca,equals:()=>Qa,exactEquals:()=>Ha,floor:()=>za,forEach:()=>t1,fromValues:()=>Ea,inverse:()=>Oa,len:()=>Za,length:()=>Qe,lerp:()=>Fa,max:()=>Ia,min:()=>Sa,mul:()=>Ja,multiply:()=>We,negate:()=>Na,normalize:()=>Ya,random:()=>qa,rotate:()=>Ba,round:()=>ba,scale:()=>La,scaleAndAdd:()=>Da,set:()=>Ra,sqrDist:()=>r1,sqrLen:()=>e1,squaredDistance:()=>He,squaredLength:()=>Ze,str:()=>ka,sub:()=>Ka,subtract:()=>Be,transformMat2:()=>Ua,transformMat2d:()=>Va,transformMat3:()=>Ga,transformMat4:()=>Xa,zero:()=>ja});function Xe(){var r=new P(2);return P!=Float32Array&&(r[0]=0,r[1]=0),r}function wa(r){var e=new P(2);return e[0]=r[0],e[1]=r[1],e}function Ea(r,e){var t=new P(2);return t[0]=r,t[1]=e,t}function Aa(r,e){return r[0]=e[0],r[1]=e[1],r}function Ra(r,e,t){return r[0]=e,r[1]=t,r}function Ta(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function Be(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function We(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r}function je(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r}function Pa(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}function za(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}function Sa(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r}function Ia(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r}function ba(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}function La(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r}function Da(r,e,t,i){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r}function ke(r,e){var t=e[0]-r[0],i=e[1]-r[1];return Math.hypot(t,i)}function He(r,e){var t=e[0]-r[0],i=e[1]-r[1];return t*t+i*i}function Qe(r){var e=r[0],t=r[1];return Math.hypot(e,t)}function Ze(r){var e=r[0],t=r[1];return e*e+t*t}function Na(r,e){return r[0]=-e[0],r[1]=-e[1],r}function Oa(r,e){return r[0]=1/e[0],r[1]=1/e[1],r}function Ya(r,e){var t=e[0],i=e[1],n=t*t+i*i;return n>0&&(n=1/Math.sqrt(n)),r[0]=e[0]*n,r[1]=e[1]*n,r}function Ca(r,e){return r[0]*e[0]+r[1]*e[1]}function _a(r,e,t){var i=e[0]*t[1]-e[1]*t[0];return r[0]=r[1]=0,r[2]=i,r}function Fa(r,e,t,i){var n=e[0],s=e[1];return r[0]=n+i*(t[0]-n),r[1]=s+i*(t[1]-s),r}function qa(r,e){e=e||1;var t=U()*2*Math.PI;return r[0]=Math.cos(t)*e,r[1]=Math.sin(t)*e,r}function Ua(r,e,t){var i=e[0],n=e[1];return r[0]=t[0]*i+t[2]*n,r[1]=t[1]*i+t[3]*n,r}function Va(r,e,t){var i=e[0],n=e[1];return r[0]=t[0]*i+t[2]*n+t[4],r[1]=t[1]*i+t[3]*n+t[5],r}function Ga(r,e,t){var i=e[0],n=e[1];return r[0]=t[0]*i+t[3]*n+t[6],r[1]=t[1]*i+t[4]*n+t[7],r}function Xa(r,e,t){var i=e[0],n=e[1];return r[0]=t[0]*i+t[4]*n+t[12],r[1]=t[1]*i+t[5]*n+t[13],r}function Ba(r,e,t,i){var n=e[0]-t[0],s=e[1]-t[1],a=Math.sin(i),h=Math.cos(i);return r[0]=n*h-s*a+t[0],r[1]=n*a+s*h+t[1],r}function Wa(r,e){var t=r[0],i=r[1],n=e[0],s=e[1],a=Math.sqrt(t*t+i*i)*Math.sqrt(n*n+s*s),h=a&&(t*n+i*s)/a;return Math.acos(Math.min(Math.max(h,-1),1))}function ja(r){return r[0]=0,r[1]=0,r}function ka(r){return"vec2("+r[0]+", "+r[1]+")"}function Ha(r,e){return r[0]===e[0]&&r[1]===e[1]}function Qa(r,e){var t=r[0],i=r[1],n=e[0],s=e[1];return Math.abs(t-n)<=y*Math.max(1,Math.abs(t),Math.abs(n))&&Math.abs(i-s)<=y*Math.max(1,Math.abs(i),Math.abs(s))}var Za=Qe,Ka=Be,Ja=We,$a=je,ua=ke,r1=He,e1=Ze,t1=function(){var r=Xe();return function(e,t,i,n,s,a){var h,c;for(t||(t=2),i||(i=0),n?c=Math.min(n*t+i,e.length):c=e.length,h=i;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],s(r,r,a),e[h]=r[0],e[h+1]=r[1];return e}}();var H=class{position=S.fromValues(0,0,-1);direction=S.fromValues(0,0,-1);up=S.fromValues(0,1,0);projectionMatrix=O.create();viewMatrix=O.create();cameraMatrix=O.create();viewportWidth=0;viewportHeight=0;near=1;far=100;tpmVec=S.create();constructor(){}lookAt(...e){if(e.length==1)S.copy(this.tpmVec,e[0]);else if(e.length==3)S.set(this.tpmVec,...e);else throw new Error("required 1 or 3 arguments");S.sub(this.tpmVec,this.tpmVec,this.position),S.normalize(this.tpmVec,this.tpmVec);let t=S.dot(this.tpmVec,this.up);V.equals(t,1)?S.negate(this.up,this.direction):V.equals(t,-1)&&S.copy(this.up,this.direction),S.copy(this.direction,this.tpmVec),S.cross(this.up,this.getRight(),this.direction),S.normalize(this.up,this.up)}getRight(){return S.cross(this.tpmVec,this.direction,this.up)}updateConstants(e){O.lookAt(this.viewMatrix,this.position,S.add(this.tpmVec,this.position,this.direction),this.up),O.invert(this.cameraMatrix,this.viewMatrix),e.projectionMatrix=this.projectionMatrix,e.viewMatrix=this.viewMatrix,e.cameraMatrix=this.cameraMatrix,e.cameraPosition=this.position}};var F=class{buffers=new Map;buffersToDelete=[];vertexCount=0;options;constructor(e={}){this.options=e,this.onInit()}onInit(){}bufferData(e,t,i){let n=m.gl.createBuffer();i=="index"?(m.gl.bindBuffer(m.gl.ELEMENT_ARRAY_BUFFER,n),m.gl.bufferData(m.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),m.gl.STATIC_DRAW),this.vertexCount=e.length):(m.gl.bindBuffer(m.gl.ARRAY_BUFFER,n),m.gl.bufferData(m.gl.ARRAY_BUFFER,new Float32Array(e),m.gl.STATIC_DRAW)),this.buffers.has(i)&&this.buffersToDelete.push(this.buffers.get(i).buffer),this.buffers.set(i,{size:t,data:e,buffer:n})}bind(e){this.buffers.forEach((t,i)=>{let n=e.shaderData.attribs[i];n!=-1&&(i=="index"?m.gl.bindBuffer(m.gl.ELEMENT_ARRAY_BUFFER,t.buffer):(m.gl.bindBuffer(m.gl.ARRAY_BUFFER,t.buffer),m.gl.vertexAttribPointer(n,t.size,m.gl.FLOAT,!1,0,0),m.gl.enableVertexAttribArray(n)))})}draw(){m.gl.drawElements(m.gl.TRIANGLES,this.vertexCount,m.gl.UNSIGNED_SHORT,0)}unbind(e){this.buffers.forEach((t,i)=>{let n=e.shaderData.attribs[i];n!=-1&&i!="index"&&m.gl.disableVertexAttribArray(n)})}dispose(){for(let e of this.buffersToDelete)m.gl.deleteBuffer(e);this.buffersToDelete.length=0}};var B=class{shaderData;uniforms=new Map;constructor(e){this.shaderData=e,this.setUniform("uvOffset",[0,0])}setUniform(e,t){this.uniforms.set(e,t)}activate(){this.shaderData.activate()}bind(e){for(let t of this.shaderData.uniforms){let i=e[t.name];if(this.uniforms.has(t.name)&&(i=this.uniforms.get(t.name)),i&&t.location){let n=t.type,s=t.location;switch(n){case"mat4":m.gl.uniformMatrix4fv(s,!1,i);break;case"mat3":m.gl.uniformMatrix3fv(s,!1,val);break;case"vec4":m.gl.uniform4fv(s,i);break;case"vec3":m.gl.uniform3fv(s,i);break;case"vec2":m.gl.uniform2fv(s,i);break;case"float":m.gl.uniform1f(s,i);break}}}}};var Q=class{mesh;shader;texture;position=S.create();rotation=J.create();scale=S.fromValues(1,1,1);parent=null;modelMatrix=O.create();normalMatrix=O.create();matrixAutoUpdate=!0;matrixNeedsUpdate=!0;constructor(e,t,i){this.mesh=e,this.shader=t,this.texture=i}draw(e){this.shader.activate(),this.texture&&this.texture.bind(),(this.matrixNeedsUpdate||this.matrixAutoUpdate)&&(this.matrixNeedsUpdate=!1,O.fromRotationTranslationScale(this.modelMatrix,this.rotation,this.position,this.scale),k.fromMat4(this.normalMatrix,this.modelMatrix),k.invert(this.normalMatrix,this.normalMatrix),k.transpose(this.normalMatrix,this.normalMatrix));let t=e.viewMatrix,i=O.create();O.multiply(i,t,this.modelMatrix),this.shader.setUniform("modelViewMatrix",i),this.shader.setUniform("modelMatrix",this.modelMatrix),this.shader.setUniform("normalMatrix",this.normalMatrix),this.shader.bind(e),this.mesh.bind(this.shader),this.mesh.draw(),this.mesh.unbind(this.shader)}};var yr=class extends H{fov;constructor(e,t,i,n,s){super(),this.fov=e,this.viewportWidth=t,this.viewportHeight=i,this.near=n,this.far=s,this.updateProjection()}updateProjection(){let e=this.viewportWidth/this.viewportHeight;O.perspective(this.projectionMatrix,this.fov/180*Math.PI,e,this.near,this.far)}};var re={};G(re,{Cube:()=>wr,Plane:()=>Er,Quad:()=>$,Sphere:()=>Ar});var wr=class extends F{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.height?this.options.height/2:.5,i=this.options.depth?this.options.depth/2:.5,n=[-e,t,i,e,t,i,e,-t,i,-e,-t,i,-e,t,-i,e,t,-i,e,-t,-i,-e,-t,-i,-e,t,-i,e,t,-i,e,t,i,-e,t,i,-e,-t,i,e,-t,i,e,-t,-i,-e,-t,-i,e,t,i,e,t,-i,e,-t,-i,e,-t,i,-e,t,-i,-e,t,i,-e,-t,i,-e,-t,-i],s=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],a="single";this.options.textureFaces!==void 0&&(a=this.options.textureFaces);let h=[];if(a=="single")for(let p=0;p<6;++p)h.push(0,0,1,0,1,1,0,1);else if(a=="multiple"){let x=(M,g)=>{h.push(M*.25,g*.5,.25*(M+1),g*.5,.25*(M+1),.5*(g+1),M*.25,.5*(g+1))};x(1,0),x(3,0),x(0,1),x(1,1),x(2,0),x(0,0)}else throw new Error("options.textureFaces valid values are single or multiple");let c=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],o=[];if(this.options.colors===void 0)for(let p=0;p<24;++p)o.push(1);else if(this.options.colors.length==1){let p=this.options.colors[0];for(let f=0;f<24;++f)o.push(p[f%4])}else if(this.options.colors.length==6)for(let p=0;p<6;++p){let f=this.options.colors[p];for(let x=0;x<4;++x)o.push(f[x])}else throw new Error("options.colors requires 1 or 6 elements");let l=[];for(let p=0;p<6;++p)for(let f=0;f<4;++f)for(let x=0;x<4;++x)l.push(o[p*4+x]);this.bufferData(n,3,"positions"),this.bufferData(s,3,"normals"),this.bufferData(l,4,"colors"),this.bufferData(h,2,"uvs"),this.bufferData(c,0,"index")}};var Er=class extends F{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.depth?this.options.depth/2:.5,i=this.options.widthSegments||1,n=this.options.depthSegments||1,s=this.options.heightMap||[...new Array(n+1)].map(p=>[...new Array(i+1)].fill(0)),a=[],h=[],c=[],o=[],l=[];for(let p=0;p<n;++p)for(let f=0;f<i;++f){a.push((2*f/i-1)*e,s[p][f],(2*p/n-1)*t,(2*(f+1)/i-1)*e,s[p][f+1],(2*p/n-1)*t,(2*(f+1)/i-1)*e,s[p+1][f+1],(2*(p+1)/n-1)*t,(2*f/i-1)*e,s[p+1][f],(2*(p+1)/n-1)*t),h.push(0,1,0,0,1,0,0,1,0,0,1,0),this.options.textureRepeat===void 0||this.options.textureRepeat===!1?c.push(f/i,p/n,(f+1)/i,p/n,(f+1)/i,(p+1)/n,f/i,(p+1)/n):c.push(0,0,1,0,1,1,0,1);let x=(p*i+f)*4;l.push(x,x+1,x+2,x,x+2,x+3)}if(this.options.colors===void 0)for(let p=0;p<i*n*16;++p)o.push(1);else if(this.options.colors.length==1){let p=this.options.colors[0];for(let f=0;f<i*n*16;++f)o.push(p[f%4])}else throw new Error("options.colors requires 1 elements");this.bufferData(a,3,"positions"),this.bufferData(h,3,"normals"),this.bufferData(o,4,"colors"),this.bufferData(c,2,"uvs"),this.bufferData(l,0,"index")}};var $=class extends F{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.height?this.options.height/2:.5,i=[-e,t,0,e,t,0,e,-t,0,-e,-t,0],n=[0,0,1,0,0,1,0,0,1,0,0,1],s=[];if(this.options.colors===void 0)for(let c=0;c<16;++c)s.push(1);else if(this.options.colors.length==1){let c=this.options.colors[0];for(let o=0;o<16;++o)s.push(c[o%4])}else if(this.options.colors.length==4)for(let c=0;c<4;++c){let o=this.options.colors[c];for(let l=0;l<4;++l)s.push(o[l])}else throw new Error("options.colors requires 1 or 4 elements");let a=[0,0,1,0,1,1,0,1],h=[0,1,2,0,2,3];this.bufferData(i,3,"positions"),this.bufferData(n,3,"normals"),this.bufferData(s,4,"colors"),this.bufferData(a,2,"uvs"),this.bufferData(h,0,"index")}};var u=class{points=[];constructor(e){this.lerp=e}addPoint(e,t){this.points.push([e,t]);for(let i=this.points.length-1;i>0&&!(this.points[i][0]>=this.points[i-1][0]);--i)[this.points[i],this.points[i-1]]=[this.points[i-1],this.points[i]]}getValue(e){let t=0;for(let a=0;a<this.points.length&&!(e<this.points[a][0]);++a)t=a;let i=this.points[t],n=Math.min(t+1,this.points.length-1);if(t==n)return i[1];let s=this.points[n];return this.lerp((e-i[0])/(s[0]-i[0]),i[1],s[1])}};var Ar=class extends F{onInit(){let e=this.options.radius||.5,t=this.options.widthSegments||32,i=this.options.heightSegments||16,n=[],s=[],a=[],h=[],c=[],o=[],l=[];for(let f=0;f<=i;++f){let x=f/i*Math.PI,M=Math.sin(x),g=Math.cos(x);for(let v=0;v<=t;++v){let d=v/t*2*Math.PI,E=Math.sin(d),w=Math.cos(d);c.push([M*w*e,g*e,M*E*e]),o.push([1-v/t,f/i])}}if(this.options.colors===void 0)for(let f=0;f<(t+1)*(i+1);++f)l.push([1,1,1,1]);else if(this.options.colors instanceof u)for(let f=0;f<=i;++f){let x=this.options.colors.getValue(f/i);for(let M=0;M<=t;++M)l.push(x)}else if(this.options.colors.length==1){let f=this.options.colors[0];for(let x=0;x<(t+1)*(i+1);++x)l.push(f)}else throw new Error("options.colors requires 1 elements");let p=0;for(let f=0;f<i;++f)for(let x=0;x<t;++x){let M=f*(t+1)+x,g=M+(t+1),v=[M,M+1,g+1,g];for(let d of v)n.push(...c[d]),s.push(...o[d]),a.push(...l[d]);h.push(p,p+1,p+2,p,p+2,p+3),p+=4}this.bufferData(n,3,"positions"),this.bufferData(a,4,"colors"),this.bufferData(s,2,"uvs"),this.bufferData(h,0,"index")}};var Rr=class extends H{zoom=1;constructor(e,t){super(),this.near=0,this.setToOrtho(e,t)}setToOrtho(e,t){this.viewportWidth=e,this.viewportHeight=t,S.set(this.position,this.zoom*e/2,this.zoom*t/2,0),this.updateProjection()}updateProjection(){O.ortho(this.projectionMatrix,this.zoom*-this.viewportWidth/2,this.zoom*this.viewportWidth/2,this.zoom*-this.viewportHeight/2,this.zoom*this.viewportHeight/2,this.near,this.far)}translate(...e){if(e.length==1)S.set(this.position,...e[0],0);else if(e.length==2)S.set(this.position,e[0],e[1],0);else throw new Error("required 1 or 2 arguments")}zoomBy(...e){let t=e[0];if(this.zoom*=1+t,e.length==2||e.length==3){let i=W.create();e.length==2?W.copy(i,e[1]):W.set(i,...e),W.sub(i,i,this.position),W.scale(i,i,t),S.add(this.position,this.position,[...i,0])}}};var Tr=class extends Q{regionX;regionY;regionWidth;regionHeight;constructor(...e){let t=e[0],i=0,n=0,s=t.width,a=t.height;e.length==3?(s=e[1],a=e[2]):e.length==5&&(i=e[1],n=e[2],s=e[3],a=e[4]),super(new $,new B(m.graphics.getShader("texture")),t),this.setRegionSize(s,a),this.setRegionPosition(i,n)}setRegionSize(e,t){this.regionWidth=e,this.regionHeight=t;let i=[0,0,e/this.texture.width,0,e/this.texture.width,t/this.texture.height,0,t/this.texture.height];this.mesh.bufferData(i,2,"uvs")}setRegionPosition(e,t){this.regionX=e,this.regionY=t,this.shader.setUniform("uvOffset",[e/this.texture.width,t/this.texture.height])}};var Pr=class extends Q{font;text;rainbow;constructor(e,t,i=!1){super(new F,new B(m.graphics.getShader("texture")),e.texture),this.font=e,this.text=t,this.rainbow=i,this.updateGeometry()}updateGeometry(){let e=[],t=[],i=[],n=[],s=this.font.charWidth,a=this.font.charHeight,h=this.font.options.charRatio,c=(1-this.text.length)*h*.5;for(let o=0;o<this.text.length;++o){let l=this.text.charCodeAt(o),p=this.font.getCharPosition(l);if(p===null)continue;let[f,x]=p;e.push(-.5*h+c,.5,0,.5*h+c,.5,0,.5*h+c,-.5,0,-.5*h+c,-.5,0),i.push(f/this.texture.width,x/this.texture.height,(f+s)/this.texture.width,x/this.texture.height,(f+s)/this.texture.width,(x+a)/this.texture.height,f/this.texture.width,(x+a)/this.texture.height);let M=o*4;n.push(M,M+1,M+2,M,M+2,M+3),c+=h}if(this.rainbow)for(let o=0;o<4*this.text.length;++o)t.push(Math.random(),Math.random(),Math.random(),1);else for(let o=0;o<4*this.text.length;++o)t.push(1,1,1,1);this.mesh.bufferData(e,3,"positions"),this.mesh.bufferData(t,4,"colors"),this.mesh.bufferData(i,2,"uvs"),this.mesh.bufferData(n,0,"index")}setText(e){this.text=e,this.updateGeometry()}};var zr=class{mesh;texture;shader;particles=[];constructor(e){this.mesh=new F,this.texture=e.texture,this.shader=new B(m.graphics.getShader("particle"))}addParticles(){}updateParticles(){}updateGeometry(){let e=[],t=[],i=[];for(let n of this.particles)e.push(...n.position),t.push(...n.color,n.alpha),i.push(n.size);this.mesh.bufferData(e,3,"positions"),this.mesh.bufferData(t,4,"colors"),this.mesh.bufferData(i,1,"sizes")}draw(e){this.shader.activate(),this.texture.bind();let t=O.create(),i=e.viewMatrix,n=O.create();O.multiply(n,i,t),this.shader.setUniform("modelViewMatrix",n),this.shader.bind(e),this.mesh.bind(this.shader);let s=this.particles.length;m.gl.drawArrays(m.gl.POINTS,0,s),this.mesh.unbind(this.shader)}update(){this.addParticles(),this.updateParticles(),this.updateGeometry()}};var ee=class{touchInfo=[];keyInfo={currentlyPressed:new Set,previouslyPressed:new Set,justPressed:new Set};constructor(){for(let e=0;e<ee.MAX_TOUCHES;++e)this.touchInfo[e]={x:null,y:null,isTouched:!1,wasTouched:!1,isJustTouched:!1}}isKeyPressed(e){return this.keyInfo.currentlyPressed.has(e)}isKeyClicked(e){return this.keyInfo.justPressed.has(e)}isTouched(e=0){return this.touchInfo[e].isTouched}isJustTouched(e=0){return this.touchInfo[e].isJustTouched}isMousePressed(){return this.isTouched()}isMouseClicked(){return this.isJustTouched()}getX(e=0){return this.touchInfo[e].x}getY(e=0){return this.touchInfo[e].y}initEvents(){let e=m.graphics.canvas;addEventListener("keydown",t=>this.onKeyDown(t)),addEventListener("keyup",t=>this.onKeyUp(t)),e.addEventListener("touchstart",t=>this.handleTouchEvent(t)),e.addEventListener("touchmove",t=>this.handleTouchEvent(t)),e.addEventListener("touchend",t=>this.handleTouchEvent(t)),e.addEventListener("mousedown",t=>this.handleMouseEvent(t)),e.addEventListener("mousemove",t=>this.handleMouseEvent(t)),e.addEventListener("mouseup",t=>this.handleMouseEvent(t))}handleTouchEvent(e){let t=e.target.getBoundingClientRect();for(let i of e.changedTouches){let n=i.pageX-t.x,s=i.pageY-t.y,a=this.touchInfo[i.identifier];switch(a.x=n,a.y=s,e.type){case"touchstart":a.isTouched=!0;break;case"touchend":a.isTouched=!1}}}handleMouseEvent(e){let t=e.target.getBoundingClientRect(),i=e.pageX-t.x,n=e.pageY-t.y,s=this.touchInfo[0];switch(s.x=i,s.y=n,e.type){case"mousedown":s.isTouched=!0;break;case"mouseup":s.isTouched=!1}}onKeyDown(e){this.keyInfo.currentlyPressed.add(e.code)}onKeyUp(e){this.keyInfo.currentlyPressed.delete(e.code)}update(){this.keyInfo.currentlyPressed.forEach(e=>{this.keyInfo.previouslyPressed.has(e)||this.keyInfo.justPressed.add(e)}),this.keyInfo.previouslyPressed=new Set(this.keyInfo.currentlyPressed);for(let e of this.touchInfo)e.isJustTouched=e.isTouched&&!e.wasTouched,e.wasTouched=e.isTouched}},nr=ee;q(nr,"MAX_TOUCHES",10);var $e={};G($e,{LinearSpline:()=>u,MathUtils:()=>j});var j=class{static lerp(e,t,i){return(i-t)*e+t}static rand(e,t){return Math.random()*(t-e)+e}static randInt(e,t){return Math.floor(this.rand(e,t+1))}static clamp(e,t,i){return Math.min(Math.max(e,t),i)}static sat(e){return this.clamp(e,0,1)}static shuffle(e){for(let t=0;t<e.length;++t){let i=this.randInt(0,e.length-1);[e[t],e[i]]=[e[i],e[t]]}}static choice(e){return e[this.randInt(0,e.length-1)]}};var Sr=class{audioContext;bgMusicNode=null;masterGain;bgMusicGain;cueGain;constructor(){this.audioContext=new AudioContext,this.masterGain=this.audioContext.createGain(),this.masterGain.connect(this.audioContext.destination),this.masterGain.gain.value=.5,this.bgMusicGain=this.audioContext.createGain(),this.bgMusicGain.connect(this.masterGain),this.bgMusicGain.gain.value=.5,this.cueGain=this.audioContext.createGain(),this.cueGain.connect(this.masterGain),this.cueGain.gain.value=.5}get masterVolume(){return this.masterGain.gain.value}set masterVolume(e){this.masterGain.gain.value=j.sat(e)}get bgMusicVolume(){return this.bgMusicGain.gain.value}set bgMusicVolume(e){this.bgMusicGain.gain.value=j.sat(e)}get cueVolume(){return this.cueGain.gain.value}set cueVolume(e){this.cueGain.gain.value=j.sat(e)}playBgMusic(e,t={}){let i=t.loop===void 0?!0:t.loop,n=t.time===void 0?0:t.time,s=m.files.get(e);this.stopBgMusic(),this.bgMusicNode=this.audioContext.createBufferSource(),this.bgMusicNode.buffer=s,this.bgMusicNode.loop=i,this.bgMusicNode.start(n),this.bgMusicNode.connect(this.bgMusicGain)}stopBgMusic(){this.isBgMusicPlaying()&&(this.bgMusicNode.stop(0),this.bgMusicNode=null)}isBgMusicPlaying(){return this.bgMusicNode!==null}playCue(e,t=.5){let i=m.files.get(e),n=this.audioContext.createBufferSource();n.buffer=i,n.start(0);let s=this.audioContext.createGain();s.connect(this.cueGain),s.gain.value=j.sat(t),n.connect(s)}onResume(){this.audioContext.state=="suspended"&&this.audioContext.resume()}};var Ir=class{type;constructor(){this.detectDeviceType()}detectDeviceType(){let e=navigator.userAgent;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(e)?this.type="mobile":this.type="desktop"}};var m=class{static async init(e){this.graphics=new ar(e),this.files=new sr,this.input=new nr,this.audio=new Sr,this.device=new Ir;for(let t of["mousedown","touchdown","keydown"])addEventListener(t,()=>this.audio.onResume());this.input.initEvents(),this.graphics.compileShaders(),this.graphics.generateFonts(),e.preload(),await this.files.waitForAssetsToLoad(),e.create(),addEventListener("resize",()=>this.graphics.onResize()),this.graphics.onResize(),this.graphics.onResume()}static get gl(){return this.graphics.gl}};q(m,"graphics"),q(m,"files"),q(m,"input"),q(m,"audio"),q(m,"device");export{Lr as Game,m as Gol,br as Screen,Ke as glMatrix,Je as graphics,$e as math};
//# sourceMappingURL=goliath.js.map
