var ee=Object.defineProperty;var Ke=(r,e,t)=>e in r?ee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var V=(r,e)=>{for(var t in e)ee(r,t,{get:e[t],enumerable:!0})};var X=(r,e,t)=>(Ke(r,typeof e!="symbol"?e+"":e,t),t);var nr=class{assets=new Map;toLoad=0;loadImage(e,t){let n=new Image;n.src=t,n.crossOrigin="Anonymous";let i=new Promise(a=>{n.onload=()=>{a(n)}});return this.addAsync(e,i),i}loadAudio(e,t){let n=new Audio(t);n.load();let i=new Promise(a=>{n.oncanplaythrough=()=>{a(n)}});return this.addAsync(e,i),i}addAsync(e,t){++this.toLoad,t.then(n=>{this.assets.set(e,n),--this.toLoad})}waitForAssetsToLoad(){return new Promise(e=>{let t=()=>{this.toLoad==0?e(this.assets):setTimeout(()=>{t()},250)};t()})}get(e){return this.assets.get(e)}};var Sr=class{constructor(){}preload(){}create(){}resize(e,t){}render(e){}};var Q=class{id;data;constructor(e,t={}){this.data=e,this.id=g.gl.createTexture(),g.gl.bindTexture(g.gl.TEXTURE_2D,this.id),g.gl.texImage2D(g.gl.TEXTURE_2D,0,g.gl.RGBA,g.gl.RGBA,g.gl.UNSIGNED_BYTE,e),g.gl.generateMipmap(g.gl.TEXTURE_2D),g.gl.bindTexture(g.gl.TEXTURE_2D,null),t.filter!==void 0&&this.setFilter(t.filter),t.wrap!==void 0&&this.setWrap(t.wrap)}setFilter(e){g.gl.bindTexture(g.gl.TEXTURE_2D,this.id),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_MIN_FILTER,e),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_MAG_FILTER,e==g.gl.NEAREST?g.gl.NEAREST:g.gl.LINEAR),g.gl.bindTexture(g.gl.TEXTURE_2D,null)}setWrap(e){g.gl.bindTexture(g.gl.TEXTURE_2D,this.id),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_WRAP_S,e),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_WRAP_T,e),g.gl.bindTexture(g.gl.TEXTURE_2D,null)}bind(){g.gl.bindTexture(g.gl.TEXTURE_2D,this.id)}dispose(){g.gl.deleteTexture(this.id)}get width(){return this.data.width}get height(){return this.data.height}};var Z=class{options;columns=10;charFrom=32;charTo=126;bitmap;texture;charWidth;charHeight;constructor(e){this.options=e,this.charWidth=e.fontSize*e.charRatio,this.charHeight=e.fontSize*1.2,this.bitmap=this.generateBitmap(),this.texture=new Q(this.bitmap,{filter:g.gl.LINEAR_MIPMAP_LINEAR})}generateBitmap(){let e=document.createElement("canvas"),t=this.charTo-this.charFrom+1,n=Math.floor(t/this.columns);e.width=2**Math.ceil(Math.log2(this.columns*this.charWidth)),e.height=2**Math.ceil(Math.log2(n*this.charHeight));let i=e.getContext("2d");i.textBaseline="middle",i.textAlign="center",i.fillStyle="white",i.font=`${this.options.fontSize}px ${this.options.fontFamily}`;for(let a=0;a<t;++a){let s=String.fromCharCode(a+this.charFrom),h=(a%this.columns+.5)*this.charWidth,c=(Math.floor(a/this.columns)+.5)*this.charHeight;i.fillText(s,h,c)}return e}getCharPosition(e){if(e<this.charFrom||e>this.charTo)return null;let t=e-this.charFrom;return[t%this.columns*this.charWidth,Math.floor(t/this.columns)*this.charHeight]}};var C=class{program;constructor(e,t){let n=this.compileShader(e,g.gl.VERTEX_SHADER),i=this.compileShader(t,g.gl.FRAGMENT_SHADER);if(this.program=g.gl.createProgram(),g.gl.attachShader(this.program,n),g.gl.attachShader(this.program,i),g.gl.linkProgram(this.program),!g.gl.getProgramParameter(this.program,g.gl.LINK_STATUS))throw console.log(g.gl.getProgramInfoLog(this.program)),new Error("program unable to link");this.attribs={positions:g.gl.getAttribLocation(this.program,"position"),normals:g.gl.getAttribLocation(this.program,"normal"),colors:g.gl.getAttribLocation(this.program,"color"),uvs:g.gl.getAttribLocation(this.program,"uv"),sizes:g.gl.getAttribLocation(this.program,"size")},this.uniforms=[{name:"projectionMatrix",type:"mat4",location:g.gl.getUniformLocation(this.program,"projectionMatrix")},{name:"modelViewMatrix",type:"mat4",location:g.gl.getUniformLocation(this.program,"modelViewMatrix")},{name:"modelMatrix",type:"mat4",location:g.gl.getUniformLocation(this.program,"modelMatrix")},{name:"normalMatrix",type:"mat3",location:g.gl.getUniformLocation(this.program,"normalMatrix")},{name:"lightColor",type:"vec3",location:g.gl.getUniformLocation(this.program,"lightColor")},{name:"lightDirection",type:"vec3",location:g.gl.getUniformLocation(this.program,"lightDirection")},{name:"lightPosition",type:"vec3",location:g.gl.getUniformLocation(this.program,"lightPosition")},{name:"cameraPosition",type:"vec3",location:g.gl.getUniformLocation(this.program,"cameraPosition")},{name:"pointMultiplier",type:"float",location:g.gl.getUniformLocation(this.program,"pointMultiplier")},{name:"ambientColor",type:"vec3",location:g.gl.getUniformLocation(this.program,"ambientColor")},{name:"uvOffset",type:"vec2",location:g.gl.getUniformLocation(this.program,"uvOffset")}]}activate(){g.gl.useProgram(this.program)}compileShader(e,t){let n=g.gl.createShader(t);if(g.gl.shaderSource(n,e),g.gl.compileShader(n),!g.gl.getShaderParameter(n,g.gl.COMPILE_STATUS))throw console.log(g.gl.getShaderInfoLog(n)),new Error("shader unable to compile");return n}};X(C,"SIMPLE_VS",`
    uniform mat4 modelViewMatrix;
    uniform mat4 projectionMatrix;

    attribute vec3 position;
    attribute vec4 color;

    varying vec4 vColor;

    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        vColor = color;
    }
    `),X(C,"SIMPLE_FS",`
    precision mediump float;

    varying vec4 vColor;

    uniform vec3 ambientColor;

    void main(void) {
        gl_FragColor = vec4(vColor.rgb * ambientColor, vColor.a);
    }
    `),X(C,"TEXTURE_VS",`
    uniform mat4 modelViewMatrix;
    uniform mat4 projectionMatrix;

    attribute vec3 position;
    attribute vec4 color;
    attribute vec2 uv;

    varying vec4 vColor;
    varying vec2 vUv;

    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        vColor = color;
        vUv = uv;
    }
    `),X(C,"TEXTURE_FS",`
    precision mediump float;

    varying vec4 vColor;
    varying vec2 vUv;

    uniform sampler2D tex;
    uniform vec3 ambientColor;
    uniform vec2 uvOffset;

    void main(void) {
        vec4 texColor = texture2D(tex, vUv + uvOffset);
        gl_FragColor = vec4(vColor.rgb * texColor.rgb * ambientColor, texColor.a);
    }
    `),X(C,"PARTICLE_VS",`
    attribute vec3 position;
    attribute vec4 color;
    attribute float size;
    
    uniform float pointMultiplier;
    uniform mat4 projectionMatrix;
    uniform mat4 modelViewMatrix;
    
    varying vec4 vColor;
    
    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        gl_PointSize = size * pointMultiplier / gl_Position.w;
        vColor = color;
    }
    `),X(C,"PARTICLE_FS",`
    precision mediump float;
    
    varying vec4 vColor;

    uniform sampler2D tex;
    uniform vec3 ambientColor;
    
    void main(void) {
        vec4 texColor = texture2D(tex, gl_PointCoord);
        gl_FragColor = vec4(vColor.rgb * texColor.rgb * ambientColor * texColor.a, texColor.a);
        gl_FragColor *= vColor.a;
        if(gl_FragColor.a == 0.0) {
            discard;
        }
    }
    `);var ir=class{canvas;gl;frameId=null;width;height;delta=0;fps=60;lastFrameTime;frameStart;frames;game;shaders=new Map;fonts=new Map;constructor(e){this.game=e,this.canvas=this.createCanvas(),this.canvas.width=this.width=innerWidth,this.canvas.height=this.height=innerHeight,this.gl=this.canvas.getContext("webgl")}onResume(){this.lastFrameTime=this.frameStart=performance.now(),this.frames=0,this.RAF()}createCanvas(){let e=document.createElement("canvas");return document.body.appendChild(e),e}onResize(){this.canvas.width=this.width=innerWidth,this.canvas.height=this.height=innerHeight,this.game.resize(this.width,this.height)}onDrawFrame(){let e=performance.now();this.delta=(e-this.lastFrameTime)*.001,this.lastFrameTime=e,g.input.update(),this.game.render(this.delta),e-this.frameStart>=1e3&&(this.fps=this.frames,this.frames=0,this.frameStart=e),++this.frames}RAF(){this.frameId=requestAnimationFrame(()=>{this.RAF(),this.onDrawFrame()})}compileShaders(){this.shaders.set("simple",new C(C.SIMPLE_VS,C.SIMPLE_FS)),this.shaders.set("texture",new C(C.TEXTURE_VS,C.TEXTURE_FS)),this.shaders.set("particle",new C(C.PARTICLE_VS,C.PARTICLE_FS))}generateFonts(){this.fonts.set("Consolas",new Z({fontFamily:"Consolas",fontSize:48,charRatio:.6}))}getShader(e){return this.shaders.get(e)}getFont(e){return this.fonts.get(e)}};var Qe={};V(Qe,{Camera:()=>B,Drawable:()=>G,Font:()=>Z,Mesh:()=>F,OrthographicCamera:()=>Er,ParticleSystem:()=>Pr,PerspectiveCamera:()=>gr,Shader:()=>C,ShaderInstance:()=>j,Sprite:()=>Ar,TextDrawable:()=>Rr,Texture:()=>Q,meshes:()=>Jr});var Ge={};V(Ge,{glMatrix:()=>U,mat2:()=>Ir,mat2d:()=>Lr,mat3:()=>H,mat4:()=>N,quat:()=>K,quat2:()=>Kr,vec2:()=>k,vec3:()=>S,vec4:()=>or});var U={};V(U,{ARRAY_TYPE:()=>T,EPSILON:()=>y,RANDOM:()=>q,equals:()=>rt,setMatrixArrayType:()=>Je,toRadian:()=>ue});var y=1e-6,T=typeof Float32Array<"u"?Float32Array:Array,q=Math.random;function Je(r){T=r}var $e=Math.PI/180;function ue(r){return r*$e}function rt(r,e){return Math.abs(r-e)<=y*Math.max(1,Math.abs(r),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Ir={};V(Ir,{LDU:()=>gt,add:()=>dt,adjoint:()=>lt,clone:()=>tt,copy:()=>nt,create:()=>et,determinant:()=>ot,equals:()=>wt,exactEquals:()=>yt,frob:()=>mt,fromRotation:()=>xt,fromScaling:()=>vt,fromValues:()=>at,identity:()=>it,invert:()=>ct,mul:()=>Rt,multiply:()=>te,multiplyScalar:()=>Et,multiplyScalarAndAdd:()=>At,rotate:()=>pt,scale:()=>ft,set:()=>st,str:()=>Mt,sub:()=>Pt,subtract:()=>ne,transpose:()=>ht});function et(){var r=new T(4);return T!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function tt(r){var e=new T(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function nt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function it(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r}function at(r,e,t,n){var i=new T(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function st(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function ht(r,e){if(r===e){var t=e[1];r[1]=e[2],r[2]=t}else r[0]=e[0],r[1]=e[2],r[2]=e[1],r[3]=e[3];return r}function ct(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*a-i*n;return s?(s=1/s,r[0]=a*s,r[1]=-n*s,r[2]=-i*s,r[3]=t*s,r):null}function lt(r,e){var t=e[0];return r[0]=e[3],r[1]=-e[1],r[2]=-e[2],r[3]=t,r}function ot(r){return r[0]*r[3]-r[2]*r[1]}function te(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1],l=t[2],o=t[3];return r[0]=n*h+a*c,r[1]=i*h+s*c,r[2]=n*l+a*o,r[3]=i*l+s*o,r}function pt(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c+a*h,r[1]=i*c+s*h,r[2]=n*-h+a*c,r[3]=i*-h+s*c,r}function ft(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1];return r[0]=n*h,r[1]=i*h,r[2]=a*c,r[3]=s*c,r}function xt(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=-t,r[3]=n,r}function vt(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r}function Mt(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function mt(r){return Math.hypot(r[0],r[1],r[2],r[3])}function gt(r,e,t,n){return r[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-r[2]*t[1],[r,e,t]}function dt(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function ne(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function yt(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function wt(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=e[0],h=e[1],c=e[2],l=e[3];return Math.abs(t-s)<=y*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-h)<=y*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-c)<=y*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=y*Math.max(1,Math.abs(a),Math.abs(l))}function Et(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function At(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r}var Rt=te,Pt=ne;var Lr={};V(Lr,{add:()=>Xt,clone:()=>zt,copy:()=>St,create:()=>Tt,determinant:()=>Dt,equals:()=>kt,exactEquals:()=>Ht,frob:()=>Vt,fromRotation:()=>Ct,fromScaling:()=>Ft,fromTranslation:()=>qt,fromValues:()=>Lt,identity:()=>It,invert:()=>Yt,mul:()=>Bt,multiply:()=>ie,multiplyScalar:()=>Wt,multiplyScalarAndAdd:()=>jt,rotate:()=>Ot,scale:()=>_t,set:()=>bt,str:()=>Ut,sub:()=>Gt,subtract:()=>ae,translate:()=>Nt});function Tt(){var r=new T(6);return T!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function zt(r){var e=new T(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function St(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function It(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function Lt(r,e,t,n,i,a){var s=new T(6);return s[0]=r,s[1]=e,s[2]=t,s[3]=n,s[4]=i,s[5]=a,s}function bt(r,e,t,n,i,a,s){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r}function Yt(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=t*a-n*i;return c?(c=1/c,r[0]=a*c,r[1]=-n*c,r[2]=-i*c,r[3]=t*c,r[4]=(i*h-a*s)*c,r[5]=(n*s-t*h)*c,r):null}function Dt(r){return r[0]*r[3]-r[1]*r[2]}function ie(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=t[0],o=t[1],p=t[2],f=t[3],x=t[4],M=t[5];return r[0]=n*l+a*o,r[1]=i*l+s*o,r[2]=n*p+a*f,r[3]=i*p+s*f,r[4]=n*x+a*M+h,r[5]=i*x+s*M+c,r}function Ot(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=Math.sin(t),o=Math.cos(t);return r[0]=n*o+a*l,r[1]=i*o+s*l,r[2]=n*-l+a*o,r[3]=i*-l+s*o,r[4]=h,r[5]=c,r}function _t(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=t[0],o=t[1];return r[0]=n*l,r[1]=i*l,r[2]=a*o,r[3]=s*o,r[4]=h,r[5]=c,r}function Nt(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=t[0],o=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=n*l+a*o+h,r[5]=i*l+s*o+c,r}function Ct(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=-t,r[3]=n,r[4]=0,r[5]=0,r}function Ft(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r[4]=0,r[5]=0,r}function qt(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r}function Ut(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"}function Vt(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)}function Xt(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r}function ae(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r}function Wt(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r}function jt(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r}function Ht(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]}function kt(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=e[0],l=e[1],o=e[2],p=e[3],f=e[4],x=e[5];return Math.abs(t-c)<=y*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-l)<=y*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-o)<=y*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(a-p)<=y*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-f)<=y*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(h-x)<=y*Math.max(1,Math.abs(h),Math.abs(x))}var Bt=ie,Gt=ae;var H={};V(H,{add:()=>gn,adjoint:()=>tn,clone:()=>Zt,copy:()=>Kt,create:()=>br,determinant:()=>nn,equals:()=>En,exactEquals:()=>wn,frob:()=>mn,fromMat2d:()=>pn,fromMat4:()=>Qt,fromQuat:()=>fn,fromRotation:()=>ln,fromScaling:()=>on,fromTranslation:()=>cn,fromValues:()=>Jt,identity:()=>ut,invert:()=>en,mul:()=>An,multiply:()=>se,multiplyScalar:()=>dn,multiplyScalarAndAdd:()=>yn,normalFromMat4:()=>xn,projection:()=>vn,rotate:()=>sn,scale:()=>hn,set:()=>$t,str:()=>Mn,sub:()=>Rn,subtract:()=>he,translate:()=>an,transpose:()=>rn});function br(){var r=new T(9);return T!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Qt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function Zt(r){var e=new T(9);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function Kt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function Jt(r,e,t,n,i,a,s,h,c){var l=new T(9);return l[0]=r,l[1]=e,l[2]=t,l[3]=n,l[4]=i,l[5]=a,l[6]=s,l[7]=h,l[8]=c,l}function $t(r,e,t,n,i,a,s,h,c,l){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=h,r[7]=c,r[8]=l,r}function ut(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function rn(r,e){if(r===e){var t=e[1],n=e[2],i=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=n,r[7]=i}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function en(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],o=e[8],p=o*s-h*l,f=-o*a+h*c,x=l*a-s*c,M=t*p+n*f+i*x;return M?(M=1/M,r[0]=p*M,r[1]=(-o*n+i*l)*M,r[2]=(h*n-i*s)*M,r[3]=f*M,r[4]=(o*t-i*c)*M,r[5]=(-h*t+i*a)*M,r[6]=x*M,r[7]=(-l*t+n*c)*M,r[8]=(s*t-n*a)*M,r):null}function tn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],o=e[8];return r[0]=s*o-h*l,r[1]=i*l-n*o,r[2]=n*h-i*s,r[3]=h*c-a*o,r[4]=t*o-i*c,r[5]=i*a-t*h,r[6]=a*l-s*c,r[7]=n*c-t*l,r[8]=t*s-n*a,r}function nn(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],s=r[5],h=r[6],c=r[7],l=r[8];return e*(l*a-s*c)+t*(-l*i+s*h)+n*(c*i-a*h)}function se(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=e[8],f=t[0],x=t[1],M=t[2],m=t[3],v=t[4],d=t[5],E=t[6],w=t[7],A=t[8];return r[0]=f*n+x*s+M*l,r[1]=f*i+x*h+M*o,r[2]=f*a+x*c+M*p,r[3]=m*n+v*s+d*l,r[4]=m*i+v*h+d*o,r[5]=m*a+v*c+d*p,r[6]=E*n+w*s+A*l,r[7]=E*i+w*h+A*o,r[8]=E*a+w*c+A*p,r}function an(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=e[8],f=t[0],x=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=h,r[5]=c,r[6]=f*n+x*s+l,r[7]=f*i+x*h+o,r[8]=f*a+x*c+p,r}function sn(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=e[8],f=Math.sin(t),x=Math.cos(t);return r[0]=x*n+f*s,r[1]=x*i+f*h,r[2]=x*a+f*c,r[3]=x*s-f*n,r[4]=x*h-f*i,r[5]=x*c-f*a,r[6]=l,r[7]=o,r[8]=p,r}function hn(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function cn(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=e[0],r[7]=e[1],r[8]=1,r}function ln(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=-t,r[4]=n,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function on(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=e[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function pn(r,e){return r[0]=e[0],r[1]=e[1],r[2]=0,r[3]=e[2],r[4]=e[3],r[5]=0,r[6]=e[4],r[7]=e[5],r[8]=1,r}function fn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t+t,h=n+n,c=i+i,l=t*s,o=n*s,p=n*h,f=i*s,x=i*h,M=i*c,m=a*s,v=a*h,d=a*c;return r[0]=1-p-M,r[3]=o-d,r[6]=f+v,r[1]=o+d,r[4]=1-l-M,r[7]=x-m,r[2]=f-v,r[5]=x+m,r[8]=1-l-p,r}function xn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],o=e[8],p=e[9],f=e[10],x=e[11],M=e[12],m=e[13],v=e[14],d=e[15],E=t*h-n*s,w=t*c-i*s,A=t*l-a*s,P=n*c-i*h,R=n*l-a*h,D=i*l-a*c,L=o*m-p*M,b=o*v-f*M,I=o*d-x*M,O=p*v-f*m,Y=p*d-x*m,_=f*d-x*v,z=E*_-w*Y+A*O+P*I-R*b+D*L;return z?(z=1/z,r[0]=(h*_-c*Y+l*O)*z,r[1]=(c*I-s*_-l*b)*z,r[2]=(s*Y-h*I+l*L)*z,r[3]=(i*Y-n*_-a*O)*z,r[4]=(t*_-i*I+a*b)*z,r[5]=(n*I-t*Y-a*L)*z,r[6]=(m*D-v*R+d*P)*z,r[7]=(v*A-M*D-d*w)*z,r[8]=(M*R-m*A+d*E)*z,r):null}function vn(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}function Mn(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"}function mn(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])}function gn(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r}function he(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r}function dn(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r}function yn(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r}function wn(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]}function En(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=r[6],l=r[7],o=r[8],p=e[0],f=e[1],x=e[2],M=e[3],m=e[4],v=e[5],d=e[6],E=e[7],w=e[8];return Math.abs(t-p)<=y*Math.max(1,Math.abs(t),Math.abs(p))&&Math.abs(n-f)<=y*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-x)<=y*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-M)<=y*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-m)<=y*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(h-v)<=y*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-d)<=y*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(l-E)<=y*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(o-w)<=y*Math.max(1,Math.abs(o),Math.abs(w))}var An=se,Rn=he;var N={};V(N,{add:()=>ai,adjoint:()=>Yn,clone:()=>Tn,copy:()=>zn,create:()=>Pn,determinant:()=>Dn,equals:()=>li,exactEquals:()=>ci,frob:()=>ii,fromQuat:()=>Qn,fromQuat2:()=>kn,fromRotation:()=>Xn,fromRotationTranslation:()=>oe,fromRotationTranslationScale:()=>Bn,fromRotationTranslationScaleOrigin:()=>Gn,fromScaling:()=>Vn,fromTranslation:()=>Un,fromValues:()=>Sn,fromXRotation:()=>Wn,fromYRotation:()=>jn,fromZRotation:()=>Hn,frustum:()=>Zn,getRotation:()=>Dr,getScaling:()=>pe,getTranslation:()=>Yr,identity:()=>ce,invert:()=>bn,lookAt:()=>ei,mul:()=>oi,multiply:()=>le,multiplyScalar:()=>si,multiplyScalarAndAdd:()=>hi,ortho:()=>un,orthoNO:()=>xe,orthoZO:()=>ri,perspective:()=>Kn,perspectiveFromFieldOfView:()=>$n,perspectiveNO:()=>fe,perspectiveZO:()=>Jn,rotate:()=>Nn,rotateX:()=>Cn,rotateY:()=>Fn,rotateZ:()=>qn,scale:()=>_n,set:()=>In,str:()=>ni,sub:()=>pi,subtract:()=>ve,targetTo:()=>ti,translate:()=>On,transpose:()=>Ln});function Pn(){var r=new T(16);return T!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Tn(r){var e=new T(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function zn(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Sn(r,e,t,n,i,a,s,h,c,l,o,p,f,x,M,m){var v=new T(16);return v[0]=r,v[1]=e,v[2]=t,v[3]=n,v[4]=i,v[5]=a,v[6]=s,v[7]=h,v[8]=c,v[9]=l,v[10]=o,v[11]=p,v[12]=f,v[13]=x,v[14]=M,v[15]=m,v}function In(r,e,t,n,i,a,s,h,c,l,o,p,f,x,M,m,v){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=h,r[7]=c,r[8]=l,r[9]=o,r[10]=p,r[11]=f,r[12]=x,r[13]=M,r[14]=m,r[15]=v,r}function ce(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ln(r,e){if(r===e){var t=e[1],n=e[2],i=e[3],a=e[6],s=e[7],h=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=a,r[11]=e[14],r[12]=i,r[13]=s,r[14]=h}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function bn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],o=e[8],p=e[9],f=e[10],x=e[11],M=e[12],m=e[13],v=e[14],d=e[15],E=t*h-n*s,w=t*c-i*s,A=t*l-a*s,P=n*c-i*h,R=n*l-a*h,D=i*l-a*c,L=o*m-p*M,b=o*v-f*M,I=o*d-x*M,O=p*v-f*m,Y=p*d-x*m,_=f*d-x*v,z=E*_-w*Y+A*O+P*I-R*b+D*L;return z?(z=1/z,r[0]=(h*_-c*Y+l*O)*z,r[1]=(i*Y-n*_-a*O)*z,r[2]=(m*D-v*R+d*P)*z,r[3]=(f*R-p*D-x*P)*z,r[4]=(c*I-s*_-l*b)*z,r[5]=(t*_-i*I+a*b)*z,r[6]=(v*A-M*D-d*w)*z,r[7]=(o*D-f*A+x*w)*z,r[8]=(s*Y-h*I+l*L)*z,r[9]=(n*I-t*Y-a*L)*z,r[10]=(M*R-m*A+d*E)*z,r[11]=(p*A-o*R-x*E)*z,r[12]=(h*b-s*O-c*L)*z,r[13]=(t*O-n*b+i*L)*z,r[14]=(m*w-M*P-v*E)*z,r[15]=(o*P-p*w+f*E)*z,r):null}function Yn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],o=e[8],p=e[9],f=e[10],x=e[11],M=e[12],m=e[13],v=e[14],d=e[15];return r[0]=h*(f*d-x*v)-p*(c*d-l*v)+m*(c*x-l*f),r[1]=-(n*(f*d-x*v)-p*(i*d-a*v)+m*(i*x-a*f)),r[2]=n*(c*d-l*v)-h*(i*d-a*v)+m*(i*l-a*c),r[3]=-(n*(c*x-l*f)-h*(i*x-a*f)+p*(i*l-a*c)),r[4]=-(s*(f*d-x*v)-o*(c*d-l*v)+M*(c*x-l*f)),r[5]=t*(f*d-x*v)-o*(i*d-a*v)+M*(i*x-a*f),r[6]=-(t*(c*d-l*v)-s*(i*d-a*v)+M*(i*l-a*c)),r[7]=t*(c*x-l*f)-s*(i*x-a*f)+o*(i*l-a*c),r[8]=s*(p*d-x*m)-o*(h*d-l*m)+M*(h*x-l*p),r[9]=-(t*(p*d-x*m)-o*(n*d-a*m)+M*(n*x-a*p)),r[10]=t*(h*d-l*m)-s*(n*d-a*m)+M*(n*l-a*h),r[11]=-(t*(h*x-l*p)-s*(n*x-a*p)+o*(n*l-a*h)),r[12]=-(s*(p*v-f*m)-o*(h*v-c*m)+M*(h*f-c*p)),r[13]=t*(p*v-f*m)-o*(n*v-i*m)+M*(n*f-i*p),r[14]=-(t*(h*v-c*m)-s*(n*v-i*m)+M*(n*c-i*h)),r[15]=t*(h*f-c*p)-s*(n*f-i*p)+o*(n*c-i*h),r}function Dn(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],s=r[5],h=r[6],c=r[7],l=r[8],o=r[9],p=r[10],f=r[11],x=r[12],M=r[13],m=r[14],v=r[15],d=e*s-t*a,E=e*h-n*a,w=e*c-i*a,A=t*h-n*s,P=t*c-i*s,R=n*c-i*h,D=l*M-o*x,L=l*m-p*x,b=l*v-f*x,I=o*m-p*M,O=o*v-f*M,Y=p*v-f*m;return d*Y-E*O+w*I+A*b-P*L+R*D}function le(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=e[8],f=e[9],x=e[10],M=e[11],m=e[12],v=e[13],d=e[14],E=e[15],w=t[0],A=t[1],P=t[2],R=t[3];return r[0]=w*n+A*h+P*p+R*m,r[1]=w*i+A*c+P*f+R*v,r[2]=w*a+A*l+P*x+R*d,r[3]=w*s+A*o+P*M+R*E,w=t[4],A=t[5],P=t[6],R=t[7],r[4]=w*n+A*h+P*p+R*m,r[5]=w*i+A*c+P*f+R*v,r[6]=w*a+A*l+P*x+R*d,r[7]=w*s+A*o+P*M+R*E,w=t[8],A=t[9],P=t[10],R=t[11],r[8]=w*n+A*h+P*p+R*m,r[9]=w*i+A*c+P*f+R*v,r[10]=w*a+A*l+P*x+R*d,r[11]=w*s+A*o+P*M+R*E,w=t[12],A=t[13],P=t[14],R=t[15],r[12]=w*n+A*h+P*p+R*m,r[13]=w*i+A*c+P*f+R*v,r[14]=w*a+A*l+P*x+R*d,r[15]=w*s+A*o+P*M+R*E,r}function On(r,e,t){var n=t[0],i=t[1],a=t[2],s,h,c,l,o,p,f,x,M,m,v,d;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*a+e[12],r[13]=e[1]*n+e[5]*i+e[9]*a+e[13],r[14]=e[2]*n+e[6]*i+e[10]*a+e[14],r[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],h=e[1],c=e[2],l=e[3],o=e[4],p=e[5],f=e[6],x=e[7],M=e[8],m=e[9],v=e[10],d=e[11],r[0]=s,r[1]=h,r[2]=c,r[3]=l,r[4]=o,r[5]=p,r[6]=f,r[7]=x,r[8]=M,r[9]=m,r[10]=v,r[11]=d,r[12]=s*n+o*i+M*a+e[12],r[13]=h*n+p*i+m*a+e[13],r[14]=c*n+f*i+v*a+e[14],r[15]=l*n+x*i+d*a+e[15]),r}function _n(r,e,t){var n=t[0],i=t[1],a=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*a,r[9]=e[9]*a,r[10]=e[10]*a,r[11]=e[11]*a,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Nn(r,e,t,n){var i=n[0],a=n[1],s=n[2],h=Math.hypot(i,a,s),c,l,o,p,f,x,M,m,v,d,E,w,A,P,R,D,L,b,I,O,Y,_,z,W;return h<y?null:(h=1/h,i*=h,a*=h,s*=h,c=Math.sin(t),l=Math.cos(t),o=1-l,p=e[0],f=e[1],x=e[2],M=e[3],m=e[4],v=e[5],d=e[6],E=e[7],w=e[8],A=e[9],P=e[10],R=e[11],D=i*i*o+l,L=a*i*o+s*c,b=s*i*o-a*c,I=i*a*o-s*c,O=a*a*o+l,Y=s*a*o+i*c,_=i*s*o+a*c,z=a*s*o-i*c,W=s*s*o+l,r[0]=p*D+m*L+w*b,r[1]=f*D+v*L+A*b,r[2]=x*D+d*L+P*b,r[3]=M*D+E*L+R*b,r[4]=p*I+m*O+w*Y,r[5]=f*I+v*O+A*Y,r[6]=x*I+d*O+P*Y,r[7]=M*I+E*O+R*Y,r[8]=p*_+m*z+w*W,r[9]=f*_+v*z+A*W,r[10]=x*_+d*z+P*W,r[11]=M*_+E*z+R*W,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function Cn(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],h=e[6],c=e[7],l=e[8],o=e[9],p=e[10],f=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=a*i+l*n,r[5]=s*i+o*n,r[6]=h*i+p*n,r[7]=c*i+f*n,r[8]=l*i-a*n,r[9]=o*i-s*n,r[10]=p*i-h*n,r[11]=f*i-c*n,r}function Fn(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],h=e[2],c=e[3],l=e[8],o=e[9],p=e[10],f=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i-l*n,r[1]=s*i-o*n,r[2]=h*i-p*n,r[3]=c*i-f*n,r[8]=a*n+l*i,r[9]=s*n+o*i,r[10]=h*n+p*i,r[11]=c*n+f*i,r}function qn(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],h=e[2],c=e[3],l=e[4],o=e[5],p=e[6],f=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i+l*n,r[1]=s*i+o*n,r[2]=h*i+p*n,r[3]=c*i+f*n,r[4]=l*i-a*n,r[5]=o*i-s*n,r[6]=p*i-h*n,r[7]=f*i-c*n,r}function Un(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Vn(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Xn(r,e,t){var n=t[0],i=t[1],a=t[2],s=Math.hypot(n,i,a),h,c,l;return s<y?null:(s=1/s,n*=s,i*=s,a*=s,h=Math.sin(e),c=Math.cos(e),l=1-c,r[0]=n*n*l+c,r[1]=i*n*l+a*h,r[2]=a*n*l-i*h,r[3]=0,r[4]=n*i*l-a*h,r[5]=i*i*l+c,r[6]=a*i*l+n*h,r[7]=0,r[8]=n*a*l+i*h,r[9]=i*a*l-n*h,r[10]=a*a*l+c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function Wn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function jn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Hn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function oe(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=n+n,c=i+i,l=a+a,o=n*h,p=n*c,f=n*l,x=i*c,M=i*l,m=a*l,v=s*h,d=s*c,E=s*l;return r[0]=1-(x+m),r[1]=p+E,r[2]=f-d,r[3]=0,r[4]=p-E,r[5]=1-(o+m),r[6]=M+v,r[7]=0,r[8]=f+d,r[9]=M-v,r[10]=1-(o+x),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function kn(r,e){var t=new T(3),n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=n*n+i*i+a*a+s*s;return p>0?(t[0]=(h*s+o*n+c*a-l*i)*2/p,t[1]=(c*s+o*i+l*n-h*a)*2/p,t[2]=(l*s+o*a+h*i-c*n)*2/p):(t[0]=(h*s+o*n+c*a-l*i)*2,t[1]=(c*s+o*i+l*n-h*a)*2,t[2]=(l*s+o*a+h*i-c*n)*2),oe(r,e,t),r}function Yr(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function pe(r,e){var t=e[0],n=e[1],i=e[2],a=e[4],s=e[5],h=e[6],c=e[8],l=e[9],o=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(a,s,h),r[2]=Math.hypot(c,l,o),r}function Dr(r,e){var t=new T(3);pe(t,e);var n=1/t[0],i=1/t[1],a=1/t[2],s=e[0]*n,h=e[1]*i,c=e[2]*a,l=e[4]*n,o=e[5]*i,p=e[6]*a,f=e[8]*n,x=e[9]*i,M=e[10]*a,m=s+o+M,v=0;return m>0?(v=Math.sqrt(m+1)*2,r[3]=.25*v,r[0]=(p-x)/v,r[1]=(f-c)/v,r[2]=(h-l)/v):s>o&&s>M?(v=Math.sqrt(1+s-o-M)*2,r[3]=(p-x)/v,r[0]=.25*v,r[1]=(h+l)/v,r[2]=(f+c)/v):o>M?(v=Math.sqrt(1+o-s-M)*2,r[3]=(f-c)/v,r[0]=(h+l)/v,r[1]=.25*v,r[2]=(p+x)/v):(v=Math.sqrt(1+M-s-o)*2,r[3]=(h-l)/v,r[0]=(f+c)/v,r[1]=(p+x)/v,r[2]=.25*v),r}function Bn(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=e[3],c=i+i,l=a+a,o=s+s,p=i*c,f=i*l,x=i*o,M=a*l,m=a*o,v=s*o,d=h*c,E=h*l,w=h*o,A=n[0],P=n[1],R=n[2];return r[0]=(1-(M+v))*A,r[1]=(f+w)*A,r[2]=(x-E)*A,r[3]=0,r[4]=(f-w)*P,r[5]=(1-(p+v))*P,r[6]=(m+d)*P,r[7]=0,r[8]=(x+E)*R,r[9]=(m-d)*R,r[10]=(1-(p+M))*R,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Gn(r,e,t,n,i){var a=e[0],s=e[1],h=e[2],c=e[3],l=a+a,o=s+s,p=h+h,f=a*l,x=a*o,M=a*p,m=s*o,v=s*p,d=h*p,E=c*l,w=c*o,A=c*p,P=n[0],R=n[1],D=n[2],L=i[0],b=i[1],I=i[2],O=(1-(m+d))*P,Y=(x+A)*P,_=(M-w)*P,z=(x-A)*R,W=(1-(f+d))*R,$=(v+E)*R,u=(M+w)*D,ur=(v-E)*D,re=(1-(f+m))*D;return r[0]=O,r[1]=Y,r[2]=_,r[3]=0,r[4]=z,r[5]=W,r[6]=$,r[7]=0,r[8]=u,r[9]=ur,r[10]=re,r[11]=0,r[12]=t[0]+L-(O*L+z*b+u*I),r[13]=t[1]+b-(Y*L+W*b+ur*I),r[14]=t[2]+I-(_*L+$*b+re*I),r[15]=1,r}function Qn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t+t,h=n+n,c=i+i,l=t*s,o=n*s,p=n*h,f=i*s,x=i*h,M=i*c,m=a*s,v=a*h,d=a*c;return r[0]=1-p-M,r[1]=o+d,r[2]=f-v,r[3]=0,r[4]=o-d,r[5]=1-l-M,r[6]=x+m,r[7]=0,r[8]=f+v,r[9]=x-m,r[10]=1-l-p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Zn(r,e,t,n,i,a,s){var h=1/(t-e),c=1/(i-n),l=1/(a-s);return r[0]=a*2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a*2*c,r[6]=0,r[7]=0,r[8]=(t+e)*h,r[9]=(i+n)*c,r[10]=(s+a)*l,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*a*2*l,r[15]=0,r}function fe(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=(i+n)*s,r[14]=2*i*n*s):(r[10]=-1,r[14]=-2*n),r}var Kn=fe;function Jn(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=i*s,r[14]=i*n*s):(r[10]=-1,r[14]=-n),r}function $n(r,e,t,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),h=Math.tan(e.rightDegrees*Math.PI/180),c=2/(s+h),l=2/(i+a);return r[0]=c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=l,r[6]=0,r[7]=0,r[8]=-((s-h)*c*.5),r[9]=(i-a)*l*.5,r[10]=n/(t-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*t/(t-n),r[15]=0,r}function xe(r,e,t,n,i,a,s){var h=1/(e-t),c=1/(n-i),l=1/(a-s);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*l,r[11]=0,r[12]=(e+t)*h,r[13]=(i+n)*c,r[14]=(s+a)*l,r[15]=1,r}var un=xe;function ri(r,e,t,n,i,a,s){var h=1/(e-t),c=1/(n-i),l=1/(a-s);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=l,r[11]=0,r[12]=(e+t)*h,r[13]=(i+n)*c,r[14]=a*l,r[15]=1,r}function ei(r,e,t,n){var i,a,s,h,c,l,o,p,f,x,M=e[0],m=e[1],v=e[2],d=n[0],E=n[1],w=n[2],A=t[0],P=t[1],R=t[2];return Math.abs(M-A)<y&&Math.abs(m-P)<y&&Math.abs(v-R)<y?ce(r):(o=M-A,p=m-P,f=v-R,x=1/Math.hypot(o,p,f),o*=x,p*=x,f*=x,i=E*f-w*p,a=w*o-d*f,s=d*p-E*o,x=Math.hypot(i,a,s),x?(x=1/x,i*=x,a*=x,s*=x):(i=0,a=0,s=0),h=p*s-f*a,c=f*i-o*s,l=o*a-p*i,x=Math.hypot(h,c,l),x?(x=1/x,h*=x,c*=x,l*=x):(h=0,c=0,l=0),r[0]=i,r[1]=h,r[2]=o,r[3]=0,r[4]=a,r[5]=c,r[6]=p,r[7]=0,r[8]=s,r[9]=l,r[10]=f,r[11]=0,r[12]=-(i*M+a*m+s*v),r[13]=-(h*M+c*m+l*v),r[14]=-(o*M+p*m+f*v),r[15]=1,r)}function ti(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=n[0],c=n[1],l=n[2],o=i-t[0],p=a-t[1],f=s-t[2],x=o*o+p*p+f*f;x>0&&(x=1/Math.sqrt(x),o*=x,p*=x,f*=x);var M=c*f-l*p,m=l*o-h*f,v=h*p-c*o;return x=M*M+m*m+v*v,x>0&&(x=1/Math.sqrt(x),M*=x,m*=x,v*=x),r[0]=M,r[1]=m,r[2]=v,r[3]=0,r[4]=p*v-f*m,r[5]=f*M-o*v,r[6]=o*m-p*M,r[7]=0,r[8]=o,r[9]=p,r[10]=f,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,r}function ni(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function ii(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function ai(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r}function ve(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r}function si(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r}function hi(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r[9]=e[9]+t[9]*n,r[10]=e[10]+t[10]*n,r[11]=e[11]+t[11]*n,r[12]=e[12]+t[12]*n,r[13]=e[13]+t[13]*n,r[14]=e[14]+t[14]*n,r[15]=e[15]+t[15]*n,r}function ci(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function li(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=r[6],l=r[7],o=r[8],p=r[9],f=r[10],x=r[11],M=r[12],m=r[13],v=r[14],d=r[15],E=e[0],w=e[1],A=e[2],P=e[3],R=e[4],D=e[5],L=e[6],b=e[7],I=e[8],O=e[9],Y=e[10],_=e[11],z=e[12],W=e[13],$=e[14],u=e[15];return Math.abs(t-E)<=y*Math.max(1,Math.abs(t),Math.abs(E))&&Math.abs(n-w)<=y*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-A)<=y*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(a-P)<=y*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(s-R)<=y*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(h-D)<=y*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(c-L)<=y*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(l-b)<=y*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(o-I)<=y*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(p-O)<=y*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(f-Y)<=y*Math.max(1,Math.abs(f),Math.abs(Y))&&Math.abs(x-_)<=y*Math.max(1,Math.abs(x),Math.abs(_))&&Math.abs(M-z)<=y*Math.max(1,Math.abs(M),Math.abs(z))&&Math.abs(m-W)<=y*Math.max(1,Math.abs(m),Math.abs(W))&&Math.abs(v-$)<=y*Math.max(1,Math.abs(v),Math.abs($))&&Math.abs(d-u)<=y*Math.max(1,Math.abs(d),Math.abs(u))}var oi=le,pi=ve;var K={};V(K,{add:()=>I1,calculateW:()=>d1,clone:()=>T1,conjugate:()=>A1,copy:()=>fr,create:()=>er,dot:()=>xr,equals:()=>_1,exactEquals:()=>O1,exp:()=>be,fromEuler:()=>R1,fromMat3:()=>De,fromValues:()=>z1,getAngle:()=>g1,getAxisAngle:()=>m1,identity:()=>M1,invert:()=>E1,len:()=>Y1,length:()=>vr,lerp:()=>b1,ln:()=>Ye,mul:()=>L1,multiply:()=>Le,normalize:()=>Zr,pow:()=>y1,random:()=>w1,rotateX:()=>Br,rotateY:()=>Gr,rotateZ:()=>Qr,rotationTo:()=>N1,scale:()=>Oe,set:()=>S1,setAxes:()=>F1,setAxisAngle:()=>Ie,slerp:()=>pr,sqlerp:()=>C1,sqrLen:()=>D1,squaredLength:()=>Mr,str:()=>P1});var S={};V(S,{add:()=>Mi,angle:()=>Ni,bezier:()=>Si,ceil:()=>mi,clone:()=>fi,copy:()=>xi,create:()=>ar,cross:()=>rr,dist:()=>ji,distance:()=>ye,div:()=>Wi,divide:()=>de,dot:()=>hr,equals:()=>Ui,exactEquals:()=>qi,floor:()=>gi,forEach:()=>Bi,fromValues:()=>sr,hermite:()=>zi,inverse:()=>Pi,len:()=>_r,length:()=>Me,lerp:()=>Ti,max:()=>yi,min:()=>di,mul:()=>Xi,multiply:()=>ge,negate:()=>Ri,normalize:()=>Or,random:()=>Ii,rotateX:()=>Di,rotateY:()=>Oi,rotateZ:()=>_i,round:()=>wi,scale:()=>Ei,scaleAndAdd:()=>Ai,set:()=>vi,sqrDist:()=>Hi,sqrLen:()=>ki,squaredDistance:()=>we,squaredLength:()=>Ee,str:()=>Fi,sub:()=>Vi,subtract:()=>me,transformMat3:()=>bi,transformMat4:()=>Li,transformQuat:()=>Yi,zero:()=>Ci});function ar(){var r=new T(3);return T!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function fi(r){var e=new T(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Me(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function sr(r,e,t){var n=new T(3);return n[0]=r,n[1]=e,n[2]=t,n}function xi(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function vi(r,e,t,n){return r[0]=e,r[1]=t,r[2]=n,r}function Mi(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function me(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function ge(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function de(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r}function mi(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r}function gi(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r}function di(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function yi(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function wi(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r}function Ei(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function Ai(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r}function ye(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return Math.hypot(t,n,i)}function we(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return t*t+n*n+i*i}function Ee(r){var e=r[0],t=r[1],n=r[2];return e*e+t*t+n*n}function Ri(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function Pi(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r}function Or(r,e){var t=e[0],n=e[1],i=e[2],a=t*t+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r}function hr(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function rr(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[0],h=t[1],c=t[2];return r[0]=i*c-a*h,r[1]=a*s-n*c,r[2]=n*h-i*s,r}function Ti(r,e,t,n){var i=e[0],a=e[1],s=e[2];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=s+n*(t[2]-s),r}function zi(r,e,t,n,i,a){var s=a*a,h=s*(2*a-3)+1,c=s*(a-2)+a,l=s*(a-1),o=s*(3-2*a);return r[0]=e[0]*h+t[0]*c+n[0]*l+i[0]*o,r[1]=e[1]*h+t[1]*c+n[1]*l+i[1]*o,r[2]=e[2]*h+t[2]*c+n[2]*l+i[2]*o,r}function Si(r,e,t,n,i,a){var s=1-a,h=s*s,c=a*a,l=h*s,o=3*a*h,p=3*c*s,f=c*a;return r[0]=e[0]*l+t[0]*o+n[0]*p+i[0]*f,r[1]=e[1]*l+t[1]*o+n[1]*p+i[1]*f,r[2]=e[2]*l+t[2]*o+n[2]*p+i[2]*f,r}function Ii(r,e){e=e||1;var t=q()*2*Math.PI,n=q()*2-1,i=Math.sqrt(1-n*n)*e;return r[0]=Math.cos(t)*i,r[1]=Math.sin(t)*i,r[2]=n*e,r}function Li(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[3]*n+t[7]*i+t[11]*a+t[15];return s=s||1,r[0]=(t[0]*n+t[4]*i+t[8]*a+t[12])/s,r[1]=(t[1]*n+t[5]*i+t[9]*a+t[13])/s,r[2]=(t[2]*n+t[6]*i+t[10]*a+t[14])/s,r}function bi(r,e,t){var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0]+i*t[3]+a*t[6],r[1]=n*t[1]+i*t[4]+a*t[7],r[2]=n*t[2]+i*t[5]+a*t[8],r}function Yi(r,e,t){var n=t[0],i=t[1],a=t[2],s=t[3],h=e[0],c=e[1],l=e[2],o=i*l-a*c,p=a*h-n*l,f=n*c-i*h,x=i*f-a*p,M=a*o-n*f,m=n*p-i*o,v=s*2;return o*=v,p*=v,f*=v,x*=2,M*=2,m*=2,r[0]=h+o+x,r[1]=c+p+M,r[2]=l+f+m,r}function Di(r,e,t,n){var i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r}function Oi(r,e,t,n){var i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r}function _i(r,e,t,n){var i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r}function Ni(r,e){var t=r[0],n=r[1],i=r[2],a=e[0],s=e[1],h=e[2],c=Math.sqrt(t*t+n*n+i*i),l=Math.sqrt(a*a+s*s+h*h),o=c*l,p=o&&hr(r,e)/o;return Math.acos(Math.min(Math.max(p,-1),1))}function Ci(r){return r[0]=0,r[1]=0,r[2]=0,r}function Fi(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function qi(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]}function Ui(r,e){var t=r[0],n=r[1],i=r[2],a=e[0],s=e[1],h=e[2];return Math.abs(t-a)<=y*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-s)<=y*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-h)<=y*Math.max(1,Math.abs(i),Math.abs(h))}var Vi=me,Xi=ge,Wi=de,ji=ye,Hi=we,_r=Me,ki=Ee,Bi=function(){var r=ar();return function(e,t,n,i,a,s){var h,c;for(t||(t=3),n||(n=0),i?c=Math.min(i*t+n,e.length):c=e.length,h=n;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],a(r,r,s),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2];return e}}();var or={};V(or,{add:()=>Ur,ceil:()=>Gi,clone:()=>Nr,copy:()=>Fr,create:()=>Ae,cross:()=>e1,dist:()=>o1,distance:()=>ze,div:()=>l1,divide:()=>Te,dot:()=>Wr,equals:()=>kr,exactEquals:()=>Hr,floor:()=>Qi,forEach:()=>v1,fromValues:()=>Cr,inverse:()=>r1,len:()=>f1,length:()=>cr,lerp:()=>jr,max:()=>Ki,min:()=>Zi,mul:()=>c1,multiply:()=>Pe,negate:()=>ui,normalize:()=>Xr,random:()=>t1,round:()=>Ji,scale:()=>Vr,scaleAndAdd:()=>$i,set:()=>qr,sqrDist:()=>p1,sqrLen:()=>x1,squaredDistance:()=>Se,squaredLength:()=>lr,str:()=>s1,sub:()=>h1,subtract:()=>Re,transformMat4:()=>n1,transformQuat:()=>i1,zero:()=>a1});function Ae(){var r=new T(4);return T!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function Nr(r){var e=new T(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function Cr(r,e,t,n){var i=new T(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function Fr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function qr(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function Ur(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function Re(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function Pe(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r[3]=e[3]*t[3],r}function Te(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r[3]=e[3]/t[3],r}function Gi(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r[3]=Math.ceil(e[3]),r}function Qi(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r[3]=Math.floor(e[3]),r}function Zi(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.min(e[3],t[3]),r}function Ki(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r}function Ji(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r[3]=Math.round(e[3]),r}function Vr(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function $i(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r}function ze(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2],a=e[3]-r[3];return Math.hypot(t,n,i,a)}function Se(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2],a=e[3]-r[3];return t*t+n*n+i*i+a*a}function cr(r){var e=r[0],t=r[1],n=r[2],i=r[3];return Math.hypot(e,t,n,i)}function lr(r){var e=r[0],t=r[1],n=r[2],i=r[3];return e*e+t*t+n*n+i*i}function ui(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r}function r1(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r[3]=1/e[3],r}function Xr(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=t*s,r[1]=n*s,r[2]=i*s,r[3]=a*s,r}function Wr(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function e1(r,e,t,n){var i=t[0]*n[1]-t[1]*n[0],a=t[0]*n[2]-t[2]*n[0],s=t[0]*n[3]-t[3]*n[0],h=t[1]*n[2]-t[2]*n[1],c=t[1]*n[3]-t[3]*n[1],l=t[2]*n[3]-t[3]*n[2],o=e[0],p=e[1],f=e[2],x=e[3];return r[0]=p*l-f*c+x*h,r[1]=-(o*l)+f*s-x*a,r[2]=o*c-p*s+x*i,r[3]=-(o*h)+p*a-f*i,r}function jr(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=e[3];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=s+n*(t[2]-s),r[3]=h+n*(t[3]-h),r}function t1(r,e){e=e||1;var t,n,i,a,s,h;do t=q()*2-1,n=q()*2-1,s=t*t+n*n;while(s>=1);do i=q()*2-1,a=q()*2-1,h=i*i+a*a;while(h>=1);var c=Math.sqrt((1-s)/h);return r[0]=e*t,r[1]=e*n,r[2]=e*i*c,r[3]=e*a*c,r}function n1(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*a+t[12]*s,r[1]=t[1]*n+t[5]*i+t[9]*a+t[13]*s,r[2]=t[2]*n+t[6]*i+t[10]*a+t[14]*s,r[3]=t[3]*n+t[7]*i+t[11]*a+t[15]*s,r}function i1(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[0],h=t[1],c=t[2],l=t[3],o=l*n+h*a-c*i,p=l*i+c*n-s*a,f=l*a+s*i-h*n,x=-s*n-h*i-c*a;return r[0]=o*l+x*-s+p*-c-f*-h,r[1]=p*l+x*-h+f*-s-o*-c,r[2]=f*l+x*-c+o*-h-p*-s,r[3]=e[3],r}function a1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}function s1(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function Hr(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function kr(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=e[0],h=e[1],c=e[2],l=e[3];return Math.abs(t-s)<=y*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-h)<=y*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-c)<=y*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=y*Math.max(1,Math.abs(a),Math.abs(l))}var h1=Re,c1=Pe,l1=Te,o1=ze,p1=Se,f1=cr,x1=lr,v1=function(){var r=Ae();return function(e,t,n,i,a,s){var h,c;for(t||(t=4),n||(n=0),i?c=Math.min(i*t+n,e.length):c=e.length,h=n;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],r[3]=e[h+3],a(r,r,s),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2],e[h+3]=r[3];return e}}();function er(){var r=new T(4);return T!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function M1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function Ie(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function m1(r,e){var t=Math.acos(e[3])*2,n=Math.sin(t/2);return n>y?(r[0]=e[0]/n,r[1]=e[1]/n,r[2]=e[2]/n):(r[0]=1,r[1]=0,r[2]=0),t}function g1(r,e){var t=xr(r,e);return Math.acos(2*t*t-1)}function Le(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1],l=t[2],o=t[3];return r[0]=n*o+s*h+i*l-a*c,r[1]=i*o+s*c+a*h-n*l,r[2]=a*o+s*l+n*c-i*h,r[3]=s*o-n*h-i*c-a*l,r}function Br(r,e,t){t*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c+s*h,r[1]=i*c+a*h,r[2]=a*c-i*h,r[3]=s*c-n*h,r}function Gr(r,e,t){t*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c-a*h,r[1]=i*c+s*h,r[2]=a*c+n*h,r[3]=s*c-i*h,r}function Qr(r,e,t){t*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c+i*h,r[1]=i*c-n*h,r[2]=a*c+s*h,r[3]=s*c-a*h,r}function d1(r,e){var t=e[0],n=e[1],i=e[2];return r[0]=t,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-t*t-n*n-i*i)),r}function be(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=Math.sqrt(t*t+n*n+i*i),h=Math.exp(a),c=s>0?h*Math.sin(s)/s:0;return r[0]=t*c,r[1]=n*c,r[2]=i*c,r[3]=h*Math.cos(s),r}function Ye(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=Math.sqrt(t*t+n*n+i*i),h=s>0?Math.atan2(s,a)/s:0;return r[0]=t*h,r[1]=n*h,r[2]=i*h,r[3]=.5*Math.log(t*t+n*n+i*i+a*a),r}function y1(r,e,t){return Ye(r,e),Oe(r,r,t),be(r,r),r}function pr(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=e[3],c=t[0],l=t[1],o=t[2],p=t[3],f,x,M,m,v;return x=i*c+a*l+s*o+h*p,x<0&&(x=-x,c=-c,l=-l,o=-o,p=-p),1-x>y?(f=Math.acos(x),M=Math.sin(f),m=Math.sin((1-n)*f)/M,v=Math.sin(n*f)/M):(m=1-n,v=n),r[0]=m*i+v*c,r[1]=m*a+v*l,r[2]=m*s+v*o,r[3]=m*h+v*p,r}function w1(r){var e=q(),t=q(),n=q(),i=Math.sqrt(1-e),a=Math.sqrt(e);return r[0]=i*Math.sin(2*Math.PI*t),r[1]=i*Math.cos(2*Math.PI*t),r[2]=a*Math.sin(2*Math.PI*n),r[3]=a*Math.cos(2*Math.PI*n),r}function E1(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a,h=s?1/s:0;return r[0]=-t*h,r[1]=-n*h,r[2]=-i*h,r[3]=a*h,r}function A1(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function De(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[s*3+s]+1),r[i]=.5*n,n=.5/n,r[3]=(e[a*3+s]-e[s*3+a])*n,r[a]=(e[a*3+i]+e[i*3+a])*n,r[s]=(e[s*3+i]+e[i*3+s])*n}return r}function R1(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var a=Math.sin(e),s=Math.cos(e),h=Math.sin(t),c=Math.cos(t),l=Math.sin(n),o=Math.cos(n);return r[0]=a*c*o-s*h*l,r[1]=s*h*o+a*c*l,r[2]=s*c*l-a*h*o,r[3]=s*c*o+a*h*l,r}function P1(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}var T1=Nr,z1=Cr,fr=Fr,S1=qr,I1=Ur,L1=Le,Oe=Vr,xr=Wr,b1=jr,vr=cr,Y1=vr,Mr=lr,D1=Mr,Zr=Xr,O1=Hr,_1=kr,N1=function(){var r=ar(),e=sr(1,0,0),t=sr(0,1,0);return function(n,i,a){var s=hr(i,a);return s<-.999999?(rr(r,e,i),_r(r)<1e-6&&rr(r,t,i),Or(r,r),Ie(n,r,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(rr(r,i,a),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+s,Zr(n,n))}}(),C1=function(){var r=er(),e=er();return function(t,n,i,a,s,h){return pr(r,n,s,h),pr(e,i,a,h),pr(t,r,e,2*h*(1-h)),t}}(),F1=function(){var r=br();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],Zr(e,De(e,r))}}();var Kr={};V(Kr,{add:()=>aa,clone:()=>U1,conjugate:()=>oa,copy:()=>Ne,create:()=>q1,dot:()=>Fe,equals:()=>ma,exactEquals:()=>Ma,fromMat4:()=>H1,fromRotation:()=>j1,fromRotationTranslation:()=>_e,fromRotationTranslationValues:()=>X1,fromTranslation:()=>W1,fromValues:()=>V1,getDual:()=>Q1,getReal:()=>G1,getTranslation:()=>J1,identity:()=>k1,invert:()=>la,len:()=>pa,length:()=>qe,lerp:()=>ca,mul:()=>sa,multiply:()=>Ce,normalize:()=>xa,rotateAroundAxis:()=>ia,rotateByQuatAppend:()=>ta,rotateByQuatPrepend:()=>na,rotateX:()=>u1,rotateY:()=>ra,rotateZ:()=>ea,scale:()=>ha,set:()=>B1,setDual:()=>K1,setReal:()=>Z1,sqrLen:()=>fa,squaredLength:()=>mr,str:()=>va,translate:()=>$1});function q1(){var r=new T(8);return T!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function U1(r){var e=new T(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function V1(r,e,t,n,i,a,s,h){var c=new T(8);return c[0]=r,c[1]=e,c[2]=t,c[3]=n,c[4]=i,c[5]=a,c[6]=s,c[7]=h,c}function X1(r,e,t,n,i,a,s){var h=new T(8);h[0]=r,h[1]=e,h[2]=t,h[3]=n;var c=i*.5,l=a*.5,o=s*.5;return h[4]=c*n+l*t-o*e,h[5]=l*n+o*r-c*t,h[6]=o*n+c*e-l*r,h[7]=-c*r-l*e-o*t,h}function _e(r,e,t){var n=t[0]*.5,i=t[1]*.5,a=t[2]*.5,s=e[0],h=e[1],c=e[2],l=e[3];return r[0]=s,r[1]=h,r[2]=c,r[3]=l,r[4]=n*l+i*c-a*h,r[5]=i*l+a*s-n*c,r[6]=a*l+n*h-i*s,r[7]=-n*s-i*h-a*c,r}function W1(r,e){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0]*.5,r[5]=e[1]*.5,r[6]=e[2]*.5,r[7]=0,r}function j1(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function H1(r,e){var t=er();Dr(t,e);var n=new T(3);return Yr(n,e),_e(r,t,n),r}function Ne(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function k1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function B1(r,e,t,n,i,a,s,h,c){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=h,r[7]=c,r}var G1=fr;function Q1(r,e){return r[0]=e[4],r[1]=e[5],r[2]=e[6],r[3]=e[7],r}var Z1=fr;function K1(r,e){return r[4]=e[0],r[5]=e[1],r[6]=e[2],r[7]=e[3],r}function J1(r,e){var t=e[4],n=e[5],i=e[6],a=e[7],s=-e[0],h=-e[1],c=-e[2],l=e[3];return r[0]=(t*l+a*s+n*c-i*h)*2,r[1]=(n*l+a*h+i*s-t*c)*2,r[2]=(i*l+a*c+t*h-n*s)*2,r}function $1(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0]*.5,c=t[1]*.5,l=t[2]*.5,o=e[4],p=e[5],f=e[6],x=e[7];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=s*h+i*l-a*c+o,r[5]=s*c+a*h-n*l+p,r[6]=s*l+n*c-i*h+f,r[7]=-n*h-i*c-a*l+x,r}function u1(r,e,t){var n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=h*s+o*n+c*a-l*i,f=c*s+o*i+l*n-h*a,x=l*s+o*a+h*i-c*n,M=o*s-h*n-c*i-l*a;return Br(r,e,t),n=r[0],i=r[1],a=r[2],s=r[3],r[4]=p*s+M*n+f*a-x*i,r[5]=f*s+M*i+x*n-p*a,r[6]=x*s+M*a+p*i-f*n,r[7]=M*s-p*n-f*i-x*a,r}function ra(r,e,t){var n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=h*s+o*n+c*a-l*i,f=c*s+o*i+l*n-h*a,x=l*s+o*a+h*i-c*n,M=o*s-h*n-c*i-l*a;return Gr(r,e,t),n=r[0],i=r[1],a=r[2],s=r[3],r[4]=p*s+M*n+f*a-x*i,r[5]=f*s+M*i+x*n-p*a,r[6]=x*s+M*a+p*i-f*n,r[7]=M*s-p*n-f*i-x*a,r}function ea(r,e,t){var n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],o=e[7],p=h*s+o*n+c*a-l*i,f=c*s+o*i+l*n-h*a,x=l*s+o*a+h*i-c*n,M=o*s-h*n-c*i-l*a;return Qr(r,e,t),n=r[0],i=r[1],a=r[2],s=r[3],r[4]=p*s+M*n+f*a-x*i,r[5]=f*s+M*i+x*n-p*a,r[6]=x*s+M*a+p*i-f*n,r[7]=M*s-p*n-f*i-x*a,r}function ta(r,e,t){var n=t[0],i=t[1],a=t[2],s=t[3],h=e[0],c=e[1],l=e[2],o=e[3];return r[0]=h*s+o*n+c*a-l*i,r[1]=c*s+o*i+l*n-h*a,r[2]=l*s+o*a+h*i-c*n,r[3]=o*s-h*n-c*i-l*a,h=e[4],c=e[5],l=e[6],o=e[7],r[4]=h*s+o*n+c*a-l*i,r[5]=c*s+o*i+l*n-h*a,r[6]=l*s+o*a+h*i-c*n,r[7]=o*s-h*n-c*i-l*a,r}function na(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1],l=t[2],o=t[3];return r[0]=n*o+s*h+i*l-a*c,r[1]=i*o+s*c+a*h-n*l,r[2]=a*o+s*l+n*c-i*h,r[3]=s*o-n*h-i*c-a*l,h=t[4],c=t[5],l=t[6],o=t[7],r[4]=n*o+s*h+i*l-a*c,r[5]=i*o+s*c+a*h-n*l,r[6]=a*o+s*l+n*c-i*h,r[7]=s*o-n*h-i*c-a*l,r}function ia(r,e,t,n){if(Math.abs(n)<y)return Ne(r,e);var i=Math.hypot(t[0],t[1],t[2]);n=n*.5;var a=Math.sin(n),s=a*t[0]/i,h=a*t[1]/i,c=a*t[2]/i,l=Math.cos(n),o=e[0],p=e[1],f=e[2],x=e[3];r[0]=o*l+x*s+p*c-f*h,r[1]=p*l+x*h+f*s-o*c,r[2]=f*l+x*c+o*h-p*s,r[3]=x*l-o*s-p*h-f*c;var M=e[4],m=e[5],v=e[6],d=e[7];return r[4]=M*l+d*s+m*c-v*h,r[5]=m*l+d*h+v*s-M*c,r[6]=v*l+d*c+M*h-m*s,r[7]=d*l-M*s-m*h-v*c,r}function aa(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r}function Ce(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[4],c=t[5],l=t[6],o=t[7],p=e[4],f=e[5],x=e[6],M=e[7],m=t[0],v=t[1],d=t[2],E=t[3];return r[0]=n*E+s*m+i*d-a*v,r[1]=i*E+s*v+a*m-n*d,r[2]=a*E+s*d+n*v-i*m,r[3]=s*E-n*m-i*v-a*d,r[4]=n*o+s*h+i*l-a*c+p*E+M*m+f*d-x*v,r[5]=i*o+s*c+a*h-n*l+f*E+M*v+x*m-p*d,r[6]=a*o+s*l+n*c-i*h+x*E+M*d+p*v-f*m,r[7]=s*o-n*h-i*c-a*l+M*E-p*m-f*v-x*d,r}var sa=Ce;function ha(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r}var Fe=xr;function ca(r,e,t,n){var i=1-n;return Fe(e,t)<0&&(n=-n),r[0]=e[0]*i+t[0]*n,r[1]=e[1]*i+t[1]*n,r[2]=e[2]*i+t[2]*n,r[3]=e[3]*i+t[3]*n,r[4]=e[4]*i+t[4]*n,r[5]=e[5]*i+t[5]*n,r[6]=e[6]*i+t[6]*n,r[7]=e[7]*i+t[7]*n,r}function la(r,e){var t=mr(e);return r[0]=-e[0]/t,r[1]=-e[1]/t,r[2]=-e[2]/t,r[3]=e[3]/t,r[4]=-e[4]/t,r[5]=-e[5]/t,r[6]=-e[6]/t,r[7]=e[7]/t,r}function oa(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=e[7],r}var qe=vr,pa=qe,mr=Mr,fa=mr;function xa(r,e){var t=mr(e);if(t>0){t=Math.sqrt(t);var n=e[0]/t,i=e[1]/t,a=e[2]/t,s=e[3]/t,h=e[4],c=e[5],l=e[6],o=e[7],p=n*h+i*c+a*l+s*o;r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=(h-n*p)/t,r[5]=(c-i*p)/t,r[6]=(l-a*p)/t,r[7]=(o-s*p)/t}return r}function va(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"}function Ma(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]}function ma(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=r[6],l=r[7],o=e[0],p=e[1],f=e[2],x=e[3],M=e[4],m=e[5],v=e[6],d=e[7];return Math.abs(t-o)<=y*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-p)<=y*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(i-f)<=y*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-x)<=y*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-M)<=y*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(h-m)<=y*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(c-v)<=y*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(l-d)<=y*Math.max(1,Math.abs(l),Math.abs(d))}var k={};V(k,{add:()=>Ea,angle:()=>Xa,ceil:()=>Aa,clone:()=>ga,copy:()=>ya,create:()=>Ue,cross:()=>Oa,dist:()=>Ka,distance:()=>je,div:()=>Za,divide:()=>We,dot:()=>Da,equals:()=>ka,exactEquals:()=>Ha,floor:()=>Ra,forEach:()=>ua,fromValues:()=>da,inverse:()=>ba,len:()=>Ba,length:()=>ke,lerp:()=>_a,max:()=>Ta,min:()=>Pa,mul:()=>Qa,multiply:()=>Xe,negate:()=>La,normalize:()=>Ya,random:()=>Na,rotate:()=>Va,round:()=>za,scale:()=>Sa,scaleAndAdd:()=>Ia,set:()=>wa,sqrDist:()=>Ja,sqrLen:()=>$a,squaredDistance:()=>He,squaredLength:()=>Be,str:()=>ja,sub:()=>Ga,subtract:()=>Ve,transformMat2:()=>Ca,transformMat2d:()=>Fa,transformMat3:()=>qa,transformMat4:()=>Ua,zero:()=>Wa});function Ue(){var r=new T(2);return T!=Float32Array&&(r[0]=0,r[1]=0),r}function ga(r){var e=new T(2);return e[0]=r[0],e[1]=r[1],e}function da(r,e){var t=new T(2);return t[0]=r,t[1]=e,t}function ya(r,e){return r[0]=e[0],r[1]=e[1],r}function wa(r,e,t){return r[0]=e,r[1]=t,r}function Ea(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function Ve(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function Xe(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r}function We(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r}function Aa(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}function Ra(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}function Pa(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r}function Ta(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r}function za(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}function Sa(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r}function Ia(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r}function je(r,e){var t=e[0]-r[0],n=e[1]-r[1];return Math.hypot(t,n)}function He(r,e){var t=e[0]-r[0],n=e[1]-r[1];return t*t+n*n}function ke(r){var e=r[0],t=r[1];return Math.hypot(e,t)}function Be(r){var e=r[0],t=r[1];return e*e+t*t}function La(r,e){return r[0]=-e[0],r[1]=-e[1],r}function ba(r,e){return r[0]=1/e[0],r[1]=1/e[1],r}function Ya(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r}function Da(r,e){return r[0]*e[0]+r[1]*e[1]}function Oa(r,e,t){var n=e[0]*t[1]-e[1]*t[0];return r[0]=r[1]=0,r[2]=n,r}function _a(r,e,t,n){var i=e[0],a=e[1];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r}function Na(r,e){e=e||1;var t=q()*2*Math.PI;return r[0]=Math.cos(t)*e,r[1]=Math.sin(t)*e,r}function Ca(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r}function Fa(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i+t[4],r[1]=t[1]*n+t[3]*i+t[5],r}function qa(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[3]*i+t[6],r[1]=t[1]*n+t[4]*i+t[7],r}function Ua(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[4]*i+t[12],r[1]=t[1]*n+t[5]*i+t[13],r}function Va(r,e,t,n){var i=e[0]-t[0],a=e[1]-t[1],s=Math.sin(n),h=Math.cos(n);return r[0]=i*h-a*s+t[0],r[1]=i*s+a*h+t[1],r}function Xa(r,e){var t=r[0],n=r[1],i=e[0],a=e[1],s=Math.sqrt(t*t+n*n)*Math.sqrt(i*i+a*a),h=s&&(t*i+n*a)/s;return Math.acos(Math.min(Math.max(h,-1),1))}function Wa(r){return r[0]=0,r[1]=0,r}function ja(r){return"vec2("+r[0]+", "+r[1]+")"}function Ha(r,e){return r[0]===e[0]&&r[1]===e[1]}function ka(r,e){var t=r[0],n=r[1],i=e[0],a=e[1];return Math.abs(t-i)<=y*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(n-a)<=y*Math.max(1,Math.abs(n),Math.abs(a))}var Ba=ke,Ga=Ve,Qa=Xe,Za=We,Ka=je,Ja=He,$a=Be,ua=function(){var r=Ue();return function(e,t,n,i,a,s){var h,c;for(t||(t=2),n||(n=0),i?c=Math.min(i*t+n,e.length):c=e.length,h=n;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],a(r,r,s),e[h]=r[0],e[h+1]=r[1];return e}}();var B=class{position=S.fromValues(0,0,-1);direction=S.fromValues(0,0,-1);up=S.fromValues(0,1,0);projectionMatrix=N.create();viewMatrix=N.create();cameraMatrix=N.create();viewportWidth=0;viewportHeight=0;near=1;far=100;tpmVec=S.create();constructor(){}lookAt(...e){if(e.length==1)S.copy(this.tpmVec,e[0]);else if(e.length==3)S.set(this.tpmVec,...e);else throw new Error("required 1 or 3 arguments");S.sub(this.tpmVec,this.tpmVec,this.position),S.normalize(this.tpmVec,this.tpmVec);let t=S.dot(this.tpmVec,this.up);U.equals(t,1)?S.negate(this.up,this.direction):U.equals(t,-1)&&S.copy(this.up,this.direction),S.copy(this.direction,this.tpmVec),S.cross(this.up,this.getRight(),this.direction),S.normalize(this.up,this.up)}getRight(){return S.cross(this.tpmVec,this.direction,this.up)}updateConstants(e){N.lookAt(this.viewMatrix,this.position,S.add(this.tpmVec,this.position,this.direction),this.up),N.invert(this.cameraMatrix,this.viewMatrix),e.projectionMatrix=this.projectionMatrix,e.viewMatrix=this.viewMatrix,e.cameraMatrix=this.cameraMatrix,e.cameraPosition=this.position}};var F=class{buffers=new Map;vertexCount=0;options;constructor(e={}){this.options=e,this.onInit()}onInit(){}bufferData(e,t,n){let i=g.gl.createBuffer();n=="index"?(g.gl.bindBuffer(g.gl.ELEMENT_ARRAY_BUFFER,i),g.gl.bufferData(g.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),g.gl.STATIC_DRAW),this.vertexCount=e.length):(g.gl.bindBuffer(g.gl.ARRAY_BUFFER,i),g.gl.bufferData(g.gl.ARRAY_BUFFER,new Float32Array(e),g.gl.STATIC_DRAW)),this.buffers.has(n)&&g.gl.deleteBuffer(this.buffers.get(n).buffer),this.buffers.set(n,{size:t,data:e,buffer:i})}bind(e){this.buffers.forEach((t,n)=>{let i=e.shaderData.attribs[n];i!=-1&&(n=="index"?g.gl.bindBuffer(g.gl.ELEMENT_ARRAY_BUFFER,t.buffer):(g.gl.bindBuffer(g.gl.ARRAY_BUFFER,t.buffer),g.gl.vertexAttribPointer(i,t.size,g.gl.FLOAT,!1,0,0),g.gl.enableVertexAttribArray(i)))})}draw(){g.gl.drawElements(g.gl.TRIANGLES,this.vertexCount,g.gl.UNSIGNED_SHORT,0)}unbind(e){this.buffers.forEach((t,n)=>{let i=e.shaderData.attribs[n];i!=-1&&n!="index"&&g.gl.disableVertexAttribArray(i)})}};var j=class{shaderData;uniforms=new Map;constructor(e){this.shaderData=e,this.setUniform("uvOffset",[0,0])}setUniform(e,t){this.uniforms.set(e,t)}activate(){this.shaderData.activate()}bind(e){for(let t of this.shaderData.uniforms){let n=e[t.name];if(this.uniforms.has(t.name)&&(n=this.uniforms.get(t.name)),n&&t.location){let i=t.type,a=t.location;switch(i){case"mat4":g.gl.uniformMatrix4fv(a,!1,n);break;case"mat3":g.gl.uniformMatrix3fv(a,!1,val);break;case"vec4":g.gl.uniform4fv(a,n);break;case"vec3":g.gl.uniform3fv(a,n);break;case"vec2":g.gl.uniform2fv(a,n);break;case"float":g.gl.uniform1f(a,n);break}}}}};var G=class{mesh;shader;texture;position=S.create();rotation=K.create();scale=S.fromValues(1,1,1);parent=null;constructor(e,t,n){this.mesh=e,this.shader=t,this.texture=n}draw(e){this.shader.activate(),this.texture&&this.texture.bind();let t=N.create();N.fromRotationTranslationScale(t,this.rotation,this.position,this.scale);let n=e.viewMatrix,i=N.create();N.multiply(i,n,t);let a=H.create();H.fromMat4(a,t),H.invert(a,a),H.transpose(a,a),this.shader.setUniform("modelViewMatrix",i),this.shader.setUniform("modelMatrix",t),this.shader.setUniform("normalMatrix",a),this.shader.bind(e),this.mesh.bind(this.shader),this.mesh.draw(),this.mesh.unbind(this.shader)}};var gr=class extends B{fov;constructor(e,t,n,i,a){super(),this.fov=e,this.viewportWidth=t,this.viewportHeight=n,this.near=i,this.far=a,this.updateProjection()}updateProjection(){let e=this.viewportWidth/this.viewportHeight;N.perspective(this.projectionMatrix,this.fov/180*Math.PI,e,this.near,this.far)}};var Jr={};V(Jr,{Cube:()=>dr,Plane:()=>yr,Quad:()=>J,Sphere:()=>wr});var dr=class extends F{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.height?this.options.height/2:.5,n=this.options.depth?this.options.depth/2:.5,i=[-e,t,n,e,t,n,e,-t,n,-e,-t,n,-e,t,-n,e,t,-n,e,-t,-n,-e,-t,-n,-e,t,-n,e,t,-n,e,t,n,-e,t,n,-e,-t,n,e,-t,n,e,-t,-n,-e,-t,-n,e,t,n,e,t,-n,e,-t,-n,e,-t,n,-e,t,-n,-e,t,n,-e,-t,n,-e,-t,-n],a=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],s="single";this.options.textureFaces!==void 0&&(s=this.options.textureFaces);let h=[];if(s=="single")for(let p=0;p<6;++p)h.push(0,0,1,0,1,1,0,1);else if(s=="multiple"){let x=(M,m)=>{h.push(M*.25,m*.5,.25*(M+1),m*.5,.25*(M+1),.5*(m+1),M*.25,.5*(m+1))};x(1,0),x(3,0),x(0,1),x(1,1),x(2,0),x(0,0)}else throw new Error("options.textureFaces valid values are single or multiple");let c=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],l=[];if(this.options.colors===void 0)for(let p=0;p<24;++p)l.push(1);else if(this.options.colors.length==1){let p=this.options.colors[0];for(let f=0;f<24;++f)l.push(p[f%4])}else if(this.options.colors.length==6)for(let p=0;p<6;++p){let f=this.options.colors[p];for(let x=0;x<4;++x)l.push(f[x])}else throw new Error("options.colors requires 1 or 6 elements");let o=[];for(let p=0;p<6;++p)for(let f=0;f<4;++f)for(let x=0;x<4;++x)o.push(l[p*4+x]);this.bufferData(i,3,"positions"),this.bufferData(a,3,"normals"),this.bufferData(o,4,"colors"),this.bufferData(h,2,"uvs"),this.bufferData(c,0,"index")}};var yr=class extends F{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.depth?this.options.depth/2:.5,n=this.options.widthSegments||1,i=this.options.depthSegments||1,a=this.options.heightMap||[...new Array(i+1)].map(p=>[...new Array(n+1)].fill(0)),s=[],h=[],c=[],l=[],o=[];for(let p=0;p<i;++p)for(let f=0;f<n;++f){s.push((2*f/n-1)*e,a[p][f],(2*p/i-1)*t,(2*(f+1)/n-1)*e,a[p][f+1],(2*p/i-1)*t,(2*(f+1)/n-1)*e,a[p+1][f+1],(2*(p+1)/i-1)*t,(2*f/n-1)*e,a[p+1][f],(2*(p+1)/i-1)*t),h.push(0,1,0,0,1,0,0,1,0,0,1,0),this.options.textureRepeat===void 0||this.options.textureRepeat===!1?c.push(f/n,p/i,(f+1)/n,p/i,(f+1)/n,(p+1)/i,f/n,(p+1)/i):c.push(0,0,1,0,1,1,0,1);let x=(p*n+f)*4;o.push(x,x+1,x+2,x,x+2,x+3)}if(this.options.colors===void 0)for(let p=0;p<n*i*16;++p)l.push(1);else if(this.options.colors.length==1){let p=this.options.colors[0];for(let f=0;f<n*i*16;++f)l.push(p[f%4])}else throw new Error("options.colors requires 1 elements");this.bufferData(s,3,"positions"),this.bufferData(h,3,"normals"),this.bufferData(l,4,"colors"),this.bufferData(c,2,"uvs"),this.bufferData(o,0,"index")}};var J=class extends F{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.height?this.options.height/2:.5,n=[-e,t,0,e,t,0,e,-t,0,-e,-t,0],i=[0,0,1,0,0,1,0,0,1,0,0,1],a=[];if(this.options.colors===void 0)for(let c=0;c<16;++c)a.push(1);else if(this.options.colors.length==1){let c=this.options.colors[0];for(let l=0;l<16;++l)a.push(c[l%4])}else if(this.options.colors.length==4)for(let c=0;c<4;++c){let l=this.options.colors[c];for(let o=0;o<4;++o)a.push(l[o])}else throw new Error("options.colors requires 1 or 4 elements");let s=[0,0,1,0,1,1,0,1],h=[0,1,2,0,2,3];this.bufferData(n,3,"positions"),this.bufferData(i,3,"normals"),this.bufferData(a,4,"colors"),this.bufferData(s,2,"uvs"),this.bufferData(h,0,"index")}};var wr=class extends F{onInit(){let e=this.options.radius||.5,t=this.options.widthSegments||32,n=this.options.heightSegments||16,i=[],a=[],s=[],h=[],c=[],l=[],o=[];for(let f=0;f<=n;++f){let x=f/n*Math.PI,M=Math.sin(x),m=Math.cos(x);for(let v=0;v<=t;++v){let d=v/t*2*Math.PI,E=Math.sin(d),w=Math.cos(d);c.push([M*w*e,m*e,M*E*e]),l.push([1-v/t,f/n])}}if(this.options.colors===void 0)for(let f=0;f<(t+1)*(n+1);++f)o.push([1,1,1,1]);else if(this.options.colors.length==1){let f=this.options.colors[0];for(let x=0;x<(t+1)*(n+1);++x)o.push(f)}else throw new Error("options.colors requires 1 elements");let p=0;for(let f=0;f<n;++f)for(let x=0;x<t;++x){let M=f*(t+1)+x,m=M+(t+1),v=[M,M+1,m+1,m];for(let d of v)i.push(...c[d]),a.push(...l[d]),s.push(...o[d]);h.push(p,p+1,p+2,p,p+2,p+3),p+=4}this.bufferData(i,3,"positions"),this.bufferData(s,4,"colors"),this.bufferData(a,2,"uvs"),this.bufferData(h,0,"index")}};var Er=class extends B{zoom=1;constructor(e,t){super(),this.near=0,this.setToOrtho(e,t)}setToOrtho(e,t){this.viewportWidth=e,this.viewportHeight=t,S.set(this.position,this.zoom*e/2,this.zoom*t/2,0),this.updateProjection()}updateProjection(){N.ortho(this.projectionMatrix,this.zoom*-this.viewportWidth/2,this.zoom*this.viewportWidth/2,this.zoom*-this.viewportHeight/2,this.zoom*this.viewportHeight/2,this.near,this.far)}translate(...e){if(e.length==1)S.set(this.position,...e[0],0);else if(e.length==2)S.set(this.position,e[0],e[1],0);else throw new Error("required 1 or 2 arguments")}zoomBy(...e){let t=e[0];if(this.zoom*=1+t,e.length==2||e.length==3){let n=k.create();e.length==2?k.copy(n,e[1]):k.set(n,...e),k.sub(n,n,this.position),k.scale(n,n,t),S.add(this.position,this.position,[...n,0])}}};var Ar=class extends G{regionX;regionY;regionWidth;regionHeight;constructor(...e){let t=e[0],n=0,i=0,a=t.width,s=t.height;e.length==3?(a=e[1],s=e[2]):e.length==5&&(n=e[1],i=e[2],a=e[3],s=e[4]),super(new J,new j(g.graphics.getShader("texture")),t),this.setRegionSize(a,s),this.setRegionPosition(n,i)}setRegionSize(e,t){this.regionWidth=e,this.regionHeight=t;let n=[0,0,e/this.texture.width,0,e/this.texture.width,t/this.texture.height,0,t/this.texture.height];this.mesh.bufferData(n,2,"uvs")}setRegionPosition(e,t){this.regionX=e,this.regionY=t,this.shader.setUniform("uvOffset",[e/this.texture.width,t/this.texture.height])}};var Rr=class extends G{font;text;rainbow;constructor(e,t,n=!1){super(new F,new j(g.graphics.getShader("texture")),e.texture),this.font=e,this.text=t,this.rainbow=n,this.updateGeometry()}updateGeometry(){let e=[],t=[],n=[],i=[],a=this.font.charWidth,s=this.font.charHeight,h=this.font.options.charRatio,c=(1-this.text.length)*h*.5;for(let l=0;l<this.text.length;++l){let o=this.text.charCodeAt(l),p=this.font.getCharPosition(o);if(p===null)continue;let[f,x]=p;e.push(-.5*h+c,.5,0,.5*h+c,.5,0,.5*h+c,-.5,0,-.5*h+c,-.5,0),n.push(f/this.texture.width,x/this.texture.height,(f+a)/this.texture.width,x/this.texture.height,(f+a)/this.texture.width,(x+s)/this.texture.height,f/this.texture.width,(x+s)/this.texture.height);let M=l*4;i.push(M,M+1,M+2,M,M+2,M+3),c+=h}if(this.rainbow)for(let l=0;l<4*this.text.length;++l)t.push(Math.random(),Math.random(),Math.random(),1);else for(let l=0;l<4*this.text.length;++l)t.push(1,1,1,1);this.mesh.bufferData(e,3,"positions"),this.mesh.bufferData(t,4,"colors"),this.mesh.bufferData(n,2,"uvs"),this.mesh.bufferData(i,0,"index")}setText(e){this.text=e,this.updateGeometry()}};var Pr=class{mesh;texture;shader;particles=[];constructor(e){this.mesh=new F,this.texture=e.texture,this.shader=new j(g.graphics.getShader("particle"))}addParticles(){}updateParticles(){}updateGeometry(){let e=[],t=[],n=[];for(let i of this.particles)e.push(...i.position),t.push(...i.color,i.alpha),n.push(i.size);this.mesh.bufferData(e,3,"positions"),this.mesh.bufferData(t,4,"colors"),this.mesh.bufferData(n,1,"sizes")}draw(e){this.shader.activate(),this.texture.bind();let t=N.create(),n=e.viewMatrix,i=N.create();N.multiply(i,n,t),this.shader.setUniform("modelViewMatrix",i),this.shader.bind(e),this.mesh.bind(this.shader);let a=this.particles.length;g.gl.drawArrays(g.gl.POINTS,0,a),this.mesh.unbind(this.shader)}update(){this.addParticles(),this.updateParticles(),this.updateGeometry()}};var $r=class{touchInfo=[];keyInfo={currentlyPressed:new Set,previouslyPressed:new Set,justPressed:new Set};constructor(){for(let e=0;e<$r.MAX_TOUCHES;++e)this.touchInfo[e]={x:null,y:null,isTouched:!1,wasTouched:!1,isJustTouched:!1}}isKeyPressed(e){return this.keyInfo.currentlyPressed.has(e)}isKeyClicked(e){return this.keyInfo.justPressed.has(e)}isTouched(e=0){return this.touchInfo[e].isTouched}isJustTouched(e=0){return this.touchInfo[e].isJustTouched}isMousePressed(){return this.isTouched()}isMouseClicked(){return this.isJustTouched()}getX(e=0){return this.touchInfo[e].x}getY(e=0){return this.touchInfo[e].y}initEvents(){let e=g.graphics.canvas;addEventListener("keydown",t=>this.onKeyDown(t)),addEventListener("keyup",t=>this.onKeyUp(t)),e.addEventListener("touchstart",t=>this.handleTouchEvent(t)),e.addEventListener("touchmove",t=>this.handleTouchEvent(t)),e.addEventListener("touchend",t=>this.handleTouchEvent(t)),e.addEventListener("mousedown",t=>this.handleMouseEvent(t)),e.addEventListener("mousemove",t=>this.handleMouseEvent(t)),e.addEventListener("mouseup",t=>this.handleMouseEvent(t))}handleTouchEvent(e){let t=e.target.getBoundingClientRect();for(let n of e.changedTouches){let i=n.pageX-t.x,a=n.pageY-t.y,s=this.touchInfo[n.identifier];switch(s.x=i,s.y=a,e.type){case"touchstart":s.isTouched=!0;break;case"touchend":s.isTouched=!1}}}handleMouseEvent(e){let t=e.target.getBoundingClientRect(),n=e.pageX-t.x,i=e.pageY-t.y,a=this.touchInfo[0];switch(a.x=n,a.y=i,e.type){case"mousedown":a.isTouched=!0;break;case"mouseup":a.isTouched=!1}}onKeyDown(e){this.keyInfo.currentlyPressed.add(e.code)}onKeyUp(e){this.keyInfo.currentlyPressed.delete(e.code)}update(){this.keyInfo.currentlyPressed.forEach(e=>{this.keyInfo.previouslyPressed.has(e)||this.keyInfo.justPressed.add(e)}),this.keyInfo.previouslyPressed=new Set(this.keyInfo.currentlyPressed);for(let e of this.touchInfo)e.isJustTouched=e.isTouched&&!e.wasTouched,e.wasTouched=e.isTouched}},tr=$r;X(tr,"MAX_TOUCHES",10);var Ze={};V(Ze,{LinearSpline:()=>Tr,MathUtils:()=>zr});var Tr=class{points=[];constructor(e){this.lerp=e}addPoint(e,t){this.points.push([e,t]);for(let n=this.points.length-1;n>0&&!(this.points[n][0]>=this.points[n-1][0]);--n)[this.points[n],this.points[n-1]]=[this.points[n-1],this.points[n]]}getValue(e){let t=0;for(let s=0;s<this.points.length&&!(e<this.points[s][0]);++s)t=s;let n=this.points[t],i=Math.min(t+1,this.points.length-1);if(t==i)return n[1];let a=this.points[i];return this.lerp((e-n[0])/(a[0]-n[0]),n[1],a[1])}};var zr=class{static lerp(e,t,n){return(n-t)*e+t}static rand(e,t){return Math.random()*(t-e)+e}static randInt(e,t){return Math.floor(this.rand(e,t+1))}static clamp(e,t,n){return Math.min(Math.max(e,t),n)}static sat(e){return this.clamp(e,0,1)}static shuffle(e){for(let t=0;t<e.length;++t){let n=this.randInt(0,e.length-1);[e[t],e[n]]=[e[n],e[t]]}}static choice(e){return e[this.randInt(0,e.length-1)]}};var g=class{static async init(e){this.graphics=new ir(e),this.files=new nr,this.input=new tr,this.input.initEvents(),this.graphics.compileShaders(),this.graphics.generateFonts(),e.preload(),await this.files.waitForAssetsToLoad(),e.create(),addEventListener("resize",()=>this.graphics.onResize()),this.graphics.onResize(),this.graphics.onResume()}static get gl(){return this.graphics.gl}};X(g,"graphics"),X(g,"files"),X(g,"input");export{Sr as Game,g as Gol,Ge as glMatrix,Qe as graphics,Ze as math};
//# sourceMappingURL=goliath.js.map
