var re=Object.defineProperty;var Ze=(r,e,t)=>e in r?re(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var U=(r,e)=>{for(var t in e)re(r,t,{get:e[t],enumerable:!0})};var X=(r,e,t)=>(Ze(r,typeof e!="symbol"?e+"":e,t),t);var nr=class{assets=new Map;toLoad=0;loadImage(e,t){let n=new Image;n.src=t,n.crossOrigin="Anonymous";let i=new Promise(a=>{n.onload=()=>{a(n)}});return this.addAsync(e,i),i}loadAudio(e,t){let n=new Audio(t);n.load();let i=new Promise(a=>{n.oncanplaythrough=()=>{a(n)}});return this.addAsync(e,i),i}addAsync(e,t){++this.toLoad,t.then(n=>{this.assets.set(e,n),--this.toLoad})}waitForAssetsToLoad(){return new Promise(e=>{let t=()=>{this.toLoad==0?e(this.assets):setTimeout(()=>{t()},250)};t()})}get(e){return this.assets.get(e)}};var zr=class{constructor(){}preload(){}create(){}resize(e,t){}render(e){}};var Q=class{id;data;constructor(e,t={}){this.data=e,this.id=g.gl.createTexture(),g.gl.bindTexture(g.gl.TEXTURE_2D,this.id),g.gl.texImage2D(g.gl.TEXTURE_2D,0,g.gl.RGBA,g.gl.RGBA,g.gl.UNSIGNED_BYTE,e),g.gl.generateMipmap(g.gl.TEXTURE_2D),g.gl.bindTexture(g.gl.TEXTURE_2D,null),t.filter!==void 0&&this.setFilter(t.filter),t.wrap!==void 0&&this.setWrap(t.wrap)}setFilter(e){g.gl.bindTexture(g.gl.TEXTURE_2D,this.id),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_MIN_FILTER,e),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_MAG_FILTER,e==g.gl.NEAREST?g.gl.NEAREST:g.gl.LINEAR),g.gl.bindTexture(g.gl.TEXTURE_2D,null)}setWrap(e){g.gl.bindTexture(g.gl.TEXTURE_2D,this.id),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_WRAP_S,e),g.gl.texParameteri(g.gl.TEXTURE_2D,g.gl.TEXTURE_WRAP_T,e),g.gl.bindTexture(g.gl.TEXTURE_2D,null)}bind(){g.gl.bindTexture(g.gl.TEXTURE_2D,this.id)}dispose(){g.gl.deleteTexture(this.id)}get width(){return this.data.width}get height(){return this.data.height}};var Z=class{options;columns=10;charFrom=32;charTo=126;bitmap;texture;charWidth;charHeight;constructor(e){this.options=e,this.charWidth=e.fontSize*e.charRatio,this.charHeight=e.fontSize*1.2,this.bitmap=this.generateBitmap(),this.texture=new Q(this.bitmap,{filter:g.gl.LINEAR_MIPMAP_LINEAR})}generateBitmap(){let e=document.createElement("canvas"),t=this.charTo-this.charFrom+1,n=Math.floor(t/this.columns);e.width=2**Math.ceil(Math.log2(this.columns*this.charWidth)),e.height=2**Math.ceil(Math.log2(n*this.charHeight));let i=e.getContext("2d");i.textBaseline="middle",i.textAlign="center",i.fillStyle="white",i.font=`${this.options.fontSize}px ${this.options.fontFamily}`;for(let a=0;a<t;++a){let s=String.fromCharCode(a+this.charFrom),h=(a%this.columns+.5)*this.charWidth,c=(Math.floor(a/this.columns)+.5)*this.charHeight;i.fillText(s,h,c)}return e}getCharPosition(e){if(e<this.charFrom||e>this.charTo)return null;let t=e-this.charFrom;return[t%this.columns*this.charWidth,Math.floor(t/this.columns)*this.charHeight]}};var F=class{program;constructor(e,t){let n=this.compileShader(e,g.gl.VERTEX_SHADER),i=this.compileShader(t,g.gl.FRAGMENT_SHADER);if(this.program=g.gl.createProgram(),g.gl.attachShader(this.program,n),g.gl.attachShader(this.program,i),g.gl.linkProgram(this.program),!g.gl.getProgramParameter(this.program,g.gl.LINK_STATUS))throw console.log(g.gl.getProgramInfoLog(this.program)),new Error("program unable to link");this.attribs={positions:g.gl.getAttribLocation(this.program,"position"),normals:g.gl.getAttribLocation(this.program,"normal"),colors:g.gl.getAttribLocation(this.program,"color"),uvs:g.gl.getAttribLocation(this.program,"uv"),sizes:g.gl.getAttribLocation(this.program,"size")},this.uniforms=[{name:"projectionMatrix",type:"mat4",location:g.gl.getUniformLocation(this.program,"projectionMatrix")},{name:"modelViewMatrix",type:"mat4",location:g.gl.getUniformLocation(this.program,"modelViewMatrix")},{name:"modelMatrix",type:"mat4",location:g.gl.getUniformLocation(this.program,"modelMatrix")},{name:"normalMatrix",type:"mat3",location:g.gl.getUniformLocation(this.program,"normalMatrix")},{name:"lightColor",type:"vec3",location:g.gl.getUniformLocation(this.program,"lightColor")},{name:"lightDirection",type:"vec3",location:g.gl.getUniformLocation(this.program,"lightDirection")},{name:"lightPosition",type:"vec3",location:g.gl.getUniformLocation(this.program,"lightPosition")},{name:"cameraPosition",type:"vec3",location:g.gl.getUniformLocation(this.program,"cameraPosition")},{name:"pointMultiplier",type:"float",location:g.gl.getUniformLocation(this.program,"pointMultiplier")},{name:"ambientColor",type:"vec3",location:g.gl.getUniformLocation(this.program,"ambientColor")},{name:"uvOffset",type:"vec2",location:g.gl.getUniformLocation(this.program,"uvOffset")}]}activate(){g.gl.useProgram(this.program)}compileShader(e,t){let n=g.gl.createShader(t);if(g.gl.shaderSource(n,e),g.gl.compileShader(n),!g.gl.getShaderParameter(n,g.gl.COMPILE_STATUS))throw console.log(g.gl.getShaderInfoLog(n)),new Error("shader unable to compile");return n}};X(F,"SIMPLE_VS",`
    uniform mat4 modelViewMatrix;
    uniform mat4 projectionMatrix;

    attribute vec3 position;
    attribute vec4 color;

    varying vec4 vColor;

    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        vColor = color;
    }
    `),X(F,"SIMPLE_FS",`
    precision mediump float;

    varying vec4 vColor;

    uniform vec3 ambientColor;

    void main(void) {
        gl_FragColor = vec4(vColor.rgb * ambientColor, vColor.a);
    }
    `),X(F,"TEXTURE_VS",`
    uniform mat4 modelViewMatrix;
    uniform mat4 projectionMatrix;

    attribute vec3 position;
    attribute vec4 color;
    attribute vec2 uv;

    varying vec4 vColor;
    varying vec2 vUv;

    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        vColor = color;
        vUv = uv;
    }
    `),X(F,"TEXTURE_FS",`
    precision mediump float;

    varying vec4 vColor;
    varying vec2 vUv;

    uniform sampler2D tex;
    uniform vec3 ambientColor;
    uniform vec2 uvOffset;

    void main(void) {
        vec4 texColor = texture2D(tex, vUv + uvOffset);
        gl_FragColor = vec4(vColor.rgb * texColor.rgb * ambientColor, texColor.a);
    }
    `),X(F,"PARTICLE_VS",`
    attribute vec3 position;
    attribute vec4 color;
    attribute float size;
    
    uniform float pointMultiplier;
    uniform mat4 projectionMatrix;
    uniform mat4 modelViewMatrix;
    
    varying vec4 vColor;
    
    void main(void) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        gl_PointSize = size * pointMultiplier / gl_Position.w;
        vColor = color;
    }
    `),X(F,"PARTICLE_FS",`
    precision mediump float;
    
    varying vec4 vColor;

    uniform sampler2D tex;
    uniform vec3 ambientColor;
    
    void main(void) {
        vec4 texColor = texture2D(tex, gl_PointCoord);
        gl_FragColor = vec4(vColor.rgb * texColor.rgb * ambientColor * texColor.a, vColor.a);
    }
    `);var ir=class{canvas;gl;frameId=null;width;height;delta=0;fps=60;lastFrameTime;frameStart;frames;game;shaders=new Map;fonts=new Map;constructor(e){this.game=e,this.canvas=this.createCanvas(),this.canvas.width=this.width=innerWidth,this.canvas.height=this.height=innerHeight,this.gl=this.canvas.getContext("webgl")}onResume(){this.lastFrameTime=this.frameStart=performance.now(),this.frames=0,this.RAF()}createCanvas(){let e=document.createElement("canvas");return document.body.appendChild(e),e}onResize(){this.canvas.width=this.width=innerWidth,this.canvas.height=this.height=innerHeight,this.game.resize(this.width,this.height)}onDrawFrame(){let e=performance.now();this.delta=(e-this.lastFrameTime)*.001,this.lastFrameTime=e,g.input.update(),this.game.render(this.delta),e-this.frameStart>=1e3&&(this.fps=this.frames,this.frames=0,this.frameStart=e),++this.frames}RAF(){this.frameId=requestAnimationFrame(()=>{this.RAF(),this.onDrawFrame()})}compileShaders(){this.shaders.set("simple",new F(F.SIMPLE_VS,F.SIMPLE_FS)),this.shaders.set("texture",new F(F.TEXTURE_VS,F.TEXTURE_FS)),this.shaders.set("particle",new F(F.PARTICLE_VS,F.PARTICLE_FS))}generateFonts(){this.fonts.set("Consolas",new Z({fontFamily:"Consolas",fontSize:48,charRatio:.6}))}getShader(e){return this.shaders.get(e)}getFont(e){return this.fonts.get(e)}};var Ge={};U(Ge,{Camera:()=>B,Drawable:()=>G,Font:()=>Z,Mesh:()=>V,OrthographicCamera:()=>wr,ParticleSystem:()=>Rr,PerspectiveCamera:()=>gr,Shader:()=>F,ShaderInstance:()=>H,Sprite:()=>Er,TextDrawable:()=>Ar,Texture:()=>Q,meshes:()=>Kr});var Be={};U(Be,{glMatrix:()=>C,mat2:()=>Sr,mat2d:()=>Ir,mat3:()=>j,mat4:()=>_,quat:()=>K,quat2:()=>Zr,vec2:()=>k,vec3:()=>S,vec4:()=>pr});var C={};U(C,{ARRAY_TYPE:()=>P,EPSILON:()=>y,RANDOM:()=>q,equals:()=>ue,setMatrixArrayType:()=>Ke,toRadian:()=>$e});var y=1e-6,P=typeof Float32Array<"u"?Float32Array:Array,q=Math.random;function Ke(r){P=r}var Je=Math.PI/180;function $e(r){return r*Je}function ue(r,e){return Math.abs(r-e)<=y*Math.max(1,Math.abs(r),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Sr={};U(Sr,{LDU:()=>mt,add:()=>gt,adjoint:()=>ct,clone:()=>et,copy:()=>tt,create:()=>rt,determinant:()=>lt,equals:()=>yt,exactEquals:()=>dt,frob:()=>Mt,fromRotation:()=>ft,fromScaling:()=>ot,fromValues:()=>it,identity:()=>nt,invert:()=>ht,mul:()=>At,multiply:()=>ee,multiplyScalar:()=>wt,multiplyScalarAndAdd:()=>Et,rotate:()=>pt,scale:()=>xt,set:()=>at,str:()=>vt,sub:()=>Rt,subtract:()=>te,transpose:()=>st});function rt(){var r=new P(4);return P!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function et(r){var e=new P(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function tt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function nt(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r}function it(r,e,t,n){var i=new P(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function at(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function st(r,e){if(r===e){var t=e[1];r[1]=e[2],r[2]=t}else r[0]=e[0],r[1]=e[2],r[2]=e[1],r[3]=e[3];return r}function ht(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*a-i*n;return s?(s=1/s,r[0]=a*s,r[1]=-n*s,r[2]=-i*s,r[3]=t*s,r):null}function ct(r,e){var t=e[0];return r[0]=e[3],r[1]=-e[1],r[2]=-e[2],r[3]=t,r}function lt(r){return r[0]*r[3]-r[2]*r[1]}function ee(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1],l=t[2],p=t[3];return r[0]=n*h+a*c,r[1]=i*h+s*c,r[2]=n*l+a*p,r[3]=i*l+s*p,r}function pt(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c+a*h,r[1]=i*c+s*h,r[2]=n*-h+a*c,r[3]=i*-h+s*c,r}function xt(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1];return r[0]=n*h,r[1]=i*h,r[2]=a*c,r[3]=s*c,r}function ft(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=-t,r[3]=n,r}function ot(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r}function vt(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function Mt(r){return Math.hypot(r[0],r[1],r[2],r[3])}function mt(r,e,t,n){return r[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-r[2]*t[1],[r,e,t]}function gt(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function te(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function dt(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function yt(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=e[0],h=e[1],c=e[2],l=e[3];return Math.abs(t-s)<=y*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-h)<=y*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-c)<=y*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=y*Math.max(1,Math.abs(a),Math.abs(l))}function wt(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function Et(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r}var At=ee,Rt=te;var Ir={};U(Ir,{add:()=>Vt,clone:()=>Pt,copy:()=>zt,create:()=>Tt,determinant:()=>bt,equals:()=>jt,exactEquals:()=>Ht,frob:()=>Ut,fromRotation:()=>_t,fromScaling:()=>Ft,fromTranslation:()=>qt,fromValues:()=>It,identity:()=>St,invert:()=>Yt,mul:()=>kt,multiply:()=>ne,multiplyScalar:()=>Xt,multiplyScalarAndAdd:()=>Wt,rotate:()=>Ot,scale:()=>Dt,set:()=>Lt,str:()=>Ct,sub:()=>Bt,subtract:()=>ie,translate:()=>Nt});function Tt(){var r=new P(6);return P!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function Pt(r){var e=new P(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function zt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function St(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function It(r,e,t,n,i,a){var s=new P(6);return s[0]=r,s[1]=e,s[2]=t,s[3]=n,s[4]=i,s[5]=a,s}function Lt(r,e,t,n,i,a,s){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r}function Yt(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=t*a-n*i;return c?(c=1/c,r[0]=a*c,r[1]=-n*c,r[2]=-i*c,r[3]=t*c,r[4]=(i*h-a*s)*c,r[5]=(n*s-t*h)*c,r):null}function bt(r){return r[0]*r[3]-r[1]*r[2]}function ne(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=t[0],p=t[1],x=t[2],f=t[3],o=t[4],M=t[5];return r[0]=n*l+a*p,r[1]=i*l+s*p,r[2]=n*x+a*f,r[3]=i*x+s*f,r[4]=n*o+a*M+h,r[5]=i*o+s*M+c,r}function Ot(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=Math.sin(t),p=Math.cos(t);return r[0]=n*p+a*l,r[1]=i*p+s*l,r[2]=n*-l+a*p,r[3]=i*-l+s*p,r[4]=h,r[5]=c,r}function Dt(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=t[0],p=t[1];return r[0]=n*l,r[1]=i*l,r[2]=a*p,r[3]=s*p,r[4]=h,r[5]=c,r}function Nt(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=t[0],p=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=n*l+a*p+h,r[5]=i*l+s*p+c,r}function _t(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=-t,r[3]=n,r[4]=0,r[5]=0,r}function Ft(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r[4]=0,r[5]=0,r}function qt(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r}function Ct(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"}function Ut(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)}function Vt(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r}function ie(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r}function Xt(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r}function Wt(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r}function Ht(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]}function jt(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=e[0],l=e[1],p=e[2],x=e[3],f=e[4],o=e[5];return Math.abs(t-c)<=y*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-l)<=y*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-p)<=y*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-x)<=y*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-f)<=y*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(h-o)<=y*Math.max(1,Math.abs(h),Math.abs(o))}var kt=ne,Bt=ie;var j={};U(j,{add:()=>mn,adjoint:()=>en,clone:()=>Qt,copy:()=>Zt,create:()=>Lr,determinant:()=>tn,equals:()=>wn,exactEquals:()=>yn,frob:()=>Mn,fromMat2d:()=>pn,fromMat4:()=>Gt,fromQuat:()=>xn,fromRotation:()=>cn,fromScaling:()=>ln,fromTranslation:()=>hn,fromValues:()=>Kt,identity:()=>$t,invert:()=>rn,mul:()=>En,multiply:()=>ae,multiplyScalar:()=>gn,multiplyScalarAndAdd:()=>dn,normalFromMat4:()=>fn,projection:()=>on,rotate:()=>an,scale:()=>sn,set:()=>Jt,str:()=>vn,sub:()=>An,subtract:()=>se,translate:()=>nn,transpose:()=>ut});function Lr(){var r=new P(9);return P!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Gt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function Qt(r){var e=new P(9);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function Zt(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function Kt(r,e,t,n,i,a,s,h,c){var l=new P(9);return l[0]=r,l[1]=e,l[2]=t,l[3]=n,l[4]=i,l[5]=a,l[6]=s,l[7]=h,l[8]=c,l}function Jt(r,e,t,n,i,a,s,h,c,l){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=h,r[7]=c,r[8]=l,r}function $t(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function ut(r,e){if(r===e){var t=e[1],n=e[2],i=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=n,r[7]=i}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function rn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],p=e[8],x=p*s-h*l,f=-p*a+h*c,o=l*a-s*c,M=t*x+n*f+i*o;return M?(M=1/M,r[0]=x*M,r[1]=(-p*n+i*l)*M,r[2]=(h*n-i*s)*M,r[3]=f*M,r[4]=(p*t-i*c)*M,r[5]=(-h*t+i*a)*M,r[6]=o*M,r[7]=(-l*t+n*c)*M,r[8]=(s*t-n*a)*M,r):null}function en(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],p=e[8];return r[0]=s*p-h*l,r[1]=i*l-n*p,r[2]=n*h-i*s,r[3]=h*c-a*p,r[4]=t*p-i*c,r[5]=i*a-t*h,r[6]=a*l-s*c,r[7]=n*c-t*l,r[8]=t*s-n*a,r}function tn(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],s=r[5],h=r[6],c=r[7],l=r[8];return e*(l*a-s*c)+t*(-l*i+s*h)+n*(c*i-a*h)}function ae(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=e[8],f=t[0],o=t[1],M=t[2],m=t[3],v=t[4],d=t[5],A=t[6],w=t[7],E=t[8];return r[0]=f*n+o*s+M*l,r[1]=f*i+o*h+M*p,r[2]=f*a+o*c+M*x,r[3]=m*n+v*s+d*l,r[4]=m*i+v*h+d*p,r[5]=m*a+v*c+d*x,r[6]=A*n+w*s+E*l,r[7]=A*i+w*h+E*p,r[8]=A*a+w*c+E*x,r}function nn(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=e[8],f=t[0],o=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=h,r[5]=c,r[6]=f*n+o*s+l,r[7]=f*i+o*h+p,r[8]=f*a+o*c+x,r}function an(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=e[8],f=Math.sin(t),o=Math.cos(t);return r[0]=o*n+f*s,r[1]=o*i+f*h,r[2]=o*a+f*c,r[3]=o*s-f*n,r[4]=o*h-f*i,r[5]=o*c-f*a,r[6]=l,r[7]=p,r[8]=x,r}function sn(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function hn(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=e[0],r[7]=e[1],r[8]=1,r}function cn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=-t,r[4]=n,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function ln(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=e[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function pn(r,e){return r[0]=e[0],r[1]=e[1],r[2]=0,r[3]=e[2],r[4]=e[3],r[5]=0,r[6]=e[4],r[7]=e[5],r[8]=1,r}function xn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t+t,h=n+n,c=i+i,l=t*s,p=n*s,x=n*h,f=i*s,o=i*h,M=i*c,m=a*s,v=a*h,d=a*c;return r[0]=1-x-M,r[3]=p-d,r[6]=f+v,r[1]=p+d,r[4]=1-l-M,r[7]=o-m,r[2]=f-v,r[5]=o+m,r[8]=1-l-x,r}function fn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],p=e[8],x=e[9],f=e[10],o=e[11],M=e[12],m=e[13],v=e[14],d=e[15],A=t*h-n*s,w=t*c-i*s,E=t*l-a*s,T=n*c-i*h,R=n*l-a*h,O=i*l-a*c,L=p*m-x*M,Y=p*v-f*M,I=p*d-o*M,D=x*v-f*m,b=x*d-o*m,N=f*d-o*v,z=A*N-w*b+E*D+T*I-R*Y+O*L;return z?(z=1/z,r[0]=(h*N-c*b+l*D)*z,r[1]=(c*I-s*N-l*Y)*z,r[2]=(s*b-h*I+l*L)*z,r[3]=(i*b-n*N-a*D)*z,r[4]=(t*N-i*I+a*Y)*z,r[5]=(n*I-t*b-a*L)*z,r[6]=(m*O-v*R+d*T)*z,r[7]=(v*E-M*O-d*w)*z,r[8]=(M*R-m*E+d*A)*z,r):null}function on(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}function vn(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"}function Mn(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])}function mn(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r}function se(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r}function gn(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r}function dn(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r}function yn(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]}function wn(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=r[6],l=r[7],p=r[8],x=e[0],f=e[1],o=e[2],M=e[3],m=e[4],v=e[5],d=e[6],A=e[7],w=e[8];return Math.abs(t-x)<=y*Math.max(1,Math.abs(t),Math.abs(x))&&Math.abs(n-f)<=y*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-o)<=y*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(a-M)<=y*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-m)<=y*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(h-v)<=y*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-d)<=y*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(l-A)<=y*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(p-w)<=y*Math.max(1,Math.abs(p),Math.abs(w))}var En=ae,An=se;var _={};U(_,{add:()=>ii,adjoint:()=>Yn,clone:()=>Tn,copy:()=>Pn,create:()=>Rn,determinant:()=>bn,equals:()=>ci,exactEquals:()=>hi,frob:()=>ni,fromQuat:()=>Gn,fromQuat2:()=>jn,fromRotation:()=>Vn,fromRotationTranslation:()=>le,fromRotationTranslationScale:()=>kn,fromRotationTranslationScaleOrigin:()=>Bn,fromScaling:()=>Un,fromTranslation:()=>Cn,fromValues:()=>zn,fromXRotation:()=>Xn,fromYRotation:()=>Wn,fromZRotation:()=>Hn,frustum:()=>Qn,getRotation:()=>br,getScaling:()=>pe,getTranslation:()=>Yr,identity:()=>he,invert:()=>Ln,lookAt:()=>ri,mul:()=>li,multiply:()=>ce,multiplyScalar:()=>ai,multiplyScalarAndAdd:()=>si,ortho:()=>$n,orthoNO:()=>fe,orthoZO:()=>un,perspective:()=>Zn,perspectiveFromFieldOfView:()=>Jn,perspectiveNO:()=>xe,perspectiveZO:()=>Kn,rotate:()=>Nn,rotateX:()=>_n,rotateY:()=>Fn,rotateZ:()=>qn,scale:()=>Dn,set:()=>Sn,str:()=>ti,sub:()=>pi,subtract:()=>oe,targetTo:()=>ei,translate:()=>On,transpose:()=>In});function Rn(){var r=new P(16);return P!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Tn(r){var e=new P(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Pn(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function zn(r,e,t,n,i,a,s,h,c,l,p,x,f,o,M,m){var v=new P(16);return v[0]=r,v[1]=e,v[2]=t,v[3]=n,v[4]=i,v[5]=a,v[6]=s,v[7]=h,v[8]=c,v[9]=l,v[10]=p,v[11]=x,v[12]=f,v[13]=o,v[14]=M,v[15]=m,v}function Sn(r,e,t,n,i,a,s,h,c,l,p,x,f,o,M,m,v){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=h,r[7]=c,r[8]=l,r[9]=p,r[10]=x,r[11]=f,r[12]=o,r[13]=M,r[14]=m,r[15]=v,r}function he(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function In(r,e){if(r===e){var t=e[1],n=e[2],i=e[3],a=e[6],s=e[7],h=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=a,r[11]=e[14],r[12]=i,r[13]=s,r[14]=h}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function Ln(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],p=e[8],x=e[9],f=e[10],o=e[11],M=e[12],m=e[13],v=e[14],d=e[15],A=t*h-n*s,w=t*c-i*s,E=t*l-a*s,T=n*c-i*h,R=n*l-a*h,O=i*l-a*c,L=p*m-x*M,Y=p*v-f*M,I=p*d-o*M,D=x*v-f*m,b=x*d-o*m,N=f*d-o*v,z=A*N-w*b+E*D+T*I-R*Y+O*L;return z?(z=1/z,r[0]=(h*N-c*b+l*D)*z,r[1]=(i*b-n*N-a*D)*z,r[2]=(m*O-v*R+d*T)*z,r[3]=(f*R-x*O-o*T)*z,r[4]=(c*I-s*N-l*Y)*z,r[5]=(t*N-i*I+a*Y)*z,r[6]=(v*E-M*O-d*w)*z,r[7]=(p*O-f*E+o*w)*z,r[8]=(s*b-h*I+l*L)*z,r[9]=(n*I-t*b-a*L)*z,r[10]=(M*R-m*E+d*A)*z,r[11]=(x*E-p*R-o*A)*z,r[12]=(h*Y-s*D-c*L)*z,r[13]=(t*D-n*Y+i*L)*z,r[14]=(m*w-M*T-v*A)*z,r[15]=(p*T-x*w+f*A)*z,r):null}function Yn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],h=e[5],c=e[6],l=e[7],p=e[8],x=e[9],f=e[10],o=e[11],M=e[12],m=e[13],v=e[14],d=e[15];return r[0]=h*(f*d-o*v)-x*(c*d-l*v)+m*(c*o-l*f),r[1]=-(n*(f*d-o*v)-x*(i*d-a*v)+m*(i*o-a*f)),r[2]=n*(c*d-l*v)-h*(i*d-a*v)+m*(i*l-a*c),r[3]=-(n*(c*o-l*f)-h*(i*o-a*f)+x*(i*l-a*c)),r[4]=-(s*(f*d-o*v)-p*(c*d-l*v)+M*(c*o-l*f)),r[5]=t*(f*d-o*v)-p*(i*d-a*v)+M*(i*o-a*f),r[6]=-(t*(c*d-l*v)-s*(i*d-a*v)+M*(i*l-a*c)),r[7]=t*(c*o-l*f)-s*(i*o-a*f)+p*(i*l-a*c),r[8]=s*(x*d-o*m)-p*(h*d-l*m)+M*(h*o-l*x),r[9]=-(t*(x*d-o*m)-p*(n*d-a*m)+M*(n*o-a*x)),r[10]=t*(h*d-l*m)-s*(n*d-a*m)+M*(n*l-a*h),r[11]=-(t*(h*o-l*x)-s*(n*o-a*x)+p*(n*l-a*h)),r[12]=-(s*(x*v-f*m)-p*(h*v-c*m)+M*(h*f-c*x)),r[13]=t*(x*v-f*m)-p*(n*v-i*m)+M*(n*f-i*x),r[14]=-(t*(h*v-c*m)-s*(n*v-i*m)+M*(n*c-i*h)),r[15]=t*(h*f-c*x)-s*(n*f-i*x)+p*(n*c-i*h),r}function bn(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],s=r[5],h=r[6],c=r[7],l=r[8],p=r[9],x=r[10],f=r[11],o=r[12],M=r[13],m=r[14],v=r[15],d=e*s-t*a,A=e*h-n*a,w=e*c-i*a,E=t*h-n*s,T=t*c-i*s,R=n*c-i*h,O=l*M-p*o,L=l*m-x*o,Y=l*v-f*o,I=p*m-x*M,D=p*v-f*M,b=x*v-f*m;return d*b-A*D+w*I+E*Y-T*L+R*O}function ce(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=e[8],f=e[9],o=e[10],M=e[11],m=e[12],v=e[13],d=e[14],A=e[15],w=t[0],E=t[1],T=t[2],R=t[3];return r[0]=w*n+E*h+T*x+R*m,r[1]=w*i+E*c+T*f+R*v,r[2]=w*a+E*l+T*o+R*d,r[3]=w*s+E*p+T*M+R*A,w=t[4],E=t[5],T=t[6],R=t[7],r[4]=w*n+E*h+T*x+R*m,r[5]=w*i+E*c+T*f+R*v,r[6]=w*a+E*l+T*o+R*d,r[7]=w*s+E*p+T*M+R*A,w=t[8],E=t[9],T=t[10],R=t[11],r[8]=w*n+E*h+T*x+R*m,r[9]=w*i+E*c+T*f+R*v,r[10]=w*a+E*l+T*o+R*d,r[11]=w*s+E*p+T*M+R*A,w=t[12],E=t[13],T=t[14],R=t[15],r[12]=w*n+E*h+T*x+R*m,r[13]=w*i+E*c+T*f+R*v,r[14]=w*a+E*l+T*o+R*d,r[15]=w*s+E*p+T*M+R*A,r}function On(r,e,t){var n=t[0],i=t[1],a=t[2],s,h,c,l,p,x,f,o,M,m,v,d;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*a+e[12],r[13]=e[1]*n+e[5]*i+e[9]*a+e[13],r[14]=e[2]*n+e[6]*i+e[10]*a+e[14],r[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],h=e[1],c=e[2],l=e[3],p=e[4],x=e[5],f=e[6],o=e[7],M=e[8],m=e[9],v=e[10],d=e[11],r[0]=s,r[1]=h,r[2]=c,r[3]=l,r[4]=p,r[5]=x,r[6]=f,r[7]=o,r[8]=M,r[9]=m,r[10]=v,r[11]=d,r[12]=s*n+p*i+M*a+e[12],r[13]=h*n+x*i+m*a+e[13],r[14]=c*n+f*i+v*a+e[14],r[15]=l*n+o*i+d*a+e[15]),r}function Dn(r,e,t){var n=t[0],i=t[1],a=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*a,r[9]=e[9]*a,r[10]=e[10]*a,r[11]=e[11]*a,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Nn(r,e,t,n){var i=n[0],a=n[1],s=n[2],h=Math.hypot(i,a,s),c,l,p,x,f,o,M,m,v,d,A,w,E,T,R,O,L,Y,I,D,b,N,z,W;return h<y?null:(h=1/h,i*=h,a*=h,s*=h,c=Math.sin(t),l=Math.cos(t),p=1-l,x=e[0],f=e[1],o=e[2],M=e[3],m=e[4],v=e[5],d=e[6],A=e[7],w=e[8],E=e[9],T=e[10],R=e[11],O=i*i*p+l,L=a*i*p+s*c,Y=s*i*p-a*c,I=i*a*p-s*c,D=a*a*p+l,b=s*a*p+i*c,N=i*s*p+a*c,z=a*s*p-i*c,W=s*s*p+l,r[0]=x*O+m*L+w*Y,r[1]=f*O+v*L+E*Y,r[2]=o*O+d*L+T*Y,r[3]=M*O+A*L+R*Y,r[4]=x*I+m*D+w*b,r[5]=f*I+v*D+E*b,r[6]=o*I+d*D+T*b,r[7]=M*I+A*D+R*b,r[8]=x*N+m*z+w*W,r[9]=f*N+v*z+E*W,r[10]=o*N+d*z+T*W,r[11]=M*N+A*z+R*W,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function _n(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],h=e[6],c=e[7],l=e[8],p=e[9],x=e[10],f=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=a*i+l*n,r[5]=s*i+p*n,r[6]=h*i+x*n,r[7]=c*i+f*n,r[8]=l*i-a*n,r[9]=p*i-s*n,r[10]=x*i-h*n,r[11]=f*i-c*n,r}function Fn(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],h=e[2],c=e[3],l=e[8],p=e[9],x=e[10],f=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i-l*n,r[1]=s*i-p*n,r[2]=h*i-x*n,r[3]=c*i-f*n,r[8]=a*n+l*i,r[9]=s*n+p*i,r[10]=h*n+x*i,r[11]=c*n+f*i,r}function qn(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],h=e[2],c=e[3],l=e[4],p=e[5],x=e[6],f=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i+l*n,r[1]=s*i+p*n,r[2]=h*i+x*n,r[3]=c*i+f*n,r[4]=l*i-a*n,r[5]=p*i-s*n,r[6]=x*i-h*n,r[7]=f*i-c*n,r}function Cn(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Un(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Vn(r,e,t){var n=t[0],i=t[1],a=t[2],s=Math.hypot(n,i,a),h,c,l;return s<y?null:(s=1/s,n*=s,i*=s,a*=s,h=Math.sin(e),c=Math.cos(e),l=1-c,r[0]=n*n*l+c,r[1]=i*n*l+a*h,r[2]=a*n*l-i*h,r[3]=0,r[4]=n*i*l-a*h,r[5]=i*i*l+c,r[6]=a*i*l+n*h,r[7]=0,r[8]=n*a*l+i*h,r[9]=i*a*l-n*h,r[10]=a*a*l+c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function Xn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Wn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Hn(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function le(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=n+n,c=i+i,l=a+a,p=n*h,x=n*c,f=n*l,o=i*c,M=i*l,m=a*l,v=s*h,d=s*c,A=s*l;return r[0]=1-(o+m),r[1]=x+A,r[2]=f-d,r[3]=0,r[4]=x-A,r[5]=1-(p+m),r[6]=M+v,r[7]=0,r[8]=f+d,r[9]=M-v,r[10]=1-(p+o),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function jn(r,e){var t=new P(3),n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=n*n+i*i+a*a+s*s;return x>0?(t[0]=(h*s+p*n+c*a-l*i)*2/x,t[1]=(c*s+p*i+l*n-h*a)*2/x,t[2]=(l*s+p*a+h*i-c*n)*2/x):(t[0]=(h*s+p*n+c*a-l*i)*2,t[1]=(c*s+p*i+l*n-h*a)*2,t[2]=(l*s+p*a+h*i-c*n)*2),le(r,e,t),r}function Yr(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function pe(r,e){var t=e[0],n=e[1],i=e[2],a=e[4],s=e[5],h=e[6],c=e[8],l=e[9],p=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(a,s,h),r[2]=Math.hypot(c,l,p),r}function br(r,e){var t=new P(3);pe(t,e);var n=1/t[0],i=1/t[1],a=1/t[2],s=e[0]*n,h=e[1]*i,c=e[2]*a,l=e[4]*n,p=e[5]*i,x=e[6]*a,f=e[8]*n,o=e[9]*i,M=e[10]*a,m=s+p+M,v=0;return m>0?(v=Math.sqrt(m+1)*2,r[3]=.25*v,r[0]=(x-o)/v,r[1]=(f-c)/v,r[2]=(h-l)/v):s>p&&s>M?(v=Math.sqrt(1+s-p-M)*2,r[3]=(x-o)/v,r[0]=.25*v,r[1]=(h+l)/v,r[2]=(f+c)/v):p>M?(v=Math.sqrt(1+p-s-M)*2,r[3]=(f-c)/v,r[0]=(h+l)/v,r[1]=.25*v,r[2]=(x+o)/v):(v=Math.sqrt(1+M-s-p)*2,r[3]=(h-l)/v,r[0]=(f+c)/v,r[1]=(x+o)/v,r[2]=.25*v),r}function kn(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=e[3],c=i+i,l=a+a,p=s+s,x=i*c,f=i*l,o=i*p,M=a*l,m=a*p,v=s*p,d=h*c,A=h*l,w=h*p,E=n[0],T=n[1],R=n[2];return r[0]=(1-(M+v))*E,r[1]=(f+w)*E,r[2]=(o-A)*E,r[3]=0,r[4]=(f-w)*T,r[5]=(1-(x+v))*T,r[6]=(m+d)*T,r[7]=0,r[8]=(o+A)*R,r[9]=(m-d)*R,r[10]=(1-(x+M))*R,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Bn(r,e,t,n,i){var a=e[0],s=e[1],h=e[2],c=e[3],l=a+a,p=s+s,x=h+h,f=a*l,o=a*p,M=a*x,m=s*p,v=s*x,d=h*x,A=c*l,w=c*p,E=c*x,T=n[0],R=n[1],O=n[2],L=i[0],Y=i[1],I=i[2],D=(1-(m+d))*T,b=(o+E)*T,N=(M-w)*T,z=(o-E)*R,W=(1-(f+d))*R,$=(v+A)*R,u=(M+w)*O,$r=(v-A)*O,ur=(1-(f+m))*O;return r[0]=D,r[1]=b,r[2]=N,r[3]=0,r[4]=z,r[5]=W,r[6]=$,r[7]=0,r[8]=u,r[9]=$r,r[10]=ur,r[11]=0,r[12]=t[0]+L-(D*L+z*Y+u*I),r[13]=t[1]+Y-(b*L+W*Y+$r*I),r[14]=t[2]+I-(N*L+$*Y+ur*I),r[15]=1,r}function Gn(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t+t,h=n+n,c=i+i,l=t*s,p=n*s,x=n*h,f=i*s,o=i*h,M=i*c,m=a*s,v=a*h,d=a*c;return r[0]=1-x-M,r[1]=p+d,r[2]=f-v,r[3]=0,r[4]=p-d,r[5]=1-l-M,r[6]=o+m,r[7]=0,r[8]=f+v,r[9]=o-m,r[10]=1-l-x,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Qn(r,e,t,n,i,a,s){var h=1/(t-e),c=1/(i-n),l=1/(a-s);return r[0]=a*2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a*2*c,r[6]=0,r[7]=0,r[8]=(t+e)*h,r[9]=(i+n)*c,r[10]=(s+a)*l,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*a*2*l,r[15]=0,r}function xe(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=(i+n)*s,r[14]=2*i*n*s):(r[10]=-1,r[14]=-2*n),r}var Zn=xe;function Kn(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=i*s,r[14]=i*n*s):(r[10]=-1,r[14]=-n),r}function Jn(r,e,t,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),h=Math.tan(e.rightDegrees*Math.PI/180),c=2/(s+h),l=2/(i+a);return r[0]=c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=l,r[6]=0,r[7]=0,r[8]=-((s-h)*c*.5),r[9]=(i-a)*l*.5,r[10]=n/(t-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*t/(t-n),r[15]=0,r}function fe(r,e,t,n,i,a,s){var h=1/(e-t),c=1/(n-i),l=1/(a-s);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*l,r[11]=0,r[12]=(e+t)*h,r[13]=(i+n)*c,r[14]=(s+a)*l,r[15]=1,r}var $n=fe;function un(r,e,t,n,i,a,s){var h=1/(e-t),c=1/(n-i),l=1/(a-s);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=l,r[11]=0,r[12]=(e+t)*h,r[13]=(i+n)*c,r[14]=a*l,r[15]=1,r}function ri(r,e,t,n){var i,a,s,h,c,l,p,x,f,o,M=e[0],m=e[1],v=e[2],d=n[0],A=n[1],w=n[2],E=t[0],T=t[1],R=t[2];return Math.abs(M-E)<y&&Math.abs(m-T)<y&&Math.abs(v-R)<y?he(r):(p=M-E,x=m-T,f=v-R,o=1/Math.hypot(p,x,f),p*=o,x*=o,f*=o,i=A*f-w*x,a=w*p-d*f,s=d*x-A*p,o=Math.hypot(i,a,s),o?(o=1/o,i*=o,a*=o,s*=o):(i=0,a=0,s=0),h=x*s-f*a,c=f*i-p*s,l=p*a-x*i,o=Math.hypot(h,c,l),o?(o=1/o,h*=o,c*=o,l*=o):(h=0,c=0,l=0),r[0]=i,r[1]=h,r[2]=p,r[3]=0,r[4]=a,r[5]=c,r[6]=x,r[7]=0,r[8]=s,r[9]=l,r[10]=f,r[11]=0,r[12]=-(i*M+a*m+s*v),r[13]=-(h*M+c*m+l*v),r[14]=-(p*M+x*m+f*v),r[15]=1,r)}function ei(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=n[0],c=n[1],l=n[2],p=i-t[0],x=a-t[1],f=s-t[2],o=p*p+x*x+f*f;o>0&&(o=1/Math.sqrt(o),p*=o,x*=o,f*=o);var M=c*f-l*x,m=l*p-h*f,v=h*x-c*p;return o=M*M+m*m+v*v,o>0&&(o=1/Math.sqrt(o),M*=o,m*=o,v*=o),r[0]=M,r[1]=m,r[2]=v,r[3]=0,r[4]=x*v-f*m,r[5]=f*M-p*v,r[6]=p*m-x*M,r[7]=0,r[8]=p,r[9]=x,r[10]=f,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,r}function ti(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function ni(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function ii(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r}function oe(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r}function ai(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r}function si(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r[9]=e[9]+t[9]*n,r[10]=e[10]+t[10]*n,r[11]=e[11]+t[11]*n,r[12]=e[12]+t[12]*n,r[13]=e[13]+t[13]*n,r[14]=e[14]+t[14]*n,r[15]=e[15]+t[15]*n,r}function hi(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function ci(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=r[6],l=r[7],p=r[8],x=r[9],f=r[10],o=r[11],M=r[12],m=r[13],v=r[14],d=r[15],A=e[0],w=e[1],E=e[2],T=e[3],R=e[4],O=e[5],L=e[6],Y=e[7],I=e[8],D=e[9],b=e[10],N=e[11],z=e[12],W=e[13],$=e[14],u=e[15];return Math.abs(t-A)<=y*Math.max(1,Math.abs(t),Math.abs(A))&&Math.abs(n-w)<=y*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-E)<=y*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(a-T)<=y*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-R)<=y*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(h-O)<=y*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(c-L)<=y*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(l-Y)<=y*Math.max(1,Math.abs(l),Math.abs(Y))&&Math.abs(p-I)<=y*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(x-D)<=y*Math.max(1,Math.abs(x),Math.abs(D))&&Math.abs(f-b)<=y*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(o-N)<=y*Math.max(1,Math.abs(o),Math.abs(N))&&Math.abs(M-z)<=y*Math.max(1,Math.abs(M),Math.abs(z))&&Math.abs(m-W)<=y*Math.max(1,Math.abs(m),Math.abs(W))&&Math.abs(v-$)<=y*Math.max(1,Math.abs(v),Math.abs($))&&Math.abs(d-u)<=y*Math.max(1,Math.abs(d),Math.abs(u))}var li=ce,pi=oe;var K={};U(K,{add:()=>S1,calculateW:()=>g1,clone:()=>T1,conjugate:()=>E1,copy:()=>fr,create:()=>er,dot:()=>or,equals:()=>D1,exactEquals:()=>O1,exp:()=>Le,fromEuler:()=>A1,fromMat3:()=>be,fromValues:()=>P1,getAngle:()=>m1,getAxisAngle:()=>M1,identity:()=>v1,invert:()=>w1,len:()=>Y1,length:()=>vr,lerp:()=>L1,ln:()=>Ye,mul:()=>I1,multiply:()=>Ie,normalize:()=>Qr,pow:()=>d1,random:()=>y1,rotateX:()=>kr,rotateY:()=>Br,rotateZ:()=>Gr,rotationTo:()=>N1,scale:()=>Oe,set:()=>z1,setAxes:()=>F1,setAxisAngle:()=>Se,slerp:()=>xr,sqlerp:()=>_1,sqrLen:()=>b1,squaredLength:()=>Mr,str:()=>R1});var S={};U(S,{add:()=>vi,angle:()=>Ni,bezier:()=>zi,ceil:()=>Mi,clone:()=>xi,copy:()=>fi,create:()=>ar,cross:()=>rr,dist:()=>Wi,distance:()=>de,div:()=>Xi,divide:()=>ge,dot:()=>hr,equals:()=>Ci,exactEquals:()=>qi,floor:()=>mi,forEach:()=>ki,fromValues:()=>sr,hermite:()=>Pi,inverse:()=>Ri,len:()=>Dr,length:()=>ve,lerp:()=>Ti,max:()=>di,min:()=>gi,mul:()=>Vi,multiply:()=>me,negate:()=>Ai,normalize:()=>Or,random:()=>Si,rotateX:()=>bi,rotateY:()=>Oi,rotateZ:()=>Di,round:()=>yi,scale:()=>wi,scaleAndAdd:()=>Ei,set:()=>oi,sqrDist:()=>Hi,sqrLen:()=>ji,squaredDistance:()=>ye,squaredLength:()=>we,str:()=>Fi,sub:()=>Ui,subtract:()=>Me,transformMat3:()=>Li,transformMat4:()=>Ii,transformQuat:()=>Yi,zero:()=>_i});function ar(){var r=new P(3);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function xi(r){var e=new P(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function ve(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function sr(r,e,t){var n=new P(3);return n[0]=r,n[1]=e,n[2]=t,n}function fi(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function oi(r,e,t,n){return r[0]=e,r[1]=t,r[2]=n,r}function vi(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function Me(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function me(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function ge(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r}function Mi(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r}function mi(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r}function gi(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function di(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function yi(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r}function wi(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function Ei(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r}function de(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return Math.hypot(t,n,i)}function ye(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return t*t+n*n+i*i}function we(r){var e=r[0],t=r[1],n=r[2];return e*e+t*t+n*n}function Ai(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function Ri(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r}function Or(r,e){var t=e[0],n=e[1],i=e[2],a=t*t+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r}function hr(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function rr(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[0],h=t[1],c=t[2];return r[0]=i*c-a*h,r[1]=a*s-n*c,r[2]=n*h-i*s,r}function Ti(r,e,t,n){var i=e[0],a=e[1],s=e[2];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=s+n*(t[2]-s),r}function Pi(r,e,t,n,i,a){var s=a*a,h=s*(2*a-3)+1,c=s*(a-2)+a,l=s*(a-1),p=s*(3-2*a);return r[0]=e[0]*h+t[0]*c+n[0]*l+i[0]*p,r[1]=e[1]*h+t[1]*c+n[1]*l+i[1]*p,r[2]=e[2]*h+t[2]*c+n[2]*l+i[2]*p,r}function zi(r,e,t,n,i,a){var s=1-a,h=s*s,c=a*a,l=h*s,p=3*a*h,x=3*c*s,f=c*a;return r[0]=e[0]*l+t[0]*p+n[0]*x+i[0]*f,r[1]=e[1]*l+t[1]*p+n[1]*x+i[1]*f,r[2]=e[2]*l+t[2]*p+n[2]*x+i[2]*f,r}function Si(r,e){e=e||1;var t=q()*2*Math.PI,n=q()*2-1,i=Math.sqrt(1-n*n)*e;return r[0]=Math.cos(t)*i,r[1]=Math.sin(t)*i,r[2]=n*e,r}function Ii(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[3]*n+t[7]*i+t[11]*a+t[15];return s=s||1,r[0]=(t[0]*n+t[4]*i+t[8]*a+t[12])/s,r[1]=(t[1]*n+t[5]*i+t[9]*a+t[13])/s,r[2]=(t[2]*n+t[6]*i+t[10]*a+t[14])/s,r}function Li(r,e,t){var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0]+i*t[3]+a*t[6],r[1]=n*t[1]+i*t[4]+a*t[7],r[2]=n*t[2]+i*t[5]+a*t[8],r}function Yi(r,e,t){var n=t[0],i=t[1],a=t[2],s=t[3],h=e[0],c=e[1],l=e[2],p=i*l-a*c,x=a*h-n*l,f=n*c-i*h,o=i*f-a*x,M=a*p-n*f,m=n*x-i*p,v=s*2;return p*=v,x*=v,f*=v,o*=2,M*=2,m*=2,r[0]=h+p+o,r[1]=c+x+M,r[2]=l+f+m,r}function bi(r,e,t,n){var i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r}function Oi(r,e,t,n){var i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r}function Di(r,e,t,n){var i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r}function Ni(r,e){var t=r[0],n=r[1],i=r[2],a=e[0],s=e[1],h=e[2],c=Math.sqrt(t*t+n*n+i*i),l=Math.sqrt(a*a+s*s+h*h),p=c*l,x=p&&hr(r,e)/p;return Math.acos(Math.min(Math.max(x,-1),1))}function _i(r){return r[0]=0,r[1]=0,r[2]=0,r}function Fi(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function qi(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]}function Ci(r,e){var t=r[0],n=r[1],i=r[2],a=e[0],s=e[1],h=e[2];return Math.abs(t-a)<=y*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-s)<=y*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-h)<=y*Math.max(1,Math.abs(i),Math.abs(h))}var Ui=Me,Vi=me,Xi=ge,Wi=de,Hi=ye,Dr=ve,ji=we,ki=function(){var r=ar();return function(e,t,n,i,a,s){var h,c;for(t||(t=3),n||(n=0),i?c=Math.min(i*t+n,e.length):c=e.length,h=n;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],a(r,r,s),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2];return e}}();var pr={};U(pr,{add:()=>Cr,ceil:()=>Bi,clone:()=>Nr,copy:()=>Fr,create:()=>Ee,cross:()=>r1,dist:()=>l1,distance:()=>Pe,div:()=>c1,divide:()=>Te,dot:()=>Xr,equals:()=>jr,exactEquals:()=>Hr,floor:()=>Gi,forEach:()=>o1,fromValues:()=>_r,inverse:()=>ui,len:()=>x1,length:()=>cr,lerp:()=>Wr,max:()=>Zi,min:()=>Qi,mul:()=>h1,multiply:()=>Re,negate:()=>$i,normalize:()=>Vr,random:()=>e1,round:()=>Ki,scale:()=>Ur,scaleAndAdd:()=>Ji,set:()=>qr,sqrDist:()=>p1,sqrLen:()=>f1,squaredDistance:()=>ze,squaredLength:()=>lr,str:()=>a1,sub:()=>s1,subtract:()=>Ae,transformMat4:()=>t1,transformQuat:()=>n1,zero:()=>i1});function Ee(){var r=new P(4);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function Nr(r){var e=new P(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function _r(r,e,t,n){var i=new P(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function Fr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function qr(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function Cr(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function Ae(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function Re(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r[3]=e[3]*t[3],r}function Te(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r[3]=e[3]/t[3],r}function Bi(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r[3]=Math.ceil(e[3]),r}function Gi(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r[3]=Math.floor(e[3]),r}function Qi(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.min(e[3],t[3]),r}function Zi(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r}function Ki(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r[3]=Math.round(e[3]),r}function Ur(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function Ji(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r}function Pe(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2],a=e[3]-r[3];return Math.hypot(t,n,i,a)}function ze(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2],a=e[3]-r[3];return t*t+n*n+i*i+a*a}function cr(r){var e=r[0],t=r[1],n=r[2],i=r[3];return Math.hypot(e,t,n,i)}function lr(r){var e=r[0],t=r[1],n=r[2],i=r[3];return e*e+t*t+n*n+i*i}function $i(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r}function ui(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r[3]=1/e[3],r}function Vr(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=t*s,r[1]=n*s,r[2]=i*s,r[3]=a*s,r}function Xr(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function r1(r,e,t,n){var i=t[0]*n[1]-t[1]*n[0],a=t[0]*n[2]-t[2]*n[0],s=t[0]*n[3]-t[3]*n[0],h=t[1]*n[2]-t[2]*n[1],c=t[1]*n[3]-t[3]*n[1],l=t[2]*n[3]-t[3]*n[2],p=e[0],x=e[1],f=e[2],o=e[3];return r[0]=x*l-f*c+o*h,r[1]=-(p*l)+f*s-o*a,r[2]=p*c-x*s+o*i,r[3]=-(p*h)+x*a-f*i,r}function Wr(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=e[3];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=s+n*(t[2]-s),r[3]=h+n*(t[3]-h),r}function e1(r,e){e=e||1;var t,n,i,a,s,h;do t=q()*2-1,n=q()*2-1,s=t*t+n*n;while(s>=1);do i=q()*2-1,a=q()*2-1,h=i*i+a*a;while(h>=1);var c=Math.sqrt((1-s)/h);return r[0]=e*t,r[1]=e*n,r[2]=e*i*c,r[3]=e*a*c,r}function t1(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*a+t[12]*s,r[1]=t[1]*n+t[5]*i+t[9]*a+t[13]*s,r[2]=t[2]*n+t[6]*i+t[10]*a+t[14]*s,r[3]=t[3]*n+t[7]*i+t[11]*a+t[15]*s,r}function n1(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[0],h=t[1],c=t[2],l=t[3],p=l*n+h*a-c*i,x=l*i+c*n-s*a,f=l*a+s*i-h*n,o=-s*n-h*i-c*a;return r[0]=p*l+o*-s+x*-c-f*-h,r[1]=x*l+o*-h+f*-s-p*-c,r[2]=f*l+o*-c+p*-h-x*-s,r[3]=e[3],r}function i1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}function a1(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function Hr(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function jr(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=e[0],h=e[1],c=e[2],l=e[3];return Math.abs(t-s)<=y*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-h)<=y*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-c)<=y*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=y*Math.max(1,Math.abs(a),Math.abs(l))}var s1=Ae,h1=Re,c1=Te,l1=Pe,p1=ze,x1=cr,f1=lr,o1=function(){var r=Ee();return function(e,t,n,i,a,s){var h,c;for(t||(t=4),n||(n=0),i?c=Math.min(i*t+n,e.length):c=e.length,h=n;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],r[3]=e[h+3],a(r,r,s),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2],e[h+3]=r[3];return e}}();function er(){var r=new P(4);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function v1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function Se(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function M1(r,e){var t=Math.acos(e[3])*2,n=Math.sin(t/2);return n>y?(r[0]=e[0]/n,r[1]=e[1]/n,r[2]=e[2]/n):(r[0]=1,r[1]=0,r[2]=0),t}function m1(r,e){var t=or(r,e);return Math.acos(2*t*t-1)}function Ie(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1],l=t[2],p=t[3];return r[0]=n*p+s*h+i*l-a*c,r[1]=i*p+s*c+a*h-n*l,r[2]=a*p+s*l+n*c-i*h,r[3]=s*p-n*h-i*c-a*l,r}function kr(r,e,t){t*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c+s*h,r[1]=i*c+a*h,r[2]=a*c-i*h,r[3]=s*c-n*h,r}function Br(r,e,t){t*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c-a*h,r[1]=i*c+s*h,r[2]=a*c+n*h,r[3]=s*c-i*h,r}function Gr(r,e,t){t*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],h=Math.sin(t),c=Math.cos(t);return r[0]=n*c+i*h,r[1]=i*c-n*h,r[2]=a*c+s*h,r[3]=s*c-a*h,r}function g1(r,e){var t=e[0],n=e[1],i=e[2];return r[0]=t,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-t*t-n*n-i*i)),r}function Le(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=Math.sqrt(t*t+n*n+i*i),h=Math.exp(a),c=s>0?h*Math.sin(s)/s:0;return r[0]=t*c,r[1]=n*c,r[2]=i*c,r[3]=h*Math.cos(s),r}function Ye(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=Math.sqrt(t*t+n*n+i*i),h=s>0?Math.atan2(s,a)/s:0;return r[0]=t*h,r[1]=n*h,r[2]=i*h,r[3]=.5*Math.log(t*t+n*n+i*i+a*a),r}function d1(r,e,t){return Ye(r,e),Oe(r,r,t),Le(r,r),r}function xr(r,e,t,n){var i=e[0],a=e[1],s=e[2],h=e[3],c=t[0],l=t[1],p=t[2],x=t[3],f,o,M,m,v;return o=i*c+a*l+s*p+h*x,o<0&&(o=-o,c=-c,l=-l,p=-p,x=-x),1-o>y?(f=Math.acos(o),M=Math.sin(f),m=Math.sin((1-n)*f)/M,v=Math.sin(n*f)/M):(m=1-n,v=n),r[0]=m*i+v*c,r[1]=m*a+v*l,r[2]=m*s+v*p,r[3]=m*h+v*x,r}function y1(r){var e=q(),t=q(),n=q(),i=Math.sqrt(1-e),a=Math.sqrt(e);return r[0]=i*Math.sin(2*Math.PI*t),r[1]=i*Math.cos(2*Math.PI*t),r[2]=a*Math.sin(2*Math.PI*n),r[3]=a*Math.cos(2*Math.PI*n),r}function w1(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a,h=s?1/s:0;return r[0]=-t*h,r[1]=-n*h,r[2]=-i*h,r[3]=a*h,r}function E1(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function be(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[s*3+s]+1),r[i]=.5*n,n=.5/n,r[3]=(e[a*3+s]-e[s*3+a])*n,r[a]=(e[a*3+i]+e[i*3+a])*n,r[s]=(e[s*3+i]+e[i*3+s])*n}return r}function A1(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var a=Math.sin(e),s=Math.cos(e),h=Math.sin(t),c=Math.cos(t),l=Math.sin(n),p=Math.cos(n);return r[0]=a*c*p-s*h*l,r[1]=s*h*p+a*c*l,r[2]=s*c*l-a*h*p,r[3]=s*c*p+a*h*l,r}function R1(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}var T1=Nr,P1=_r,fr=Fr,z1=qr,S1=Cr,I1=Ie,Oe=Ur,or=Xr,L1=Wr,vr=cr,Y1=vr,Mr=lr,b1=Mr,Qr=Vr,O1=Hr,D1=jr,N1=function(){var r=ar(),e=sr(1,0,0),t=sr(0,1,0);return function(n,i,a){var s=hr(i,a);return s<-.999999?(rr(r,e,i),Dr(r)<1e-6&&rr(r,t,i),Or(r,r),Se(n,r,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(rr(r,i,a),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+s,Qr(n,n))}}(),_1=function(){var r=er(),e=er();return function(t,n,i,a,s,h){return xr(r,n,s,h),xr(e,i,a,h),xr(t,r,e,2*h*(1-h)),t}}(),F1=function(){var r=Lr();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],Qr(e,be(e,r))}}();var Zr={};U(Zr,{add:()=>ia,clone:()=>C1,conjugate:()=>la,copy:()=>Ne,create:()=>q1,dot:()=>Fe,equals:()=>Ma,exactEquals:()=>va,fromMat4:()=>H1,fromRotation:()=>W1,fromRotationTranslation:()=>De,fromRotationTranslationValues:()=>V1,fromTranslation:()=>X1,fromValues:()=>U1,getDual:()=>G1,getReal:()=>B1,getTranslation:()=>K1,identity:()=>j1,invert:()=>ca,len:()=>pa,length:()=>qe,lerp:()=>ha,mul:()=>aa,multiply:()=>_e,normalize:()=>fa,rotateAroundAxis:()=>na,rotateByQuatAppend:()=>ea,rotateByQuatPrepend:()=>ta,rotateX:()=>$1,rotateY:()=>u1,rotateZ:()=>ra,scale:()=>sa,set:()=>k1,setDual:()=>Z1,setReal:()=>Q1,sqrLen:()=>xa,squaredLength:()=>mr,str:()=>oa,translate:()=>J1});function q1(){var r=new P(8);return P!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function C1(r){var e=new P(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function U1(r,e,t,n,i,a,s,h){var c=new P(8);return c[0]=r,c[1]=e,c[2]=t,c[3]=n,c[4]=i,c[5]=a,c[6]=s,c[7]=h,c}function V1(r,e,t,n,i,a,s){var h=new P(8);h[0]=r,h[1]=e,h[2]=t,h[3]=n;var c=i*.5,l=a*.5,p=s*.5;return h[4]=c*n+l*t-p*e,h[5]=l*n+p*r-c*t,h[6]=p*n+c*e-l*r,h[7]=-c*r-l*e-p*t,h}function De(r,e,t){var n=t[0]*.5,i=t[1]*.5,a=t[2]*.5,s=e[0],h=e[1],c=e[2],l=e[3];return r[0]=s,r[1]=h,r[2]=c,r[3]=l,r[4]=n*l+i*c-a*h,r[5]=i*l+a*s-n*c,r[6]=a*l+n*h-i*s,r[7]=-n*s-i*h-a*c,r}function X1(r,e){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0]*.5,r[5]=e[1]*.5,r[6]=e[2]*.5,r[7]=0,r}function W1(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function H1(r,e){var t=er();br(t,e);var n=new P(3);return Yr(n,e),De(r,t,n),r}function Ne(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function j1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function k1(r,e,t,n,i,a,s,h,c){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=h,r[7]=c,r}var B1=fr;function G1(r,e){return r[0]=e[4],r[1]=e[5],r[2]=e[6],r[3]=e[7],r}var Q1=fr;function Z1(r,e){return r[4]=e[0],r[5]=e[1],r[6]=e[2],r[7]=e[3],r}function K1(r,e){var t=e[4],n=e[5],i=e[6],a=e[7],s=-e[0],h=-e[1],c=-e[2],l=e[3];return r[0]=(t*l+a*s+n*c-i*h)*2,r[1]=(n*l+a*h+i*s-t*c)*2,r[2]=(i*l+a*c+t*h-n*s)*2,r}function J1(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0]*.5,c=t[1]*.5,l=t[2]*.5,p=e[4],x=e[5],f=e[6],o=e[7];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=s*h+i*l-a*c+p,r[5]=s*c+a*h-n*l+x,r[6]=s*l+n*c-i*h+f,r[7]=-n*h-i*c-a*l+o,r}function $1(r,e,t){var n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=h*s+p*n+c*a-l*i,f=c*s+p*i+l*n-h*a,o=l*s+p*a+h*i-c*n,M=p*s-h*n-c*i-l*a;return kr(r,e,t),n=r[0],i=r[1],a=r[2],s=r[3],r[4]=x*s+M*n+f*a-o*i,r[5]=f*s+M*i+o*n-x*a,r[6]=o*s+M*a+x*i-f*n,r[7]=M*s-x*n-f*i-o*a,r}function u1(r,e,t){var n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=h*s+p*n+c*a-l*i,f=c*s+p*i+l*n-h*a,o=l*s+p*a+h*i-c*n,M=p*s-h*n-c*i-l*a;return Br(r,e,t),n=r[0],i=r[1],a=r[2],s=r[3],r[4]=x*s+M*n+f*a-o*i,r[5]=f*s+M*i+o*n-x*a,r[6]=o*s+M*a+x*i-f*n,r[7]=M*s-x*n-f*i-o*a,r}function ra(r,e,t){var n=-e[0],i=-e[1],a=-e[2],s=e[3],h=e[4],c=e[5],l=e[6],p=e[7],x=h*s+p*n+c*a-l*i,f=c*s+p*i+l*n-h*a,o=l*s+p*a+h*i-c*n,M=p*s-h*n-c*i-l*a;return Gr(r,e,t),n=r[0],i=r[1],a=r[2],s=r[3],r[4]=x*s+M*n+f*a-o*i,r[5]=f*s+M*i+o*n-x*a,r[6]=o*s+M*a+x*i-f*n,r[7]=M*s-x*n-f*i-o*a,r}function ea(r,e,t){var n=t[0],i=t[1],a=t[2],s=t[3],h=e[0],c=e[1],l=e[2],p=e[3];return r[0]=h*s+p*n+c*a-l*i,r[1]=c*s+p*i+l*n-h*a,r[2]=l*s+p*a+h*i-c*n,r[3]=p*s-h*n-c*i-l*a,h=e[4],c=e[5],l=e[6],p=e[7],r[4]=h*s+p*n+c*a-l*i,r[5]=c*s+p*i+l*n-h*a,r[6]=l*s+p*a+h*i-c*n,r[7]=p*s-h*n-c*i-l*a,r}function ta(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[0],c=t[1],l=t[2],p=t[3];return r[0]=n*p+s*h+i*l-a*c,r[1]=i*p+s*c+a*h-n*l,r[2]=a*p+s*l+n*c-i*h,r[3]=s*p-n*h-i*c-a*l,h=t[4],c=t[5],l=t[6],p=t[7],r[4]=n*p+s*h+i*l-a*c,r[5]=i*p+s*c+a*h-n*l,r[6]=a*p+s*l+n*c-i*h,r[7]=s*p-n*h-i*c-a*l,r}function na(r,e,t,n){if(Math.abs(n)<y)return Ne(r,e);var i=Math.hypot(t[0],t[1],t[2]);n=n*.5;var a=Math.sin(n),s=a*t[0]/i,h=a*t[1]/i,c=a*t[2]/i,l=Math.cos(n),p=e[0],x=e[1],f=e[2],o=e[3];r[0]=p*l+o*s+x*c-f*h,r[1]=x*l+o*h+f*s-p*c,r[2]=f*l+o*c+p*h-x*s,r[3]=o*l-p*s-x*h-f*c;var M=e[4],m=e[5],v=e[6],d=e[7];return r[4]=M*l+d*s+m*c-v*h,r[5]=m*l+d*h+v*s-M*c,r[6]=v*l+d*c+M*h-m*s,r[7]=d*l-M*s-m*h-v*c,r}function ia(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r}function _e(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],h=t[4],c=t[5],l=t[6],p=t[7],x=e[4],f=e[5],o=e[6],M=e[7],m=t[0],v=t[1],d=t[2],A=t[3];return r[0]=n*A+s*m+i*d-a*v,r[1]=i*A+s*v+a*m-n*d,r[2]=a*A+s*d+n*v-i*m,r[3]=s*A-n*m-i*v-a*d,r[4]=n*p+s*h+i*l-a*c+x*A+M*m+f*d-o*v,r[5]=i*p+s*c+a*h-n*l+f*A+M*v+o*m-x*d,r[6]=a*p+s*l+n*c-i*h+o*A+M*d+x*v-f*m,r[7]=s*p-n*h-i*c-a*l+M*A-x*m-f*v-o*d,r}var aa=_e;function sa(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r}var Fe=or;function ha(r,e,t,n){var i=1-n;return Fe(e,t)<0&&(n=-n),r[0]=e[0]*i+t[0]*n,r[1]=e[1]*i+t[1]*n,r[2]=e[2]*i+t[2]*n,r[3]=e[3]*i+t[3]*n,r[4]=e[4]*i+t[4]*n,r[5]=e[5]*i+t[5]*n,r[6]=e[6]*i+t[6]*n,r[7]=e[7]*i+t[7]*n,r}function ca(r,e){var t=mr(e);return r[0]=-e[0]/t,r[1]=-e[1]/t,r[2]=-e[2]/t,r[3]=e[3]/t,r[4]=-e[4]/t,r[5]=-e[5]/t,r[6]=-e[6]/t,r[7]=e[7]/t,r}function la(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=e[7],r}var qe=vr,pa=qe,mr=Mr,xa=mr;function fa(r,e){var t=mr(e);if(t>0){t=Math.sqrt(t);var n=e[0]/t,i=e[1]/t,a=e[2]/t,s=e[3]/t,h=e[4],c=e[5],l=e[6],p=e[7],x=n*h+i*c+a*l+s*p;r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=(h-n*x)/t,r[5]=(c-i*x)/t,r[6]=(l-a*x)/t,r[7]=(p-s*x)/t}return r}function oa(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"}function va(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]}function Ma(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],h=r[5],c=r[6],l=r[7],p=e[0],x=e[1],f=e[2],o=e[3],M=e[4],m=e[5],v=e[6],d=e[7];return Math.abs(t-p)<=y*Math.max(1,Math.abs(t),Math.abs(p))&&Math.abs(n-x)<=y*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-f)<=y*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-o)<=y*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(s-M)<=y*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(h-m)<=y*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(c-v)<=y*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(l-d)<=y*Math.max(1,Math.abs(l),Math.abs(d))}var k={};U(k,{add:()=>wa,angle:()=>Va,ceil:()=>Ea,clone:()=>ma,copy:()=>da,create:()=>Ce,cross:()=>Oa,dist:()=>Za,distance:()=>We,div:()=>Qa,divide:()=>Xe,dot:()=>ba,equals:()=>ja,exactEquals:()=>Ha,floor:()=>Aa,forEach:()=>$a,fromValues:()=>ga,inverse:()=>La,len:()=>ka,length:()=>je,lerp:()=>Da,max:()=>Ta,min:()=>Ra,mul:()=>Ga,multiply:()=>Ve,negate:()=>Ia,normalize:()=>Ya,random:()=>Na,rotate:()=>Ua,round:()=>Pa,scale:()=>za,scaleAndAdd:()=>Sa,set:()=>ya,sqrDist:()=>Ka,sqrLen:()=>Ja,squaredDistance:()=>He,squaredLength:()=>ke,str:()=>Wa,sub:()=>Ba,subtract:()=>Ue,transformMat2:()=>_a,transformMat2d:()=>Fa,transformMat3:()=>qa,transformMat4:()=>Ca,zero:()=>Xa});function Ce(){var r=new P(2);return P!=Float32Array&&(r[0]=0,r[1]=0),r}function ma(r){var e=new P(2);return e[0]=r[0],e[1]=r[1],e}function ga(r,e){var t=new P(2);return t[0]=r,t[1]=e,t}function da(r,e){return r[0]=e[0],r[1]=e[1],r}function ya(r,e,t){return r[0]=e,r[1]=t,r}function wa(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function Ue(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function Ve(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r}function Xe(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r}function Ea(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}function Aa(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}function Ra(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r}function Ta(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r}function Pa(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}function za(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r}function Sa(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r}function We(r,e){var t=e[0]-r[0],n=e[1]-r[1];return Math.hypot(t,n)}function He(r,e){var t=e[0]-r[0],n=e[1]-r[1];return t*t+n*n}function je(r){var e=r[0],t=r[1];return Math.hypot(e,t)}function ke(r){var e=r[0],t=r[1];return e*e+t*t}function Ia(r,e){return r[0]=-e[0],r[1]=-e[1],r}function La(r,e){return r[0]=1/e[0],r[1]=1/e[1],r}function Ya(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r}function ba(r,e){return r[0]*e[0]+r[1]*e[1]}function Oa(r,e,t){var n=e[0]*t[1]-e[1]*t[0];return r[0]=r[1]=0,r[2]=n,r}function Da(r,e,t,n){var i=e[0],a=e[1];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r}function Na(r,e){e=e||1;var t=q()*2*Math.PI;return r[0]=Math.cos(t)*e,r[1]=Math.sin(t)*e,r}function _a(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r}function Fa(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i+t[4],r[1]=t[1]*n+t[3]*i+t[5],r}function qa(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[3]*i+t[6],r[1]=t[1]*n+t[4]*i+t[7],r}function Ca(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[4]*i+t[12],r[1]=t[1]*n+t[5]*i+t[13],r}function Ua(r,e,t,n){var i=e[0]-t[0],a=e[1]-t[1],s=Math.sin(n),h=Math.cos(n);return r[0]=i*h-a*s+t[0],r[1]=i*s+a*h+t[1],r}function Va(r,e){var t=r[0],n=r[1],i=e[0],a=e[1],s=Math.sqrt(t*t+n*n)*Math.sqrt(i*i+a*a),h=s&&(t*i+n*a)/s;return Math.acos(Math.min(Math.max(h,-1),1))}function Xa(r){return r[0]=0,r[1]=0,r}function Wa(r){return"vec2("+r[0]+", "+r[1]+")"}function Ha(r,e){return r[0]===e[0]&&r[1]===e[1]}function ja(r,e){var t=r[0],n=r[1],i=e[0],a=e[1];return Math.abs(t-i)<=y*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(n-a)<=y*Math.max(1,Math.abs(n),Math.abs(a))}var ka=je,Ba=Ue,Ga=Ve,Qa=Xe,Za=We,Ka=He,Ja=ke,$a=function(){var r=Ce();return function(e,t,n,i,a,s){var h,c;for(t||(t=2),n||(n=0),i?c=Math.min(i*t+n,e.length):c=e.length,h=n;h<c;h+=t)r[0]=e[h],r[1]=e[h+1],a(r,r,s),e[h]=r[0],e[h+1]=r[1];return e}}();var B=class{position=S.fromValues(0,0,-1);direction=S.fromValues(0,0,-1);up=S.fromValues(0,1,0);projectionMatrix=_.create();viewMatrix=_.create();cameraMatrix=_.create();viewportWidth=0;viewportHeight=0;near=1;far=100;tpmVec=S.create();constructor(){}lookAt(...e){if(e.length==1)S.copy(this.tpmVec,e[0]);else if(e.length==3)S.set(this.tpmVec,...e);else throw new Error("required 1 or 3 arguments");S.sub(this.tpmVec,this.tpmVec,this.position),S.normalize(this.tpmVec,this.tpmVec);let t=S.dot(this.tpmVec,this.up);C.equals(t,1)?S.negate(this.up,this.direction):C.equals(t,-1)&&S.copy(this.up,this.direction),S.copy(this.direction,this.tpmVec),S.cross(this.up,this.getRight(),this.direction),S.normalize(this.up,this.up)}getRight(){return S.cross(this.tpmVec,this.direction,this.up)}updateConstants(e){_.lookAt(this.viewMatrix,this.position,S.add(this.tpmVec,this.position,this.direction),this.up),_.invert(this.cameraMatrix,this.viewMatrix),e.projectionMatrix=this.projectionMatrix,e.viewMatrix=this.viewMatrix,e.cameraMatrix=this.cameraMatrix,e.cameraPosition=this.position}};var V=class{buffers=new Map;vertexCount=0;options;constructor(e={}){this.options=e,this.onInit()}onInit(){}bufferData(e,t,n){let i=g.gl.createBuffer();n=="index"?(g.gl.bindBuffer(g.gl.ELEMENT_ARRAY_BUFFER,i),g.gl.bufferData(g.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),g.gl.STATIC_DRAW),this.vertexCount=e.length):(g.gl.bindBuffer(g.gl.ARRAY_BUFFER,i),g.gl.bufferData(g.gl.ARRAY_BUFFER,new Float32Array(e),g.gl.STATIC_DRAW)),this.buffers.has(n)&&g.gl.deleteBuffer(this.buffers.get(n).buffer),this.buffers.set(n,{size:t,data:e,buffer:i})}bind(e){this.buffers.forEach((t,n)=>{let i=e.shaderData.attribs[n];i!=-1&&(n=="index"?g.gl.bindBuffer(g.gl.ELEMENT_ARRAY_BUFFER,t.buffer):(g.gl.bindBuffer(g.gl.ARRAY_BUFFER,t.buffer),g.gl.vertexAttribPointer(i,t.size,g.gl.FLOAT,!1,0,0),g.gl.enableVertexAttribArray(i)))})}draw(){g.gl.drawElements(g.gl.TRIANGLES,this.vertexCount,g.gl.UNSIGNED_SHORT,0)}};var H=class{shaderData;uniforms=new Map;constructor(e){this.shaderData=e,this.setUniform("uvOffset",[0,0])}setUniform(e,t){this.uniforms.set(e,t)}activate(){this.shaderData.activate()}bind(e){for(let t of this.shaderData.uniforms){let n=e[t.name];if(this.uniforms.has(t.name)&&(n=this.uniforms.get(t.name)),n&&t.location){let i=t.type,a=t.location;switch(i){case"mat4":g.gl.uniformMatrix4fv(a,!1,n);break;case"mat3":g.gl.uniformMatrix3fv(a,!1,val);break;case"vec4":g.gl.uniform4fv(a,n);break;case"vec3":g.gl.uniform3fv(a,n);break;case"vec2":g.gl.uniform2fv(a,n);break;case"float":g.gl.uniform1f(a,n);break}}}}};var G=class{mesh;shader;texture;position=S.create();rotation=K.create();scale=S.fromValues(1,1,1);parent=null;constructor(e,t,n){this.mesh=e,this.shader=t,this.texture=n}draw(e){this.shader.activate(),this.texture&&this.texture.bind();let t=_.create();_.fromRotationTranslationScale(t,this.rotation,this.position,this.scale);let n=e.viewMatrix,i=_.create();_.multiply(i,n,t);let a=j.create();j.fromMat4(a,t),j.invert(a,a),j.transpose(a,a),this.shader.setUniform("modelViewMatrix",i),this.shader.setUniform("modelMatrix",t),this.shader.setUniform("normalMatrix",a),this.shader.bind(e),this.mesh.bind(this.shader),this.mesh.draw()}};var gr=class extends B{fov;constructor(e,t,n,i,a){super(),this.fov=e,this.viewportWidth=t,this.viewportHeight=n,this.near=i,this.far=a,this.updateProjection()}updateProjection(){let e=this.viewportWidth/this.viewportHeight;_.perspective(this.projectionMatrix,this.fov/180*Math.PI,e,this.near,this.far)}};var Kr={};U(Kr,{Cube:()=>dr,Plane:()=>yr,Quad:()=>J});var dr=class extends V{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.height?this.options.height/2:.5,n=this.options.depth?this.options.depth/2:.5,i=[-e,t,n,e,t,n,e,-t,n,-e,-t,n,-e,t,-n,e,t,-n,e,-t,-n,-e,-t,-n,-e,t,-n,e,t,-n,e,t,n,-e,t,n,-e,-t,n,e,-t,n,e,-t,-n,-e,-t,-n,e,t,n,e,t,-n,e,-t,-n,e,-t,n,-e,t,-n,-e,t,n,-e,-t,n,-e,-t,-n],a=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],s="single";this.options.textureFaces!==void 0&&(s=this.options.textureFaces);let h=[];if(s=="single")for(let x=0;x<6;++x)h.push(0,0,1,0,1,1,0,1);else if(s=="multiple"){let o=(M,m)=>{h.push(M*.25,m*.5,.25*(M+1),m*.5,.25*(M+1),.5*(m+1),M*.25,.5*(m+1))};o(1,0),o(3,0),o(0,1),o(1,1),o(2,0),o(0,0)}else throw new Error("options.textureFaces valid values are single or multiple");let c=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],l=[];if(this.options.colors===void 0)for(let x=0;x<24;++x)l.push(1);else if(this.options.colors.length==1){let x=this.options.colors[0];for(let f=0;f<24;++f)l.push(x[f%4])}else if(this.options.colors.length==6)for(let x=0;x<6;++x){let f=this.options.colors[x];for(let o=0;o<4;++o)l.push(f[o])}else throw new Error("options.colors requires 1 or 6 elements");let p=[];for(let x=0;x<6;++x)for(let f=0;f<4;++f)for(let o=0;o<4;++o)p.push(l[x*4+o]);this.bufferData(i,3,"positions"),this.bufferData(a,3,"normals"),this.bufferData(p,4,"colors"),this.bufferData(h,2,"uvs"),this.bufferData(c,0,"index")}};var yr=class extends V{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.depth?this.options.depth/2:.5,n=this.options.widthSegments||1,i=this.options.depthSegments||1,a=this.options.heightMap||[...new Array(i+1)].map(x=>[...new Array(n+1)].fill(0)),s=[],h=[],c=[],l=[],p=[];for(let x=0;x<i;++x)for(let f=0;f<n;++f){s.push((2*f/n-1)*e,a[x][f],(2*x/i-1)*t,(2*(f+1)/n-1)*e,a[x][f+1],(2*x/i-1)*t,(2*(f+1)/n-1)*e,a[x+1][f+1],(2*(x+1)/i-1)*t,(2*f/n-1)*e,a[x+1][f],(2*(x+1)/i-1)*t),h.push(0,1,0,0,1,0,0,1,0,0,1,0),this.options.textureRepeat===void 0||this.options.textureRepeat===!1?c.push(f/n,x/i,(f+1)/n,x/i,(f+1)/n,(x+1)/i,f/n,(x+1)/i):c.push(0,0,1,0,1,1,0,1);let o=(x*n+f)*4;p.push(o,o+1,o+2,o,o+2,o+3)}if(Array.isArray(this.options.colors))if(this.options.colors.length==1){let x=this.options.colors[0];for(let f=0;f<n*i*16;++f)l.push(x[f%4])}else throw new Error("options.colors requires 1 or 4 elements");else for(let x=0;x<n*i*16;++x)l.push(1);this.bufferData(s,3,"positions"),this.bufferData(h,3,"normals"),this.bufferData(l,4,"colors"),this.bufferData(c,2,"uvs"),this.bufferData(p,0,"index")}};var J=class extends V{onInit(){let e=this.options.width?this.options.width/2:.5,t=this.options.height?this.options.height/2:.5,n=[-e,t,0,e,t,0,e,-t,0,-e,-t,0],i=[0,0,1,0,0,1,0,0,1,0,0,1],a=[];if(Array.isArray(this.options.colors))if(this.options.colors.length==1){let c=this.options.colors[0];for(let l=0;l<16;++l)a.push(c[l%4])}else if(this.options.colors.length==4)for(let c=0;c<4;++c){let l=this.options.colors[c];for(let p=0;p<4;++p)a.push(l[p])}else throw new Error("options.colors requires 1 or 4 elements");else for(let c=0;c<16;++c)a.push(1);let s=[0,0,1,0,1,1,0,1],h=[0,1,2,0,2,3];this.bufferData(n,3,"positions"),this.bufferData(i,3,"normals"),this.bufferData(a,4,"colors"),this.bufferData(s,2,"uvs"),this.bufferData(h,0,"index")}};var wr=class extends B{zoom=1;constructor(e,t){super(),this.near=0,this.setToOrtho(e,t)}setToOrtho(e,t){this.viewportWidth=e,this.viewportHeight=t,S.set(this.position,this.zoom*e/2,this.zoom*t/2,0),this.updateProjection()}updateProjection(){_.ortho(this.projectionMatrix,this.zoom*-this.viewportWidth/2,this.zoom*this.viewportWidth/2,this.zoom*-this.viewportHeight/2,this.zoom*this.viewportHeight/2,this.near,this.far)}translate(...e){if(e.length==1)S.set(this.position,...e[0],0);else if(e.length==2)S.set(this.position,e[0],e[1],0);else throw new Error("required 1 or 2 arguments")}zoomBy(...e){let t=e[0];if(this.zoom*=1+t,e.length==2||e.length==3){let n=k.create();e.length==2?k.copy(n,e[1]):k.set(n,...e),k.sub(n,n,this.position),k.scale(n,n,t),S.add(this.position,this.position,[...n,0])}}};var Er=class extends G{regionX;regionY;regionWidth;regionHeight;constructor(...e){let t=e[0],n=0,i=0,a=t.width,s=t.height;e.length==3?(a=e[1],s=e[2]):e.length==5&&(n=e[1],i=e[2],a=e[3],s=e[4]),super(new J,new H(g.graphics.getShader("texture")),t),this.setRegionSize(a,s),this.setRegionPosition(n,i)}setRegionSize(e,t){this.regionWidth=e,this.regionHeight=t;let n=[0,0,e/this.texture.width,0,e/this.texture.width,t/this.texture.height,0,t/this.texture.height];this.mesh.bufferData(n,2,"uvs")}setRegionPosition(e,t){this.regionX=e,this.regionY=t,this.shader.setUniform("uvOffset",[e/this.texture.width,t/this.texture.height])}};var Ar=class extends G{font;text;rainbow;constructor(e,t,n=!1){super(new V,new H(g.graphics.getShader("texture")),e.texture),this.font=e,this.text=t,this.rainbow=n,this.updateGeometry()}updateGeometry(){let e=[],t=[],n=[],i=[],a=this.font.charWidth,s=this.font.charHeight,h=this.font.options.charRatio,c=(1-this.text.length)*h*.5;for(let l=0;l<this.text.length;++l){let p=this.text.charCodeAt(l),x=this.font.getCharPosition(p);if(x===null)continue;let[f,o]=x;e.push(-.5*h+c,.5,0,.5*h+c,.5,0,.5*h+c,-.5,0,-.5*h+c,-.5,0),n.push(f/this.texture.width,o/this.texture.height,(f+a)/this.texture.width,o/this.texture.height,(f+a)/this.texture.width,(o+s)/this.texture.height,f/this.texture.width,(o+s)/this.texture.height);let M=l*4;i.push(M,M+1,M+2,M,M+2,M+3),c+=h}if(this.rainbow)for(let l=0;l<4*this.text.length;++l)t.push(Math.random(),Math.random(),Math.random(),1);else for(let l=0;l<4*this.text.length;++l)t.push(1,1,1,1);this.mesh.bufferData(e,3,"positions"),this.mesh.bufferData(t,4,"colors"),this.mesh.bufferData(n,2,"uvs"),this.mesh.bufferData(i,0,"index")}setText(e){this.text=e,this.updateGeometry()}};var Rr=class{mesh;texture;shader;particles=[];constructor(e){this.mesh=new V,this.texture=e.texture,this.shader=new H(g.graphics.getShader("particle"))}addParticles(){}updateParticles(){}updateGeometry(){let e=[],t=[],n=[];for(let i of this.particles)e.push(...i.position),t.push(...i.color,i.alpha),n.push(i.size);this.mesh.bufferData(e,3,"positions"),this.mesh.bufferData(t,4,"colors"),this.mesh.bufferData(n,1,"sizes")}draw(e){this.shader.activate(),this.texture.bind();let t=_.create(),n=e.viewMatrix,i=_.create();_.multiply(i,n,t),this.shader.setUniform("modelViewMatrix",i),this.shader.bind(e),this.mesh.bind(this.shader);let a=this.particles.length;g.gl.drawArrays(g.gl.POINTS,0,a)}update(){this.addParticles(),this.updateParticles(),this.updateGeometry()}};var Jr=class{touchInfo=[];keyInfo={currentlyPressed:new Set,previouslyPressed:new Set,justPressed:new Set};constructor(){for(let e=0;e<Jr.MAX_TOUCHES;++e)this.touchInfo[e]={x:null,y:null,isTouched:!1,wasTouched:!1,isJustTouched:!1}}isKeyPressed(e){return this.keyInfo.currentlyPressed.has(e)}isKeyClicked(e){return this.keyInfo.justPressed.has(e)}isTouched(e=0){return this.touchInfo[e].isTouched}isJustTouched(e=0){return this.touchInfo[e].isJustTouched}isMousePressed(){return this.isTouched()}isMouseClicked(){return this.isJustTouched()}getX(e=0){return this.touchInfo[e].x}getY(e=0){return this.touchInfo[e].y}initEvents(){let e=g.graphics.canvas;addEventListener("keydown",t=>this.onKeyDown(t)),addEventListener("keyup",t=>this.onKeyUp(t)),e.addEventListener("touchstart",t=>this.handleTouchEvent(t)),e.addEventListener("touchmove",t=>this.handleTouchEvent(t)),e.addEventListener("touchend",t=>this.handleTouchEvent(t)),e.addEventListener("mousedown",t=>this.handleMouseEvent(t)),e.addEventListener("mousemove",t=>this.handleMouseEvent(t)),e.addEventListener("mouseup",t=>this.handleMouseEvent(t))}handleTouchEvent(e){let t=e.target.getBoundingClientRect();for(let n of e.changedTouches){let i=n.pageX-t.x,a=n.pageY-t.y,s=this.touchInfo[n.identifier];switch(s.x=i,s.y=a,e.type){case"touchstart":s.isTouched=!0;break;case"touchend":s.isTouched=!1}}}handleMouseEvent(e){let t=e.target.getBoundingClientRect(),n=e.pageX-t.x,i=e.pageY-t.y,a=this.touchInfo[0];switch(a.x=n,a.y=i,e.type){case"mousedown":a.isTouched=!0;break;case"mouseup":a.isTouched=!1}}onKeyDown(e){this.keyInfo.currentlyPressed.add(e.code)}onKeyUp(e){this.keyInfo.currentlyPressed.delete(e.code)}update(){this.keyInfo.currentlyPressed.forEach(e=>{this.keyInfo.previouslyPressed.has(e)||this.keyInfo.justPressed.add(e)}),this.keyInfo.previouslyPressed=new Set(this.keyInfo.currentlyPressed);for(let e of this.touchInfo)e.isJustTouched=e.isTouched&&!e.wasTouched,e.wasTouched=e.isTouched}},tr=Jr;X(tr,"MAX_TOUCHES",10);var Qe={};U(Qe,{LinearSpline:()=>Tr,MathUtils:()=>Pr});var Tr=class{points=[];constructor(e){this.lerp=e}addPoint(e,t){this.points.push([e,t]);for(let n=this.points.length-1;n>0&&!(this.points[n][0]>=this.points[n-1][0]);--n)[this.points[n],this.points[n-1]]=[this.points[n-1],this.points[n]]}getValue(e){let t=0;for(let s=0;s<this.points.length&&!(e>=this.points[s][0]);++s)t=s;let n=this.points[t],i=Math.min(t+1,this.points.length-1);if(t==i)return n[1];let a=this.points[i];return this.lerp((e-n[0])/(a[0]-n[0]),n[1],a[1])}};var Pr=class{static lerp(e,t,n){return(n-t)*e+t}static rand(e,t){return Math.random()*(t-e)+e}static randInt(e,t){return Math.floor(this.rand(e,t+1))}static clamp(e,t,n){return Math.min(Math.max(e,t),n)}static sat(e){return this.clamp(e,0,1)}static shuffle(e){for(let t=0;t<e.length;++t){let n=this.randInt(0,e.length-1);[e[t],e[n]]=[e[n],e[t]]}}static choice(e){return e[this.randInt(0,e.length-1)]}};var g=class{static async init(e){this.graphics=new ir(e),this.files=new nr,this.input=new tr,this.input.initEvents(),this.graphics.compileShaders(),this.graphics.generateFonts(),e.preload(),await this.files.waitForAssetsToLoad(),e.create(),addEventListener("resize",()=>this.graphics.onResize()),this.graphics.onResize(),this.graphics.onResume()}static get gl(){return this.graphics.gl}};X(g,"graphics"),X(g,"files"),X(g,"input");export{zr as Game,g as Gol,Be as glMatrix,Ge as graphics,Qe as math};
//# sourceMappingURL=goliath.js.map
